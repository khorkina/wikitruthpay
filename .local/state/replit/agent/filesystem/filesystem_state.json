{"file_contents":{"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/hooks/use-wikipedia-search.ts":{"content":"import { useState, useEffect, useCallback } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { api, type SearchResult } from '@/lib/api';\n\nexport function useWikipediaSearch(language: string = 'en') {\n  const [query, setQuery] = useState('');\n  const [debouncedQuery, setDebouncedQuery] = useState('');\n\n  // Debounce the search query with faster response for good queries\n  useEffect(() => {\n    const delay = query.length >= 3 ? 150 : 300; // Much faster for longer, more specific queries\n    const timer = setTimeout(() => {\n      setDebouncedQuery(query);\n    }, delay);\n\n    return () => clearTimeout(timer);\n  }, [query]);\n\n  // Reset search when language changes\n  useEffect(() => {\n    setQuery('');\n    setDebouncedQuery('');\n  }, [language]);\n\n  const search = useCallback((searchTerm: string) => {\n    setQuery(searchTerm);\n  }, []);\n\n  const clearSearch = useCallback(() => {\n    setQuery('');\n    setDebouncedQuery('');\n  }, []);\n\n  // Search query with optimized caching and retry\n  const searchQuery = useQuery({\n    queryKey: ['/api/wikipedia/search', debouncedQuery, language],\n    queryFn: () => api.searchArticles(debouncedQuery, language, 10),\n    enabled: debouncedQuery.length >= 2,\n    staleTime: 5 * 60 * 1000, // 5 minutes cache for faster updates\n    gcTime: 10 * 60 * 1000, // Keep in memory for 10 minutes\n    retry: 1, // Reduce retries for faster response\n    retryDelay: 500, // Faster retry\n  });\n\n  return {\n    query,\n    search,\n    clearSearch,\n    suggestions: searchQuery.data || [],\n    isLoading: searchQuery.isLoading,\n    error: searchQuery.error,\n  };\n}\n","path":null,"size_bytes":1619,"size_tokens":null},"client/src/lib/storage.ts":{"content":"import { openDB, type IDBPDatabase } from 'idb';\nimport { v4 as uuidv4 } from 'uuid';\n\n// Database schema with premium subscription support\nexport interface UserAccount {\n  id: string;\n  createdAt: string;\n  preferences: {\n    defaultLanguage: string;\n    theme: 'light' | 'dark';\n  };\n  subscription: {\n    isPremium: boolean;\n    subscriptionDate?: string;\n    expiryDate?: string;\n  };\n}\n\nexport interface StorageComparisonResult {\n  id: string;\n  userId: string;\n  articleTitle: string;\n  selectedLanguages: string[];\n  outputLanguage: string;\n  baseLanguage: string;\n  comparisonResult: string;\n  isFunnyMode: boolean;\n  isPremium: boolean;\n  createdAt: string;\n  articles: Array<{\n    language: string;\n    title: string;\n    content: string;\n    contentLength: number;\n  }>;\n}\n\nexport interface SearchSession {\n  id: string;\n  userId: string;\n  searchQuery?: string;\n  selectedArticle?: any;\n  availableLanguages?: Array<{\n    lang: string;\n    title: string;\n    url: string;\n  }>;\n  createdAt: string;\n}\n\nexport interface LocalHighlight {\n  id: string;\n  comparisonId: string;\n  startOffset: number;\n  endOffset: number;\n  color: string;\n  excerpt: string;\n  createdAt: string;\n}\n\nclass ClientStorage {\n  private db: IDBPDatabase | null = null;\n  private dbName = 'WikiTruthDB';\n  private dbVersion = 4; // Incremented for highlights support\n\n  async init(): Promise<void> {\n    this.db = await openDB(this.dbName, this.dbVersion, {\n      upgrade(db) {\n        // User accounts store\n        if (!db.objectStoreNames.contains('users')) {\n          db.createObjectStore('users', { keyPath: 'id' });\n        }\n\n        // Comparisons store\n        if (!db.objectStoreNames.contains('comparisons')) {\n          const comparisonsStore = db.createObjectStore('comparisons', { keyPath: 'id' });\n          comparisonsStore.createIndex('userId', 'userId', { unique: false });\n          comparisonsStore.createIndex('createdAt', 'createdAt', { unique: false });\n        }\n\n        // Search sessions store\n        if (!db.objectStoreNames.contains('sessions')) {\n          const sessionsStore = db.createObjectStore('sessions', { keyPath: 'id' });\n          sessionsStore.createIndex('userId', 'userId', { unique: false });\n        }\n\n        // Highlights store\n        if (!db.objectStoreNames.contains('highlights')) {\n          const highlightsStore = db.createObjectStore('highlights', { keyPath: 'id' });\n          highlightsStore.createIndex('comparisonId', 'comparisonId', { unique: false });\n        }\n      },\n    });\n  }\n\n  // User account management - simplified\n  async getCurrentUser(): Promise<UserAccount> {\n    if (!this.db) await this.init();\n    \n    // Check localStorage for existing user ID\n    let userId = localStorage.getItem('wikiTruthUserId');\n    \n    if (!userId) {\n      // Create new user - all users are automatically premium\n      userId = uuidv4();\n      localStorage.setItem('wikiTruthUserId', userId);\n      \n      const newUser: UserAccount = {\n        id: userId,\n        createdAt: new Date().toISOString(),\n        preferences: {\n          defaultLanguage: 'en',\n          theme: 'light'\n        },\n        subscription: {\n          isPremium: true\n        }\n      };\n      \n      await this.db!.put('users', newUser);\n      return newUser;\n    }\n\n    // Get existing user\n    const user = await this.db!.get('users', userId);\n    if (user) {\n      // All users are automatically premium - update if needed\n      const cleanUser: UserAccount = {\n        id: user.id,\n        createdAt: user.createdAt,\n        preferences: user.preferences || {\n          defaultLanguage: 'en',\n          theme: 'light'\n        },\n        subscription: {\n          isPremium: true\n        }\n      };\n      await this.db!.put('users', cleanUser);\n      return cleanUser;\n    }\n\n    // User ID exists in localStorage but not in IndexedDB - recreate as premium\n    const recreatedUser: UserAccount = {\n      id: userId,\n      createdAt: new Date().toISOString(),\n      preferences: {\n        defaultLanguage: 'en',\n        theme: 'light'\n      },\n      subscription: {\n        isPremium: true\n      }\n    };\n    \n    await this.db!.put('users', recreatedUser);\n    return recreatedUser;\n  }\n\n  async updateUser(updates: Partial<UserAccount>): Promise<UserAccount> {\n    const currentUser = await this.getCurrentUser();\n    const updatedUser = { ...currentUser, ...updates };\n    await this.db!.put('users', updatedUser);\n    return updatedUser;\n  }\n\n  // Comparison management\n  async saveComparison(comparison: Omit<StorageComparisonResult, 'id' | 'userId' | 'createdAt'>): Promise<StorageComparisonResult> {\n    if (!this.db) await this.init();\n    \n    const user = await this.getCurrentUser();\n    const fullComparison: StorageComparisonResult = {\n      id: uuidv4(),\n      userId: user.id,\n      createdAt: new Date().toISOString(),\n      ...comparison\n    };\n\n    await this.db!.put('comparisons', fullComparison);\n    return fullComparison;\n  }\n\n  async getComparison(id: string): Promise<StorageComparisonResult | undefined> {\n    if (!this.db) await this.init();\n    return await this.db!.get('comparisons', id);\n  }\n\n  async getUserComparisons(): Promise<StorageComparisonResult[]> {\n    if (!this.db) await this.init();\n    const user = await this.getCurrentUser();\n    \n    const tx = this.db!.transaction('comparisons', 'readonly');\n    const index = tx.store.index('userId');\n    const comparisons = await index.getAll(user.id);\n    \n    return comparisons.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n  }\n\n  async deleteComparison(id: string): Promise<void> {\n    if (!this.db) await this.init();\n    await this.deleteHighlightsByComparisonId(id);\n    await this.db!.delete('comparisons', id);\n  }\n\n  // Session management\n  async saveSession(session: Omit<SearchSession, 'id' | 'userId' | 'createdAt'>): Promise<SearchSession> {\n    if (!this.db) await this.init();\n    \n    const user = await this.getCurrentUser();\n    const fullSession: SearchSession = {\n      id: uuidv4(),\n      userId: user.id,\n      createdAt: new Date().toISOString(),\n      ...session\n    };\n\n    await this.db!.put('sessions', fullSession);\n    return fullSession;\n  }\n\n  async getSession(id: string): Promise<SearchSession | undefined> {\n    if (!this.db) await this.init();\n    return await this.db!.get('sessions', id);\n  }\n\n  async updateSession(id: string, updates: Partial<SearchSession>): Promise<SearchSession | undefined> {\n    if (!this.db) await this.init();\n    const existing = await this.getSession(id);\n    if (!existing) return undefined;\n\n    const updated: SearchSession = { ...existing, ...updates };\n    await this.db!.put('sessions', updated);\n    return updated;\n  }\n\n  // Data export and management\n  async exportAllData(): Promise<{\n    user: UserAccount;\n    comparisons: StorageComparisonResult[];\n    sessions: SearchSession[];\n  }> {\n    const user = await this.getCurrentUser();\n    const comparisons = await this.getUserComparisons();\n    const sessions = await this.getAllSessions();\n    \n    return { user, comparisons, sessions };\n  }\n\n  async getAllSessions(): Promise<SearchSession[]> {\n    if (!this.db) await this.init();\n    const user = await this.getCurrentUser();\n    \n    const tx = this.db!.transaction('sessions', 'readonly');\n    const index = tx.store.index('userId');\n    return await index.getAll(user.id);\n  }\n\n  async clearAllData(): Promise<void> {\n    if (!this.db) await this.init();\n    \n    const tx = this.db!.transaction(['users', 'comparisons', 'sessions', 'highlights'], 'readwrite');\n    await Promise.all([\n      tx.objectStore('users').clear(),\n      tx.objectStore('comparisons').clear(),\n      tx.objectStore('sessions').clear(),\n      tx.objectStore('highlights').clear()\n    ]);\n    \n    localStorage.removeItem('wikiTruthUserId');\n  }\n\n  // Premium subscription management\n  async activatePremiumSubscription(): Promise<UserAccount> {\n    const currentUser = await this.getCurrentUser();\n    const subscriptionDate = new Date().toISOString();\n    const expiryDate = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(); // 30 days from now\n    \n    const updatedUser = await this.updateUser({\n      subscription: {\n        isPremium: true,\n        subscriptionDate,\n        expiryDate\n      }\n    });\n    \n    return updatedUser;\n  }\n\n  async checkSubscriptionStatus(): Promise<{ isValid: boolean; daysRemaining?: number }> {\n    // All users are automatically premium - always return valid\n    return { isValid: true };\n  }\n\n  async getVisitorId(): Promise<string> {\n    let visitorId = localStorage.getItem('wikiTruthVisitorId');\n    if (!visitorId) {\n      visitorId = uuidv4();\n      localStorage.setItem('wikiTruthVisitorId', visitorId);\n    }\n    return visitorId;\n  }\n\n  async deactivateSubscription(): Promise<UserAccount> {\n    return await this.updateUser({\n      subscription: {\n        isPremium: false\n      }\n    });\n  }\n\n  // Highlights management\n  async saveHighlight(highlight: Omit<LocalHighlight, 'id' | 'createdAt'>): Promise<LocalHighlight> {\n    if (!this.db) await this.init();\n    \n    const fullHighlight: LocalHighlight = {\n      id: uuidv4(),\n      createdAt: new Date().toISOString(),\n      ...highlight\n    };\n\n    await this.db!.put('highlights', fullHighlight);\n    return fullHighlight;\n  }\n\n  async getHighlightsByComparisonId(comparisonId: string): Promise<LocalHighlight[]> {\n    if (!this.db) await this.init();\n    \n    const tx = this.db!.transaction('highlights', 'readonly');\n    const index = tx.store.index('comparisonId');\n    const highlights = await index.getAll(comparisonId);\n    \n    return highlights.sort((a, b) => a.startOffset - b.startOffset);\n  }\n\n  async deleteHighlight(id: string): Promise<void> {\n    if (!this.db) await this.init();\n    await this.db!.delete('highlights', id);\n  }\n\n  async deleteHighlightsByComparisonId(comparisonId: string): Promise<void> {\n    if (!this.db) await this.init();\n    \n    const highlights = await this.getHighlightsByComparisonId(comparisonId);\n    const tx = this.db!.transaction('highlights', 'readwrite');\n    \n    for (const highlight of highlights) {\n      await tx.store.delete(highlight.id);\n    }\n    \n    await tx.done;\n  }\n}\n\nexport const clientStorage = new ClientStorage();","path":null,"size_bytes":10307,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":1901,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/components/settings-dialog.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Separator } from '@/components/ui/separator';\nimport { Settings, Download, Trash2 } from 'lucide-react';\nimport { clientStorage, type UserAccount } from '@/lib/storage';\nimport { useToast } from '@/hooks/use-toast';\n\nexport function SettingsDialog() {\n  const [open, setOpen] = useState(false);\n  const [user, setUser] = useState<UserAccount | null>(null);\n  const [exportData, setExportData] = useState<string>('');\n  const { toast } = useToast();\n\n  useEffect(() => {\n    loadUserData();\n  }, []);\n\n  useEffect(() => {\n    if (open) {\n      loadUserData();\n    }\n  }, [open]);\n\n  const loadUserData = async () => {\n    try {\n      const userData = await clientStorage.getCurrentUser();\n      setUser(userData);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to load user settings\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const exportAllData = async () => {\n    try {\n      const data = await clientStorage.exportAllData();\n      const jsonData = JSON.stringify(data, null, 2);\n      setExportData(jsonData);\n      \n      toast({\n        title: \"Data Exported\",\n        description: \"Your data has been exported. You can copy and save it.\"\n      });\n    } catch (error) {\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export your data\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const downloadExportData = () => {\n    if (!exportData) return;\n    \n    const blob = new Blob([exportData], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `wikitruth-data-${new Date().toISOString().split('T')[0]}.json`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n    \n    toast({\n      title: \"Download Started\",\n      description: \"Your data export has been downloaded\"\n    });\n  };\n\n  const clearAllData = async () => {\n    if (!confirm('Are you sure you want to delete all your data? This cannot be undone.')) {\n      return;\n    }\n\n    try {\n      await clientStorage.clearAllData();\n      setUser(null);\n      setExportData('');\n      \n      toast({\n        title: \"Data Cleared\",\n        description: \"All your data has been deleted from this browser\"\n      });\n    } catch (error) {\n      toast({\n        title: \"Clear Failed\",\n        description: \"Failed to clear your data\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"ghost\" size=\"sm\">\n          <Settings className=\"h-4 w-4\" />\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Settings className=\"h-5 w-5\" />\n            Settings & Data Management\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* User Information */}\n          {user && (\n            <div className=\"space-y-3\">\n              <h3 className=\"text-lg font-semibold\">Account Information</h3>\n              <div className=\"bg-gray-50 p-4 rounded-lg space-y-2\">\n                <p><strong>User ID:</strong> {user.id}</p>\n                <p><strong>Created:</strong> {new Date(user.createdAt).toLocaleDateString()}</p>\n                <p><strong>Default Language:</strong> {user.preferences.defaultLanguage}</p>\n                <p><strong>Theme:</strong> {user.preferences.theme}</p>\n              </div>\n            </div>\n          )}\n\n          <Separator />\n\n          {/* Data Export */}\n          <div className=\"space-y-3\">\n            <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n              <Download className=\"h-5 w-5\" />\n              Export Your Data\n            </h3>\n            <p className=\"text-sm text-gray-600\">\n              Export all your comparison history and settings as JSON data.\n            </p>\n            <div className=\"flex gap-3\">\n              <Button onClick={exportAllData} variant=\"outline\">\n                <Download className=\"h-4 w-4 mr-2\" />\n                Generate Export\n              </Button>\n              {exportData && (\n                <Button onClick={downloadExportData}>\n                  Download JSON File\n                </Button>\n              )}\n            </div>\n            \n            {exportData && (\n              <div className=\"space-y-2\">\n                <label className=\"block text-sm font-medium\">\n                  Exported Data (JSON):\n                </label>\n                <Textarea\n                  value={exportData}\n                  readOnly\n                  className=\"font-mono text-xs h-32\"\n                  placeholder=\"Click 'Generate Export' to see your data here\"\n                />\n              </div>\n            )}\n          </div>\n\n          <Separator />\n\n          {/* Data Management */}\n          <div className=\"space-y-3\">\n            <h3 className=\"text-lg font-semibold flex items-center gap-2 text-red-600\">\n              <Trash2 className=\"h-5 w-5\" />\n              Danger Zone\n            </h3>\n            <p className=\"text-sm text-gray-600\">\n              Permanently delete all your data from this browser. This action cannot be undone.\n            </p>\n            <Button \n              onClick={clearAllData}\n              variant=\"destructive\"\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              <Trash2 className=\"h-4 w-4 mr-2\" />\n              Delete All Data\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":6005,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/pages/language-selection.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useLocation, useRoute } from 'wouter';\nimport { useQuery, useMutation } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Input } from '@/components/ui/input';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { api, type LanguageLink } from '@/lib/api';\nimport { getLanguageName, getLanguageNativeName, SUPPORTED_LANGUAGES, searchLanguages } from '@/lib/languages';\nimport { clientStorage } from '@/lib/storage';\nimport { useToast } from '@/hooks/use-toast';\nimport { PremiumComparisonOptions, type ComparisonOptions } from '@/components/premium-comparison-options';\n\nexport default function LanguageSelection() {\n  const [match, params] = useRoute('/select-languages');\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  \n  const title = params ? decodeURIComponent(new URLSearchParams(window.location.search).get('title') || '') : '';\n  const language = params ? new URLSearchParams(window.location.search).get('lang') || 'en' : 'en';\n  \n  const [selectedLanguages, setSelectedLanguages] = useState<string[]>([language]);\n  const [outputLanguage, setOutputLanguage] = useState('en');\n  const [languageSearchQuery, setLanguageSearchQuery] = useState('');\n  \n  // Set output language based on user's browser language preference on component mount\n  useEffect(() => {\n    const getUserLanguage = () => {\n      const browserLang = navigator.language.split('-')[0];\n      // Check if browser language is supported, otherwise default to English\n      const supportedLang = SUPPORTED_LANGUAGES.find(lang => lang.code === browserLang);\n      return supportedLang ? browserLang : 'en';\n    };\n    \n    setOutputLanguage(getUserLanguage());\n  }, []);\n  const [showPremiumOptions, setShowPremiumOptions] = useState(false);\n  const [initialAnalysisMode, setInitialAnalysisMode] = useState<'academic' | 'biography' | 'funny'>('academic');\n\n  // Fetch available language links\n  const languageLinksQuery = useQuery({\n    queryKey: ['/api/wikipedia/languages', title, language],\n    queryFn: () => api.getLanguageLinks(title, language),\n    enabled: !!title,\n  });\n\n  // Comparison mutation supporting both free and premium plans\n  const comparisonMutation = useMutation({\n    mutationFn: async ({ articleTitle, selectedLanguages, outputLanguage, isFunnyMode, isPremium, premiumOptions }: {\n      articleTitle: string;\n      selectedLanguages: string[];\n      outputLanguage: string;\n      isFunnyMode?: boolean;\n      isPremium?: boolean;\n      premiumOptions?: ComparisonOptions;\n    }) => {\n      console.log(`Starting ${isPremium ? 'premium' : 'free'} comparison process...`);\n      \n      // Get language-specific article titles\n      const languageTitles: Record<string, string> = {};\n      const availableLinks = languageLinksQuery.data || [];\n      \n      // Add the base language\n      languageTitles[language] = title;\n      \n      // Map selected languages to their article titles\n      for (const selectedLang of selectedLanguages) {\n        if (selectedLang === language) {\n          languageTitles[selectedLang] = title;\n        } else {\n          const langLink = availableLinks.find(link => link.lang === selectedLang);\n          if (langLink) {\n            languageTitles[selectedLang] = langLink.title;\n          }\n        }\n      }\n\n      return api.compareArticles({\n        articleTitle,\n        selectedLanguages,\n        outputLanguage,\n        baseLanguage: language,\n        isFunnyMode,\n        languageTitles,\n        isPremium\n      });\n    },\n    onSuccess: (result) => {\n      // Navigate to results page\n      setLocation(`/results/${result.id}`);\n    },\n    onError: (error: any) => {\n      console.error('Comparison error:', error);\n      \n      // Check for generation limit exceeded error\n      if (error?.message === 'GENERATION_LIMIT_EXCEEDED' || error?.requiresSubscription) {\n        toast({\n          title: \"Free generation limit reached\",\n          description: \"You've used your free comparison. Subscribe for unlimited access.\",\n          variant: \"destructive\",\n        });\n        setLocation(\"/billing\");\n        return;\n      }\n      \n      toast({\n        title: \"Comparison Failed\",\n        description: error?.message || \"An error occurred during comparison\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleLanguageToggle = (langCode: string) => {\n    setSelectedLanguages(prev => {\n      if (prev.includes(langCode)) {\n        // Don't allow removing the search language (base language)\n        if (langCode === language) {\n          toast({\n            title: \"Cannot Remove Search Language\",\n            description: `${getLanguageName(language)} is the search language and cannot be removed from comparison`,\n            variant: \"destructive\"\n          });\n          return prev;\n        }\n        // Remove language if it's not the base language\n        return prev.filter(l => l !== langCode);\n      } else {\n        // Don't allow more than 5 languages\n        if (prev.length >= 5) {\n          toast({\n            title: \"Maximum Languages Reached\",\n            description: \"You can select up to 5 languages for comparison\",\n            variant: \"destructive\"\n          });\n          return prev;\n        }\n        // Add the language\n        return [...prev, langCode];\n      }\n    });\n  };\n\n  const handleCompare = async (isFunnyMode: boolean = false) => {\n    if (selectedLanguages.length < 2) {\n      toast({\n        title: \"Select More Languages\",\n        description: \"Please select at least 2 languages to compare\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    // Set the initial analysis mode based on which button was clicked\n    setInitialAnalysisMode(isFunnyMode ? 'funny' : 'academic');\n    \n    // All users can configure premium comparison settings\n    setShowPremiumOptions(true);\n    toast({\n      title: \"Configure Comparison Settings\",\n      description: \"Please configure your comparison options before starting\",\n      variant: \"default\"\n    });\n  };\n\n  const handlePremiumComparisonStart = (options: ComparisonOptions) => {\n    setShowPremiumOptions(false);\n    \n    // Build language titles mapping for premium\n    const languageTitles: Record<string, string> = {};\n    const availableLinks = languageLinksQuery.data || [];\n    \n    // Add the base language\n    languageTitles[language] = title;\n    \n    // Map selected languages to their article titles\n    for (const selectedLang of selectedLanguages) {\n      if (selectedLang === language) {\n        languageTitles[selectedLang] = title;\n      } else {\n        const langLink = availableLinks.find(link => link.lang === selectedLang);\n        if (langLink) {\n          languageTitles[selectedLang] = langLink.title;\n        }\n      }\n    }\n    \n    // Navigate to loading page for premium comparison\n    const params = new URLSearchParams({\n      title,\n      languages: JSON.stringify(selectedLanguages),\n      outputLanguage,\n      isFunnyMode: (options.analysisMode === 'funny').toString(),\n      isPremium: (options.aiModel === 'premium').toString(),\n      languageTitles: JSON.stringify(languageTitles),\n      premiumOptions: JSON.stringify(options)\n    });\n    setLocation(`/comparison-loading?${params.toString()}`);\n  };\n\n\n  const availableLanguages = languageLinksQuery.data || [];\n  \n  // Show only languages where the article actually exists\n  // Filter available languages to include only those we support\n  const filteredAvailableLanguages = availableLanguages.filter(link => \n    SUPPORTED_LANGUAGES.some(lang => lang.code === link.lang)\n  );\n  \n  // Ensure the search language is always included first if not already in the list\n  const searchLanguageEntry = {\n    lang: language,\n    title: title,\n    url: `https://${language}.wikipedia.org/wiki/${encodeURIComponent(title)}`\n  };\n  \n  // Create final list with search language first, then others (excluding duplicates)\n  let languagesForDisplay = [searchLanguageEntry];\n  \n  // Add other available languages, excluding the search language to avoid duplicates\n  filteredAvailableLanguages.forEach(lang => {\n    if (lang.lang !== language) {\n      languagesForDisplay.push(lang);\n    }\n  });\n  \n  // Filter languages based on search query\n  if (languageSearchQuery.trim()) {\n    const searchResults = searchLanguages(languageSearchQuery);\n    const searchCodes = searchResults.map(lang => lang.code);\n    \n    // Keep search language first, then filter others based on search\n    languagesForDisplay = [\n      searchLanguageEntry,\n      ...languagesForDisplay.filter(lang => \n        lang.lang !== language && searchCodes.includes(lang.lang)\n      )\n    ];\n  }\n  \n  // Final list for rendering\n  const supportedAvailableLanguages = languagesForDisplay;\n\n  if (!title) {\n    return <div>Loading...</div>;\n  }\n\n  // Show comparison options\n  if (showPremiumOptions) {\n    return (\n      <main className=\"lg:col-span-3\">\n        <PremiumComparisonOptions\n          selectedLanguages={selectedLanguages}\n          articleTitle={title}\n          outputLanguage={outputLanguage}\n          onStartComparison={handlePremiumComparisonStart}\n          onBack={() => setShowPremiumOptions(false)}\n          initialAnalysisMode={initialAnalysisMode}\n        />\n      </main>\n    );\n  }\n\n  return (\n    <main className=\"lg:col-span-3\">\n      {/* Article Header */}\n      <div className=\"wiki-content-section mb-6\">\n        <h1 className=\"wiki-article-title text-2xl font-bold mb-2\">{title}</h1>\n        <p className=\"text-wiki-gray mb-4\">\n          Select languages to compare and analyze cultural perspectives\n        </p>\n        \n        {/* Service Notice */}\n        <div className=\"bg-blue-50 border border-blue-200 rounded p-3 mb-4\">\n          <p className=\"text-blue-800 text-sm\">\n            <i className=\"fas fa-check-circle mr-2\"></i>\n            <strong>Advanced AI Analysis:</strong> Full article processing with GPT-5\n          </p>\n          <p className=\"text-blue-700 text-xs mt-1\">\n            <i className=\"fas fa-cog mr-1\"></i>\n            Click any analysis button below to configure your comparison settings\n          </p>\n        </div>\n      </div>\n\n      {/* Language Selection Section */}\n      <div className=\"wiki-content-section mb-6\">\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between mb-4\">\n          <h2 className=\"wiki-section-title text-xl font-semibold\">\n            Select Languages for Comparison\n          </h2>\n          <div className=\"flex items-center gap-4 mt-2 md:mt-0\">\n            <div className={`px-3 py-1 rounded-full text-sm font-medium ${\n              selectedLanguages.length >= 2 && selectedLanguages.length <= 5 \n                ? 'bg-green-100 text-green-800' \n                : 'bg-amber-100 text-amber-800'\n            }`}>\n              {selectedLanguages.length}/5 languages selected\n            </div>\n            <div className=\"text-xs text-gray-600\">\n              Choose 2-5 languages to compare\n            </div>\n          </div>\n        </div>\n        \n        {selectedLanguages.length < 2 && (\n          <div className=\"bg-blue-50 border border-blue-200 rounded p-3 mb-4\">\n            <p className=\"text-blue-800 text-sm\">\n              <i className=\"fas fa-info-circle mr-2\"></i>\n              <strong>Getting Started:</strong> Please select at least 2 languages to compare Wikipedia articles and discover cultural differences.\n            </p>\n          </div>\n        )}\n        \n        {selectedLanguages.length > 5 && (\n          <div className=\"bg-amber-50 border border-amber-200 rounded p-3 mb-4\">\n            <p className=\"text-amber-800 text-sm\">\n              <i className=\"fas fa-exclamation-triangle mr-2\"></i>\n              <strong>Maximum Reached:</strong> Please select no more than 5 languages for optimal comparison quality.\n            </p>\n          </div>\n        )}\n        \n        {languageLinksQuery.isLoading && (\n          <div className=\"space-y-2 mb-4\">\n            {[...Array(5)].map((_, i) => (\n              <div key={i} className=\"animate-pulse bg-gray-200 h-12 rounded\"></div>\n            ))}\n          </div>\n        )}\n        \n        {languageLinksQuery.error && (\n          <div className=\"wiki-message wiki-message-error mb-4\">\n            Failed to load language options. Please try again.\n          </div>\n        )}\n        \n        {supportedAvailableLanguages.length === 0 && !languageLinksQuery.isLoading && !languageLinksQuery.error && (\n          <div className=\"bg-amber-50 border border-amber-200 rounded p-4 mb-4\">\n            <p className=\"text-amber-800 text-sm\">\n              <i className=\"fas fa-info-circle mr-2\"></i>\n              <strong>Single Language Article:</strong> This article is only available in {getLanguageName(language)} ({getLanguageNativeName(language)}).\n            </p>\n            <p className=\"text-amber-700 text-xs mt-1\">\n              Wikipedia comparison requires at least 2 different language versions of the same article.\n            </p>\n          </div>\n        )}\n\n        <div className=\"mb-4\">\n          <div className=\"text-sm text-gray-600 mb-3\">\n            <i className=\"fas fa-info-circle mr-1\"></i>\n            Showing all language versions where this article exists. Select 2-5 languages to compare different perspectives on the same topic.\n          </div>\n          \n          {/* Language Search */}\n          <div className=\"relative\">\n            <Input\n              type=\"text\"\n              placeholder=\"Search for a language (e.g., French, Español, Русский)...\"\n              value={languageSearchQuery}\n              onChange={(e) => setLanguageSearchQuery(e.target.value)}\n              className=\"wiki-input pr-10\"\n            />\n            <i className=\"fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n            {languageSearchQuery && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setLanguageSearchQuery('')}\n                className=\"absolute right-8 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100\"\n              >\n                <i className=\"fas fa-times text-xs\"></i>\n              </Button>\n            )}\n          </div>\n          \n          {languageSearchQuery && (\n            <div className=\"text-xs text-gray-500 mt-1\">\n              Showing {supportedAvailableLanguages.length - 1} available languages matching \"{languageSearchQuery}\"\n            </div>\n          )}\n        </div>\n\n        {supportedAvailableLanguages.length > 0 && (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 mb-6\">\n            {supportedAvailableLanguages.map((link) => {\n              const isSearchLanguage = link.lang === language;\n              const isSelected = selectedLanguages.includes(link.lang);\n              \n              return (\n                <div \n                  key={link.lang} \n                  className={`wiki-sidebar p-3 flex items-center space-x-3 ${\n                    isSearchLanguage ? 'border-2 border-blue-200 bg-blue-50' : ''\n                  }`}\n                >\n                  <Checkbox\n                    id={link.lang}\n                    checked={isSelected}\n                    disabled={isSearchLanguage}\n                    onCheckedChange={() => handleLanguageToggle(link.lang)}\n                  />\n                  <label htmlFor={link.lang} className=\"flex-1 cursor-pointer\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-medium\">{getLanguageName(link.lang)}</span>\n                      {isSearchLanguage && (\n                        <span className=\"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full\">\n                          Search Language\n                        </span>\n                      )}\n                      {!isSearchLanguage && (\n                        <span className=\"px-2 py-1 text-xs bg-green-100 text-green-700 rounded-full\">\n                          Article Available\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"text-sm text-wiki-gray\">{getLanguageNativeName(link.lang)}</div>\n                    {isSearchLanguage && (\n                      <div className=\"text-xs text-blue-600 mt-1\">\n                        This language is automatically included in your comparison\n                      </div>\n                    )}\n                  </label>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/* Comparison Settings */}\n      <div className=\"wiki-content-section mb-6\">\n        <h2 className=\"wiki-section-title text-xl font-semibold mb-4\">Comparison Settings</h2>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">\n              Selected Languages ({selectedLanguages.length})\n            </label>\n            {selectedLanguages.length > 0 ? (\n              <div className=\"flex flex-wrap gap-2 mb-2\">\n                {selectedLanguages.map(lang => (\n                  <span key={lang} className=\"wiki-tag bg-wiki-blue text-white px-2 py-1 rounded text-sm\">\n                    {getLanguageName(lang)}\n                  </span>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-wiki-gray text-sm\">No languages selected</p>\n            )}\n            {selectedLanguages.length < 2 && (\n              <p className=\"text-amber-600 text-sm\">Select at least 2 languages to compare</p>\n            )}\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">Output Language</label>\n            <Select value={outputLanguage} onValueChange={setOutputLanguage}>\n              <SelectTrigger className=\"wiki-input\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                {SUPPORTED_LANGUAGES.map(lang => (\n                  <SelectItem key={lang.code} value={lang.code}>\n                    {lang.name} ({lang.nativeName})\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n      </div>\n\n      {/* Comparison Actions */}\n      <div className=\"wiki-content-section mb-6\">\n        <h2 className=\"wiki-section-title text-xl font-semibold mb-4\">Start Analysis</h2>\n        \n        <div className=\"space-y-3\">\n          <Button \n            onClick={() => handleCompare(false)}\n            disabled={selectedLanguages.length < 2 || comparisonMutation.isPending}\n            className=\"w-full wiki-button-primary\"\n          >\n            <span>\n              <i className=\"fas fa-search mr-2\"></i>\n              Academic Analysis\n            </span>\n          </Button>\n\n          <Button \n            onClick={() => handleCompare(true)}\n            disabled={selectedLanguages.length < 2 || comparisonMutation.isPending}\n            className=\"w-full wiki-button-secondary\"\n          >\n            <span>\n              <i className=\"fas fa-smile mr-2\"></i>\n              Fun Analysis\n            </span>\n          </Button>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":19446,"size_tokens":null},"client/src/pages/comparison-loading.tsx":{"content":"import { useEffect, useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Progress } from '@/components/ui/progress';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Globe, BookOpen, Zap, Clock, Users } from 'lucide-react';\nimport { useMutation } from '@tanstack/react-query';\nimport { api } from '@/lib/api';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function ComparisonLoading() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [progress, setProgress] = useState(0);\n  const [currentStep, setCurrentStep] = useState(0);\n  const [elapsedTime, setElapsedTime] = useState(0);\n\n  // Get comparison data from URL search params\n  const urlParams = new URLSearchParams(window.location.search);\n  const articleTitle = urlParams.get('title') || '';\n  const selectedLanguages = JSON.parse(urlParams.get('languages') || '[]');\n  const outputLanguage = urlParams.get('outputLanguage') || 'en';\n  const isPremium = urlParams.get('isPremium') === 'true';\n  const isFunnyMode = urlParams.get('isFunnyMode') === 'true';\n  const languageTitles = JSON.parse(urlParams.get('languageTitles') || '{}');\n  const premiumOptionsStr = urlParams.get('premiumOptions');\n  const premiumOptions = premiumOptionsStr ? JSON.parse(premiumOptionsStr) : undefined;\n\n  const steps = [\n    { icon: Globe, text: \"Fetching articles from Wikipedia\", duration: 15 },\n    { icon: BookOpen, text: \"Processing article content\", duration: 25 },\n    { icon: Sparkles, text: `Analyzing with ${isPremium ? 'advanced' : 'AI'} comparison`, duration: 45 },\n    { icon: Zap, text: \"Generating insights and findings\", duration: 15 }\n  ];\n\n  // Comparison mutation\n  const comparisonMutation = useMutation({\n    mutationFn: () => api.compareArticles({\n      articleTitle,\n      selectedLanguages,\n      outputLanguage,\n      isFunnyMode,\n      isPremium,\n      languageTitles,\n      premiumOptions\n    }),\n    onSuccess: (result) => {\n      setProgress(100);\n      setTimeout(() => {\n        setLocation(`/results/${result.id}`);\n      }, 500);\n    },\n    onError: (error: any) => {\n      console.error(\"Comparison error:\", error);\n\n      // Check for generation limit exceeded error\n      if (error?.message === 'GENERATION_LIMIT_EXCEEDED' || error?.requiresSubscription) {\n        toast({\n          title: \"Free generation limit reached\",\n          description: \"You've used your free comparison. Subscribe for unlimited access.\",\n          variant: \"destructive\",\n        });\n        setLocation(\"/billing\");\n        return;\n      }\n\n      toast({\n        title: \"Comparison failed\",\n        description: error?.message || \"Failed to complete the comparison. Please try again.\",\n        variant: \"destructive\",\n      });\n\n      setLocation(\"/select-languages\");\n    },\n  });\n\n  // Start comparison when component mounts\n  useEffect(() => {\n    if (articleTitle && selectedLanguages.length > 0) {\n      comparisonMutation.mutate();\n    }\n  }, []);\n\n  // Progress animation and timer\n  useEffect(() => {\n    if (comparisonMutation.isPending) {\n      const interval = setInterval(() => {\n        setProgress(prev => {\n          if (prev >= 95) {\n            return prev;\n          }\n          return prev + Math.random() * 1.5;\n        });\n      }, 1000);\n\n      const stepInterval = setInterval(() => {\n        setCurrentStep(prev => (prev + 1) % steps.length);\n      }, 4000);\n\n      const timerInterval = setInterval(() => {\n        setElapsedTime(prev => prev + 1);\n      }, 1000);\n\n      return () => {\n        clearInterval(interval);\n        clearInterval(stepInterval);\n        clearInterval(timerInterval);\n      };\n    }\n  }, [comparisonMutation.isPending]);\n\n  const CurrentIcon = steps[currentStep].icon;\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900\">\n      <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 py-6 lg:py-8 xl:py-12 2xl:py-16\">\n        <div className=\"max-w-7xl mx-auto\" style={{ maxWidth: '90rem' }}>\n          \n          <div className=\"text-center mb-6 lg:mb-8 xl:mb-12 2xl:mb-16\">\n            <h1 className=\"text-2xl sm:text-3xl lg:text-4xl xl:text-5xl 2xl:text-6xl font-bold text-gray-900 dark:text-white mb-3 lg:mb-4 xl:mb-6 2xl:mb-8\">\n              Comparing \"{articleTitle}\"\n            </h1>\n            <p className=\"text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl text-gray-600 dark:text-gray-300 max-w-4xl 2xl:max-w-5xl mx-auto\">\n              Analyzing across {selectedLanguages.length} languages with AI-powered insights\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-4 lg:gap-6 xl:gap-8 2xl:gap-10\">\n            \n            <div className=\"lg:col-span-8 space-y-4 lg:space-y-6 xl:space-y-8 2xl:space-y-10\">\n              <Card className=\"w-full shadow-lg border overflow-hidden\">\n                <CardHeader className=\"pb-3 lg:pb-4 xl:pb-6 2xl:pb-8\">\n                  <CardTitle className=\"text-lg sm:text-xl lg:text-2xl xl:text-3xl 2xl:text-4xl flex items-center gap-2 lg:gap-3 xl:gap-4\">\n                    <CurrentIcon className=\"h-5 w-5 sm:h-6 sm:w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 2xl:h-10 2xl:w-10 text-blue-600 animate-pulse flex-shrink-0\" />\n                    <span className=\"truncate\">Processing Your Comparison</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4 lg:space-y-6 xl:space-y-8 2xl:space-y-10\">\n                  \n                  <div className=\"space-y-3 lg:space-y-4 xl:space-y-6 2xl:space-y-8\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-3 xl:gap-4 2xl:gap-6\">\n                      <h3 className=\"text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl font-semibold text-gray-900 dark:text-white flex-1 min-w-0\">\n                        {steps[currentStep].text}\n                      </h3>\n                      <Badge variant=\"secondary\" className=\"text-sm lg:text-base xl:text-lg 2xl:text-xl px-2 lg:px-3 xl:px-4 2xl:px-6 py-1 xl:py-2 2xl:py-3 whitespace-nowrap self-start sm:self-auto\">\n                        {Math.round(progress)}% Complete\n                      </Badge>\n                    </div>\n                    <Progress value={progress} className=\"h-3 sm:h-4 lg:h-5 xl:h-6 2xl:h-8 w-full\" />\n                  </div>\n\n                  <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg p-4 sm:p-5 lg:p-6 xl:p-8 2xl:p-10\">\n                    <div className=\"flex items-center gap-2 sm:gap-3 lg:gap-4 xl:gap-6 2xl:gap-8 mb-2 sm:mb-3 lg:mb-4 xl:mb-6 2xl:mb-8\">\n                      <Clock className=\"h-5 w-5 sm:h-6 sm:w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 2xl:h-10 2xl:w-10 text-blue-600 flex-shrink-0\" />\n                      <h4 className=\"text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl font-semibold text-blue-800 dark:text-blue-300\">\n                        Estimated Processing Time\n                      </h4>\n                    </div>\n                    <p className=\"text-xl sm:text-2xl lg:text-3xl xl:text-4xl 2xl:text-5xl font-bold text-blue-700 dark:text-blue-200 mb-2 sm:mb-3 xl:mb-4 2xl:mb-6\">\n                      1-2 minutes\n                    </p>\n                    <p className=\"text-sm sm:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-blue-600 dark:text-blue-400\">\n                      {isPremium ? 'Using advanced AI model for detailed analysis' : 'Processing with AI for comprehensive insights'}\n                    </p>\n                    {comparisonMutation.isPending && (\n                      <div className=\"mt-4 p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg\">\n                        <p className=\"text-sm text-blue-800 dark:text-blue-200 font-medium\">\n                          🔄 AI analysis in progress... This may take up to 2 minutes for complex comparisons.\n                        </p>\n                        <p className=\"text-xs text-blue-600 dark:text-blue-300 mt-1\">\n                          Elapsed time: {Math.floor(elapsedTime / 60)}:{(elapsedTime % 60).toString().padStart(2, '0')}\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 lg:gap-4 xl:gap-6 2xl:gap-8 w-full\">\n                    {steps.map((step, index) => {\n                      const StepIcon = step.icon;\n                      const isActive = index === currentStep;\n                      const isCompleted = index < currentStep;\n                      \n                      return (\n                        <div\n                          key={index}\n                          className={`flex flex-col items-center p-2 sm:p-3 lg:p-4 xl:p-6 2xl:p-8 rounded-lg transition-all duration-300 ${\n                            isActive\n                              ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 transform scale-105 shadow-md'\n                              : isCompleted\n                              ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300'\n                              : 'bg-gray-50 dark:bg-gray-800 text-gray-400'\n                          }`}\n                        >\n                          <StepIcon className={`h-5 w-5 sm:h-6 sm:w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 2xl:h-10 2xl:w-10 mb-1 sm:mb-2 lg:mb-3 xl:mb-4 2xl:mb-6 flex-shrink-0 ${isActive ? 'animate-bounce' : ''}`} />\n                          <span className=\"text-xs sm:text-sm lg:text-base xl:text-lg 2xl:text-xl text-center font-medium leading-tight\">\n                            {step.text.split(' ').slice(0, 2).join(' ')}\n                          </span>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <div className=\"lg:col-span-4 space-y-4 lg:space-y-6 xl:space-y-8 2xl:space-y-10\">\n              \n              <Card className=\"shadow-lg border h-fit overflow-hidden\">\n                <CardHeader className=\"pb-3 lg:pb-4 xl:pb-6 2xl:pb-8\">\n                  <CardTitle className=\"text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl flex items-center gap-2 lg:gap-3 xl:gap-4\">\n                    <Users className=\"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 xl:h-7 xl:w-7 2xl:h-8 2xl:w-8 flex-shrink-0\" />\n                    <span className=\"truncate\">Languages Compared</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2 lg:space-y-3 xl:space-y-4 2xl:space-y-6\">\n                    {selectedLanguages.map((lang: string) => (\n                      <div key={lang} className=\"flex items-center justify-between p-2 sm:p-3 lg:p-4 xl:p-6 2xl:p-8 bg-gray-50 dark:bg-gray-800 rounded-lg min-w-0\">\n                        <span className=\"font-medium text-sm sm:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-700 dark:text-gray-300 truncate flex-1 mr-2\">\n                          {lang.toUpperCase()}\n                        </span>\n                        <Badge variant=\"outline\" className=\"text-xs sm:text-sm lg:text-base xl:text-lg 2xl:text-xl px-2 lg:px-3 xl:px-4 2xl:px-6 py-1 xl:py-2 2xl:py-3 flex-shrink-0\">\n                          Wikipedia\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {isPremium && premiumOptions && (\n                <Card className=\"shadow-lg border h-fit overflow-hidden\">\n                  <CardHeader className=\"pb-3 lg:pb-4 xl:pb-6 2xl:pb-8\">\n                    <CardTitle className=\"text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl flex items-center gap-2 lg:gap-3 xl:gap-4\">\n                      <Sparkles className=\"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 xl:h-7 xl:w-7 2xl:h-8 2xl:w-8 flex-shrink-0\" />\n                      <span className=\"truncate\">Premium Analysis</span>\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"space-y-2 lg:space-y-3 xl:space-y-4 2xl:space-y-6\">\n                    <div className=\"text-sm sm:text-base lg:text-lg xl:text-xl 2xl:text-2xl space-y-2 sm:space-y-3 xl:space-y-4 2xl:space-y-6\">\n                      <div className=\"flex justify-between items-center min-w-0\">\n                        <span className=\"text-gray-600 dark:text-gray-400 flex-shrink-0 mr-2 sm:mr-3 xl:mr-4 2xl:mr-6\">Format:</span>\n                        <span className=\"font-medium capitalize truncate\">{premiumOptions.outputFormat}</span>\n                      </div>\n                      <div className=\"flex justify-between items-center min-w-0\">\n                        <span className=\"text-gray-600 dark:text-gray-400 flex-shrink-0 mr-2 sm:mr-3 xl:mr-4 2xl:mr-6\">Style:</span>\n                        <span className=\"font-medium capitalize truncate\">{premiumOptions.formality}</span>\n                      </div>\n                      <div className=\"flex justify-between items-center min-w-0\">\n                        <span className=\"text-gray-600 dark:text-gray-400 flex-shrink-0 mr-2 sm:mr-3 xl:mr-4 2xl:mr-6\">Mode:</span>\n                        <span className=\"font-medium capitalize truncate\">{premiumOptions.analysisMode}</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              <Card className=\"shadow-lg border bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 h-fit overflow-hidden\">\n                <CardContent className=\"p-4 sm:p-5 lg:p-6 xl:p-8 2xl:p-10\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl sm:text-3xl lg:text-4xl xl:text-5xl 2xl:text-6xl mb-2 sm:mb-3 lg:mb-4 xl:mb-6 2xl:mb-8\">💡</div>\n                    <h3 className=\"font-bold text-base sm:text-lg lg:text-xl xl:text-2xl 2xl:text-3xl mb-2 sm:mb-3 lg:mb-4 xl:mb-6 2xl:mb-8 text-gray-900 dark:text-white\">\n                      Did You Know?\n                    </h3>\n                    <p className=\"text-sm sm:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-300 leading-relaxed\">\n                      Wikipedia articles can vary significantly between languages, \n                      reflecting different cultural perspectives, regional knowledge, \n                      and editorial priorities.\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n              \n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":14985,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/responsive-nav.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'wouter';\nimport { Menu, X, Search, History, HelpCircle, Info, Settings, Library } from 'lucide-react';\nimport { SettingsDialog } from './settings-dialog';\nimport { ThemeToggle } from './theme-toggle';\n\ninterface NavItem {\n  href: string;\n  label: string;\n  icon: React.ReactNode;\n  section: string;\n}\n\nconst NAV_ITEMS: NavItem[] = [\n  { href: '/', label: 'Main page', icon: <Search className=\"w-4 h-4\" />, section: 'Primary' },\n  { href: '/search', label: 'Search articles', icon: <Search className=\"w-4 h-4\" />, section: 'Primary' },\n  { href: '/library', label: 'Library', icon: <Library className=\"w-4 h-4\" />, section: 'Primary' },\n  { href: '/recent', label: 'Recent comparisons', icon: <History className=\"w-4 h-4\" />, section: 'Tools' },\n  { href: '/about', label: 'About', icon: <Info className=\"w-4 h-4\" />, section: 'Help' },\n  { href: '/how-it-works', label: 'How it works', icon: <Info className=\"w-4 h-4\" />, section: 'Help' },\n  { href: '/privacy', label: 'Privacy', icon: <Info className=\"w-4 h-4\" />, section: 'Help' },\n];\n\nexport function ResponsiveNav() {\n  const [location] = useLocation();\n  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 1024);\n    };\n    \n    checkMobile();\n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  useEffect(() => {\n    // Close mobile menu when route changes\n    setIsMobileMenuOpen(false);\n  }, [location]);\n\n  const toggleMobileMenu = () => {\n    setIsMobileMenuOpen(!isMobileMenuOpen);\n  };\n\n  const groupedItems = NAV_ITEMS.reduce((groups, item) => {\n    if (!groups[item.section]) {\n      groups[item.section] = [];\n    }\n    groups[item.section].push(item);\n    return groups;\n  }, {} as Record<string, NavItem[]>);\n\n  return (\n    <>\n      {/* Mobile Navigation */}\n      {isMobile && (\n        <>\n          {/* Mobile Header */}\n          <header className=\"fixed top-0 left-0 right-0 bg-background border-b border-border z-30 px-4 py-3\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <button\n                  onClick={toggleMobileMenu}\n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  aria-label=\"Toggle menu\"\n                >\n                  <Menu className=\"w-5 h-5\" />\n                </button>\n                <h1 className=\"text-xl font-bold\">\n                  <Link href=\"/\" className=\"text-foreground hover:text-primary\">\n                    Wiki Truth\n                  </Link>\n                </h1>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <ThemeToggle />\n                <SettingsDialog />\n              </div>\n            </div>\n          </header>\n\n          {/* Mobile Menu Overlay */}\n          {isMobileMenuOpen && (\n            <div className=\"mobile-nav-overlay\" onClick={toggleMobileMenu} />\n          )}\n\n          {/* Mobile Menu Panel */}\n          <nav className={`mobile-nav-panel ${isMobileMenuOpen ? 'open' : 'closed'}`}>\n            <div className=\"p-4 border-b border-border\">\n              <div className=\"flex items-center justify-between\">\n                <h2 className=\"text-lg font-semibold text-foreground\">Navigation</h2>\n                <button\n                  onClick={toggleMobileMenu}\n                  className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\n                  aria-label=\"Close menu\"\n                >\n                  <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n\n            <div className=\"p-4 space-y-6\">\n              {Object.entries(groupedItems).map(([section, items]) => (\n                <div key={section}>\n                  <h3 className=\"text-sm font-medium text-muted-foreground mb-3\">{section}</h3>\n                  <div className=\"space-y-1\">\n                    {items.map(item => (\n                      <Link\n                        key={item.href}\n                        href={item.href}\n                        className={`wiki-nav-link ${location === item.href ? 'active' : ''}`}\n                        onClick={(e) => {\n                          e.preventDefault();\n                          // Close menu with animation\n                          setIsMobileMenuOpen(false);\n                          // Navigate after animation completes\n                          setTimeout(() => {\n                            // Use wouter's navigation\n                            const link = document.createElement('a');\n                            link.href = item.href;\n                            link.click();\n                          }, 200);\n                        }}\n                      >\n                        {item.icon}\n                        {item.label}\n                      </Link>\n                    ))}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </nav>\n\n          {/* Mobile Bottom Navigation */}\n          <div className=\"mobile-bottom-nav\">\n            <div className=\"flex items-center justify-around\">\n              <Link \n                href=\"/\" \n                className=\"flex flex-col items-center gap-1 py-2 px-3 text-xs\"\n                onClick={() => {\n                  setTimeout(() => window.scrollTo({ top: 0, behavior: 'instant' }), 50);\n                }}\n              >\n                <Search className=\"w-4 h-4\" />\n                <span>Search</span>\n              </Link>\n              <Link \n                href=\"/library\" \n                className=\"flex flex-col items-center gap-1 py-2 px-3 text-xs\"\n                onClick={() => {\n                  setTimeout(() => window.scrollTo({ top: 0, behavior: 'instant' }), 50);\n                }}\n              >\n                <Library className=\"w-4 h-4\" />\n                <span>Library</span>\n              </Link>\n              <Link \n                href=\"/recent\" \n                className=\"flex flex-col items-center gap-1 py-2 px-3 text-xs\"\n                onClick={() => {\n                  setTimeout(() => window.scrollTo({ top: 0, behavior: 'instant' }), 50);\n                }}\n              >\n                <History className=\"w-4 h-4\" />\n                <span>History</span>\n              </Link>\n              <Link \n                href=\"/about\" \n                className=\"flex flex-col items-center gap-1 py-2 px-3 text-xs\"\n                onClick={() => {\n                  setTimeout(() => window.scrollTo({ top: 0, behavior: 'instant' }), 50);\n                }}\n              >\n                <Info className=\"w-4 h-4\" />\n                <span>About</span>\n              </Link>\n            </div>\n          </div>\n        </>\n      )}\n\n      {/* Desktop Navigation */}\n      {!isMobile && (\n        <>\n          {/* Desktop Header */}\n          <header className=\"fixed top-0 left-0 right-0 bg-background border-b border-border z-30 px-6 py-4\">\n            <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\n              <div className=\"flex items-center gap-4\">\n                <h1 className=\"text-2xl font-bold\">\n                  <Link href=\"/\" className=\"text-foreground hover:text-primary\">\n                    Wiki Truth\n                  </Link>\n                </h1>\n                <span className=\"text-sm text-muted-foreground\">Privacy-first comparison</span>\n              </div>\n              <div className=\"flex items-center gap-6\">\n                <nav className=\"flex items-center gap-6\">\n                  <Link href=\"/search\" className=\"wiki-link text-sm\">Search</Link>\n                  <Link href=\"/library\" className=\"wiki-link text-sm\">Library</Link>\n                  <Link href=\"/recent\" className=\"wiki-link text-sm\">History</Link>\n                  <Link href=\"/help\" className=\"wiki-link text-sm\">Help</Link>\n                  <Link href=\"/about\" className=\"wiki-link text-sm\">About</Link>\n                </nav>\n                <div className=\"flex items-center gap-3\">\n                  <ThemeToggle />\n                  <SettingsDialog />\n                </div>\n              </div>\n            </div>\n          </header>\n\n          {/* Desktop Sidebar */}\n          <aside className=\"desktop-sidebar pt-20\">\n            <div className=\"p-6 space-y-6\">\n              {Object.entries(groupedItems).map(([section, items]) => (\n                <div key={section}>\n                  <h3 className=\"text-sm font-medium text-wiki-gray mb-3\">{section}</h3>\n                  <div className=\"space-y-1\">\n                    {items.map(item => (\n                      <Link\n                        key={item.href}\n                        href={item.href}\n                        className={`wiki-nav-link ${location === item.href ? 'active' : ''}`}\n                      >\n                        {item.icon}\n                        {item.label}\n                      </Link>\n                    ))}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </aside>\n        </>\n      )}\n    </>\n  );\n}","path":null,"size_bytes":9358,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/theme-toggle.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Moon, Sun } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\nexport function ThemeToggle() {\n  const [isDark, setIsDark] = useState(false);\n\n  useEffect(() => {\n    const savedTheme = localStorage.getItem('wiki-truth-theme');\n    // Default to light theme - only use dark if explicitly saved as dark\n    const shouldBeDark = savedTheme === 'dark';\n    \n    setIsDark(shouldBeDark);\n    if (shouldBeDark) {\n      document.documentElement.classList.add('dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n    }\n  }, []);\n\n  const toggleTheme = () => {\n    const newIsDark = !isDark;\n    setIsDark(newIsDark);\n    \n    if (newIsDark) {\n      document.documentElement.classList.add('dark');\n      localStorage.setItem('wiki-truth-theme', 'dark');\n    } else {\n      document.documentElement.classList.remove('dark');\n      localStorage.setItem('wiki-truth-theme', 'light');\n    }\n  };\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n      className=\"relative\"\n    >\n      <Sun className={`h-5 w-5 transition-all ${isDark ? 'rotate-90 scale-0' : 'rotate-0 scale-100'}`} />\n      <Moon className={`absolute h-5 w-5 transition-all ${isDark ? 'rotate-0 scale-100' : '-rotate-90 scale-0'}`} />\n      <span className=\"sr-only\">Toggle theme</span>\n    </Button>\n  );\n}\n","path":null,"size_bytes":1445,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/pages/report-issues.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { AlertTriangle, Bug, Zap, FileText, Mail, Info, ArrowLeft, Monitor, Smartphone, Copy, ExternalLink } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\n\nexport default function ReportIssuesPage() {\n  const [formData, setFormData] = useState({\n    title: '',\n    email: '',\n    category: '',\n    priority: '',\n    description: '',\n    steps: '',\n    expected: '',\n    actual: '',\n    browser: '',\n    os: '',\n    includeData: false\n  });\n  const [activeTab, setActiveTab] = useState(\"report\");\n  const [systemInfo, setSystemInfo] = useState<any>(null);\n  const { toast } = useToast();\n\n  // Auto-detect system information on mount\n  useEffect(() => {\n    const info = {\n      userAgent: navigator.userAgent,\n      platform: navigator.platform,\n      language: navigator.language,\n      cookieEnabled: navigator.cookieEnabled,\n      onLine: navigator.onLine,\n      screenResolution: `${screen.width}x${screen.height}`,\n      viewport: `${window.innerWidth}x${window.innerHeight}`,\n      colorDepth: screen.colorDepth,\n      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n      timestamp: new Date().toISOString()\n    };\n    setSystemInfo(info);\n    \n    // Auto-fill browser and OS\n    setFormData(prev => ({\n      ...prev,\n      browser: detectBrowser(),\n      os: detectOS()\n    }));\n  }, []);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Collect system information\n    const systemInfo = {\n      userAgent: navigator.userAgent,\n      platform: navigator.platform,\n      language: navigator.language,\n      cookieEnabled: navigator.cookieEnabled,\n      onLine: navigator.onLine,\n      screenResolution: `${screen.width}x${screen.height}`,\n      timestamp: new Date().toISOString()\n    };\n\n    // Prepare email content\n    const emailSubject = `Wiki Truth Issue Report: ${formData.title}`;\n    const emailBody = `\nISSUE REPORT\n============\n\nTitle: ${formData.title}\nEmail: ${formData.email}\nCategory: ${formData.category}\nPriority: ${formData.priority}\n\nDESCRIPTION\n-----------\n${formData.description}\n\nSTEPS TO REPRODUCE\n------------------\n${formData.steps}\n\nEXPECTED BEHAVIOR\n-----------------\n${formData.expected}\n\nACTUAL BEHAVIOR\n---------------\n${formData.actual}\n\nUSER ENVIRONMENT\n----------------\nBrowser: ${formData.browser}\nOperating System: ${formData.os}\n\nSYSTEM INFORMATION\n------------------\nUser Agent: ${systemInfo.userAgent}\nPlatform: ${systemInfo.platform}\nLanguage: ${systemInfo.language}\nScreen Resolution: ${systemInfo.screenResolution}\nOnline Status: ${systemInfo.onLine}\nCookies Enabled: ${systemInfo.cookieEnabled}\nReport Timestamp: ${systemInfo.timestamp}\n\n${formData.includeData ? `\nDATA CONSENT\n------------\nUser has consented to include local data for debugging purposes.\n` : ''}\n`;\n\n    const mailtoLink = `mailto:issues@wikitruth.app?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;\n    window.open(mailtoLink, '_blank');\n    \n    toast({\n      title: \"Issue Report Prepared\",\n      description: \"Your email client should open with the detailed issue report. Thank you for helping us improve Wiki Truth!\",\n    });\n  };\n\n  const handleInputChange = (field: string, value: string | boolean) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  // Auto-detect browser and OS\n  const detectBrowser = () => {\n    const ua = navigator.userAgent;\n    if (ua.includes('Chrome')) return 'Chrome';\n    if (ua.includes('Firefox')) return 'Firefox';\n    if (ua.includes('Safari')) return 'Safari';\n    if (ua.includes('Edge')) return 'Edge';\n    return 'Other';\n  };\n\n  const detectOS = () => {\n    const ua = navigator.userAgent;\n    if (ua.includes('Windows')) return 'Windows';\n    if (ua.includes('Mac')) return 'macOS';\n    if (ua.includes('Linux')) return 'Linux';\n    if (ua.includes('Android')) return 'Android';\n    if (ua.includes('iOS')) return 'iOS';\n    return 'Other';\n  };\n\n  const copySystemInfo = () => {\n    if (systemInfo) {\n      navigator.clipboard.writeText(JSON.stringify(systemInfo, null, 2));\n      toast({\n        title: \"System Info Copied\",\n        description: \"System information has been copied to your clipboard\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Mobile & Desktop Header */}\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10\">\n        <div className=\"container mx-auto px-4 sm:px-6 py-3 sm:py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2 sm:gap-4 min-w-0 flex-1\">\n              <Button variant=\"ghost\" size=\"sm\" asChild>\n                <Link href=\"/\">\n                  <ArrowLeft className=\"h-4 w-4 sm:mr-2\" />\n                  <span className=\"hidden sm:inline\">Back to Wiki Truth</span>\n                </Link>\n              </Button>\n              <Separator orientation=\"vertical\" className=\"h-6 hidden sm:block\" />\n              <h1 className=\"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white truncate\">\n                Issue Reporter\n              </h1>\n            </div>\n            <div className=\"flex items-center gap-2 flex-shrink-0\">\n              <Badge variant=\"outline\" className=\"bg-orange-50 text-orange-700 border-orange-200 text-xs sm:text-sm\">\n                <Bug className=\"h-3 w-3 mr-1\" />\n                <span className=\"hidden sm:inline\">Bug Tracker</span>\n                <span className=\"sm:hidden\">Bug</span>\n              </Badge>\n              {systemInfo && (\n                <Button variant=\"outline\" size=\"sm\" onClick={copySystemInfo}>\n                  <Copy className=\"h-4 w-4 sm:mr-2\" />\n                  <span className=\"hidden sm:inline\">Copy System Info</span>\n                </Button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 sm:px-6 py-6 sm:py-8 max-w-7xl\">\n        <div className=\"text-center mb-6 sm:mb-8\">\n          <div className=\"inline-flex items-center gap-2 bg-red-100 dark:bg-red-900/30 px-3 py-1 rounded-full text-sm text-red-700 dark:text-red-300 mb-4\">\n            <AlertTriangle className=\"h-4 w-4\" />\n            Issue Reporting\n          </div>\n          <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-4\">\n            Help us improve Wiki Truth\n          </h1>\n          <p className=\"text-base sm:text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto\">\n            Report bugs, performance issues, or suggest improvements. Your feedback helps us build a better experience for everyone.\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Quick Issue Types */}\n          <Card className=\"md:col-span-1\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Info className=\"h-5 w-5\" />\n                Issue Types\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-start gap-3\">\n                <Bug className=\"h-5 w-5 text-red-500 mt-1\" />\n                <div>\n                  <h4 className=\"font-medium text-sm\">Bugs</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Application errors, crashes, or unexpected behavior\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-3\">\n                <Zap className=\"h-5 w-5 text-yellow-500 mt-1\" />\n                <div>\n                  <h4 className=\"font-medium text-sm\">Performance</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Slow loading, timeouts, or resource issues\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-3\">\n                <FileText className=\"h-5 w-5 text-blue-500 mt-1\" />\n                <div>\n                  <h4 className=\"font-medium text-sm\">Content</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Incorrect comparisons or data display issues\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"flex items-start gap-3\">\n                <AlertTriangle className=\"h-5 w-5 text-orange-500 mt-1\" />\n                <div>\n                  <h4 className=\"font-medium text-sm\">Security</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Privacy concerns or potential vulnerabilities\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Issue Report Form */}\n          <Card className=\"md:col-span-2\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Bug className=\"h-5 w-5\" />\n                Issue Details\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleSubmit} className=\"space-y-6\">\n                {/* Basic Information */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"title\">Issue Title</Label>\n                    <Input\n                      id=\"title\"\n                      value={formData.title}\n                      onChange={(e) => handleInputChange('title', e.target.value)}\n                      placeholder=\"Brief description of the issue\"\n                      required\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"email\">Your Email</Label>\n                    <Input\n                      id=\"email\"\n                      type=\"email\"\n                      value={formData.email}\n                      onChange={(e) => handleInputChange('email', e.target.value)}\n                      placeholder=\"your.email@example.com\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"category\">Category</Label>\n                    <Select value={formData.category} onValueChange={(value) => handleInputChange('category', value)}>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Select category\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"bug\">Bug Report</SelectItem>\n                        <SelectItem value=\"performance\">Performance Issue</SelectItem>\n                        <SelectItem value=\"content\">Content Problem</SelectItem>\n                        <SelectItem value=\"ui\">User Interface</SelectItem>\n                        <SelectItem value=\"security\">Security Concern</SelectItem>\n                        <SelectItem value=\"subscription\">Subscription Issue</SelectItem>\n                        <SelectItem value=\"other\">Other</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <Label htmlFor=\"priority\">Priority</Label>\n                    <Select value={formData.priority} onValueChange={(value) => handleInputChange('priority', value)}>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Select priority\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"low\">Low - Minor inconvenience</SelectItem>\n                        <SelectItem value=\"medium\">Medium - Affects functionality</SelectItem>\n                        <SelectItem value=\"high\">High - Blocks key features</SelectItem>\n                        <SelectItem value=\"critical\">Critical - App unusable</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                {/* Detailed Description */}\n                <div>\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    value={formData.description}\n                    onChange={(e) => handleInputChange('description', e.target.value)}\n                    placeholder=\"Detailed description of the issue...\"\n                    rows={4}\n                    required\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"steps\">Steps to Reproduce</Label>\n                  <Textarea\n                    id=\"steps\"\n                    value={formData.steps}\n                    onChange={(e) => handleInputChange('steps', e.target.value)}\n                    placeholder=\"1. Go to... 2. Click on... 3. See error...\"\n                    rows={3}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"expected\">Expected Behavior</Label>\n                    <Textarea\n                      id=\"expected\"\n                      value={formData.expected}\n                      onChange={(e) => handleInputChange('expected', e.target.value)}\n                      placeholder=\"What should have happened?\"\n                      rows={3}\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"actual\">Actual Behavior</Label>\n                    <Textarea\n                      id=\"actual\"\n                      value={formData.actual}\n                      onChange={(e) => handleInputChange('actual', e.target.value)}\n                      placeholder=\"What actually happened?\"\n                      rows={3}\n                    />\n                  </div>\n                </div>\n\n                {/* Environment Information */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"browser\">Browser</Label>\n                    <Input\n                      id=\"browser\"\n                      value={formData.browser}\n                      onChange={(e) => handleInputChange('browser', e.target.value)}\n                      placeholder={detectBrowser()}\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"os\">Operating System</Label>\n                    <Input\n                      id=\"os\"\n                      value={formData.os}\n                      onChange={(e) => handleInputChange('os', e.target.value)}\n                      placeholder={detectOS()}\n                    />\n                  </div>\n                </div>\n\n                {/* Privacy Consent */}\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"includeData\"\n                    checked={formData.includeData}\n                    onCheckedChange={(checked) => handleInputChange('includeData', checked as boolean)}\n                  />\n                  <Label htmlFor=\"includeData\" className=\"text-sm\">\n                    Include local data for debugging (Optional - only your comparison history, no personal data)\n                  </Label>\n                </div>\n\n                <Button type=\"submit\" className=\"w-full\">\n                  <Mail className=\"mr-2 h-4 w-4\" />\n                  Send Issue Report\n                </Button>\n              </form>\n\n              <div className=\"mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg\">\n                <p className=\"text-sm text-amber-700 dark:text-amber-300\">\n                  <strong>Privacy Notice:</strong> This form opens your email client with the report details. \n                  System information is included to help us diagnose issues. No data is sent to our servers.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Additional Resources */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Before Reporting</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid md:grid-cols-2 gap-6\">\n              <div>\n                <h4 className=\"font-medium mb-3\">Common Solutions</h4>\n                <ul className=\"space-y-2 text-sm text-gray-600 dark:text-gray-300\">\n                  <li>• Try refreshing the page or clearing browser cache</li>\n                  <li>• Check if the issue occurs in a different browser</li>\n                  <li>• Ensure you have stable internet connection</li>\n                  <li>• Disable browser extensions that might interfere</li>\n                </ul>\n              </div>\n              <div>\n                <h4 className=\"font-medium mb-3\">Helpful Information</h4>\n                <ul className=\"space-y-2 text-sm text-gray-600 dark:text-gray-300\">\n                  <li>• Screenshots or screen recordings of the issue</li>\n                  <li>• Browser console error messages (F12 → Console)</li>\n                  <li>• Specific article titles or languages that cause issues</li>\n                  <li>• Time when the issue occurred</li>\n                </ul>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":18308,"size_tokens":null},"client/src/components/history-dialog.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Separator } from '@/components/ui/separator';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { History, Trash2, Eye, Download, Share } from 'lucide-react';\nimport { clientStorage } from '@/lib/storage';\nimport { type ComparisonResult } from '@/lib/api';\nimport { api } from '@/lib/api';\nimport { useToast } from '@/hooks/use-toast';\nimport { useLocation } from 'wouter';\n\nexport function HistoryDialog() {\n  const [open, setOpen] = useState(false);\n  const [comparisons, setComparisons] = useState<ComparisonResult[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (open) {\n      loadComparisons();\n    }\n  }, [open]);\n\n  const loadComparisons = async () => {\n    setLoading(true);\n    try {\n      const userComparisons = await api.getUserComparisons();\n      setComparisons(userComparisons);\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to load comparison history\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleView = (id: string) => {\n    setOpen(false);\n    setLocation(`/comparison/${id}`);\n  };\n\n  const handleDelete = async (id: string, title: string) => {\n    if (!confirm(`Delete comparison for \"${title}\"?`)) return;\n\n    try {\n      await api.deleteComparison(id);\n      setComparisons(prev => prev.filter(comp => comp.id !== id));\n      toast({\n        title: \"Deleted\",\n        description: \"Comparison removed from history\"\n      });\n    } catch (error) {\n      toast({\n        title: \"Error\",\n        description: \"Failed to delete comparison\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleExport = async (id: string, title: string) => {\n    try {\n      const blob = await api.exportComparison(id);\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `wiki-truth-${title.replace(/[^a-zA-Z0-9]/g, '_')}-comparison.txt`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n      \n      toast({\n        title: \"Exported\",\n        description: \"Comparison downloaded as text file\"\n      });\n    } catch (error) {\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export comparison\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleShare = async (id: string, platform: string = 'twitter') => {\n    try {\n      const shareUrl = await api.shareComparison(id, platform);\n      window.open(shareUrl, '_blank');\n    } catch (error) {\n      toast({\n        title: \"Share Failed\",\n        description: \"Failed to create share link\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\">\n          <History className=\"h-4 w-4 mr-2\" />\n          History\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-4xl max-h-[90vh]\">\n        <DialogHeader>\n          <DialogTitle>Comparison History</DialogTitle>\n        </DialogHeader>\n        \n        <ScrollArea className=\"max-h-[70vh]\">\n          {loading ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              Loading your comparisons...\n            </div>\n          ) : comparisons.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <History className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>No comparisons yet</p>\n              <p className=\"text-sm\">Start by searching for a Wikipedia article</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {comparisons.map((comparison) => (\n                <div key={comparison.id} className=\"border rounded-lg p-4\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-semibold text-lg mb-2\">{comparison.articleTitle}</h3>\n                      <div className=\"flex flex-wrap gap-2 mb-3\">\n                        {comparison.selectedLanguages.map(lang => (\n                          <Badge key={lang} variant=\"secondary\">{lang}</Badge>\n                        ))}\n                        <Badge variant=\"outline\">Output: {comparison.outputLanguage}</Badge>\n                        {comparison.isFunnyMode && (\n                          <Badge variant=\"default\">Funny Mode</Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        Created: {new Date(comparison.createdAt).toLocaleString()}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {comparison.articles.length} articles compared\n                      </p>\n                    </div>\n                    <div className=\"flex gap-2 ml-4\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleView(comparison.id)}\n                      >\n                        <Eye className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleExport(comparison.id, comparison.articleTitle)}\n                      >\n                        <Download className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleShare(comparison.id)}\n                      >\n                        <Share className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleDelete(comparison.id, comparison.articleTitle)}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  \n                  {comparison.comparisonResult && (\n                    <>\n                      <Separator className=\"my-3\" />\n                      <div className=\"text-sm\">\n                        <p className=\"font-medium mb-2\">Preview:</p>\n                        <p className=\"text-muted-foreground line-clamp-3\">\n                          {comparison.comparisonResult.slice(0, 200)}...\n                        </p>\n                      </div>\n                    </>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </ScrollArea>\n        \n        {comparisons.length > 0 && (\n          <div className=\"flex justify-between items-center pt-4 border-t\">\n            <p className=\"text-sm text-muted-foreground\">\n              {comparisons.length} comparison{comparisons.length !== 1 ? 's' : ''} stored locally\n            </p>\n            <Button onClick={loadComparisons} variant=\"outline\" size=\"sm\">\n              Refresh\n            </Button>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":7693,"size_tokens":null},"client/src/components/donation-banner.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useLocation } from 'wouter';\nimport { X, ChevronLeft, ChevronRight } from 'lucide-react';\n\nconst messages = [\n  {\n    title: \"WikiTruth needs your support.\",\n    subtitle: \"Help us uncover global perspectives.\",\n    text: \"We're an independent, privacy-first tool comparing Wikipedia across languages. No ads, no tracking - just honest analysis powered by your support.\"\n  },\n  {\n    title: \"See how stories differ worldwide.\",\n    subtitle: \"Help us keep this free.\",\n    text: \"WikiTruth reveals how the same topic is written differently in every language. Your donation helps us maintain this unique cross-cultural tool.\"\n  },\n  {\n    title: \"Privacy-first. Always free.\",\n    subtitle: \"Your support makes it possible.\",\n    text: \"Unlike most services, we never track you or sell your data. Your contribution keeps WikiTruth running and accessible to everyone.\"\n  }\n];\n\nexport function DonationBanner() {\n  const [location] = useLocation();\n  const [isVisible, setIsVisible] = useState(false);\n  const [currentMessage, setCurrentMessage] = useState(0);\n  const [isDismissed, setIsDismissed] = useState(false);\n\n  useEffect(() => {\n    // Show banner on main page on every page load/refresh\n    if (location === '/' && !isDismissed) {\n      setIsVisible(true);\n    } else {\n      setIsVisible(false);\n    }\n  }, [location, isDismissed]);\n\n  const handleDismiss = () => {\n    setIsVisible(false);\n    setIsDismissed(true);\n    // Only persist within session navigation, but not on full page refresh\n  };\n\n  const handleAlreadyDonated = () => {\n    handleDismiss();\n  };\n\n  const nextMessage = () => {\n    setCurrentMessage((prev) => (prev + 1) % messages.length);\n  };\n\n  const prevMessage = () => {\n    setCurrentMessage((prev) => (prev - 1 + messages.length) % messages.length);\n  };\n\n  if (!isVisible || isDismissed) {\n    return null;\n  }\n\n  const message = messages[currentMessage];\n\n  return (\n    <div className=\"fixed top-0 left-0 right-0 z-[100] bg-[#c8ccd1] dark:bg-[#27292d] border-b border-[#a2a9b1] dark:border-[#54595d] shadow-sm\">\n      <div className=\"container mx-auto px-4 py-6 md:py-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"flex items-start gap-4\">\n            <button\n              onClick={prevMessage}\n              className=\"flex-shrink-0 p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full transition-colors mt-4\"\n              aria-label=\"Previous message\"\n              data-testid=\"button-banner-prev\"\n            >\n              <ChevronLeft className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\n            </button>\n\n            <div className=\"flex-1 text-center\">\n              <div className=\"flex items-center justify-center gap-2 mb-3\">\n                <span className=\"text-red-600 dark:text-red-500 text-xl\">i</span>\n                <h3 className=\"text-lg md:text-xl font-bold text-gray-900 dark:text-white\">\n                  {new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric' })}, {new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }).toLowerCase()}: \"{message.title}\" - {message.subtitle}\n                </h3>\n              </div>\n              \n              <p className=\"text-base md:text-lg text-gray-800 dark:text-gray-200 mb-6 leading-relaxed\">\n                {message.text}\n              </p>\n\n              <div className=\"flex justify-center gap-2 mb-4\">\n                {messages.map((_, index) => (\n                  <button\n                    key={index}\n                    onClick={() => setCurrentMessage(index)}\n                    className={`w-3 h-3 rounded-full transition-colors ${\n                      index === currentMessage \n                        ? 'bg-red-500' \n                        : 'bg-gray-400 dark:bg-gray-500 hover:bg-gray-500 dark:hover:bg-gray-400'\n                    }`}\n                    aria-label={`Go to message ${index + 1}`}\n                    data-testid={`button-banner-dot-${index}`}\n                  />\n                ))}\n              </div>\n\n              <div className=\"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4\">\n                <a\n                  href=\"https://ko-fi.com/wikitruth\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  data-testid=\"donation-proceed-button\"\n                  className=\"w-full sm:w-auto inline-flex items-center justify-center px-8 py-3 bg-[#36c] hover:bg-[#2a4b8d] text-white font-semibold rounded transition-colors duration-200 text-base\"\n                  onClick={handleDismiss}\n                >\n                  Proceed with the donation\n                </a>\n              </div>\n\n              <div className=\"flex items-center justify-center gap-6 mt-4 text-sm text-gray-600 dark:text-gray-400\">\n                <button\n                  onClick={handleAlreadyDonated}\n                  className=\"hover:text-gray-900 dark:hover:text-gray-200 transition-colors flex items-center gap-1\"\n                  data-testid=\"button-already-donated\"\n                >\n                  <span className=\"text-green-600 dark:text-green-500\">✓</span>\n                  I've already donated\n                </button>\n                <button\n                  onClick={handleDismiss}\n                  className=\"hover:text-gray-900 dark:hover:text-gray-200 transition-colors\"\n                  data-testid=\"button-maybe-later\"\n                >\n                  Maybe later\n                </button>\n              </div>\n            </div>\n\n            <button\n              onClick={nextMessage}\n              className=\"flex-shrink-0 p-2 hover:bg-black/5 dark:hover:bg-white/5 rounded-full transition-colors mt-4\"\n              aria-label=\"Next message\"\n              data-testid=\"button-banner-next\"\n            >\n              <ChevronRight className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\n            </button>\n\n            <button\n              onClick={handleDismiss}\n              data-testid=\"donation-close-button\"\n              className=\"absolute top-2 right-2 p-1.5 rounded-full hover:bg-black/5 dark:hover:bg-white/5 transition-colors\"\n              aria-label=\"Close banner\"\n            >\n              <X className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":6421,"size_tokens":null},"server/storage.ts":{"content":"import { \n  comparisons, \n  searchSessions,\n  highlights,\n  users,\n  payments,\n  type Comparison, \n  type InsertComparison,\n  type SearchSession,\n  type InsertSearchSession,\n  type Highlight,\n  type InsertHighlight,\n  type User,\n  type InsertUser,\n  type Payment,\n  type InsertPayment\n} from \"@shared/schema\";\n\nexport interface IStorage {\n  // User operations\n  getOrCreateUser(visitorId: string): Promise<User>;\n  getUserByVisitorId(visitorId: string): Promise<User | undefined>;\n  incrementUserGenerations(visitorId: string): Promise<User | undefined>;\n  setUserPremium(visitorId: string, isPremium: boolean, expiresAt?: Date): Promise<User | undefined>;\n  updateUserEmail(visitorId: string, email: string): Promise<User | undefined>;\n  \n  // Payment operations\n  createPayment(payment: InsertPayment): Promise<Payment>;\n  getPaymentByOrderId(orderId: string): Promise<Payment | undefined>;\n  updatePaymentStatus(orderId: string, status: string, maxelpayOrderId?: string): Promise<Payment | undefined>;\n  \n  // Comparison operations\n  createComparison(comparison: InsertComparison): Promise<Comparison>;\n  getComparison(id: number): Promise<Comparison | undefined>;\n  getPublicComparisons(outputLanguage?: string, limit?: number, offset?: number): Promise<Comparison[]>;\n  getPublicComparisonsCount(outputLanguage?: string): Promise<number>;\n  \n  // Search session operations\n  createSearchSession(session: InsertSearchSession): Promise<SearchSession>;\n  getSearchSession(sessionId: string): Promise<SearchSession | undefined>;\n  updateSearchSession(sessionId: string, updates: Partial<InsertSearchSession>): Promise<SearchSession | undefined>;\n  \n  // Highlight operations\n  createHighlight(highlight: InsertHighlight): Promise<Highlight>;\n  getHighlightsByComparisonId(comparisonId: number): Promise<Highlight[]>;\n  deleteHighlight(id: number): Promise<boolean>;\n  deleteHighlightsByComparisonId(comparisonId: number): Promise<boolean>;\n}\n\nexport class MemStorage implements IStorage {\n  private comparisons: Map<number, Comparison>;\n  private searchSessions: Map<string, SearchSession>;\n  private highlights: Map<number, Highlight>;\n  private usersMap: Map<string, User>;\n  private paymentsMap: Map<string, Payment>;\n  private currentComparisonId: number;\n  private currentSessionId: number;\n  private currentHighlightId: number;\n  private currentUserId: number;\n  private currentPaymentId: number;\n\n  constructor() {\n    this.comparisons = new Map();\n    this.searchSessions = new Map();\n    this.highlights = new Map();\n    this.usersMap = new Map();\n    this.paymentsMap = new Map();\n    this.currentComparisonId = 1;\n    this.currentSessionId = 1;\n    this.currentHighlightId = 1;\n    this.currentUserId = 1;\n    this.currentPaymentId = 1;\n  }\n\n  async getOrCreateUser(visitorId: string): Promise<User> {\n    let user = this.usersMap.get(visitorId);\n    if (!user) {\n      user = {\n        id: this.currentUserId++,\n        visitorId,\n        email: null,\n        generationsUsed: 0,\n        isPremium: false,\n        subscriptionId: null,\n        subscriptionExpiresAt: null,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      };\n      this.usersMap.set(visitorId, user);\n    }\n    return user;\n  }\n\n  async getUserByVisitorId(visitorId: string): Promise<User | undefined> {\n    return this.usersMap.get(visitorId);\n  }\n\n  async incrementUserGenerations(visitorId: string): Promise<User | undefined> {\n    const user = this.usersMap.get(visitorId);\n    if (!user) return undefined;\n    user.generationsUsed++;\n    user.updatedAt = new Date();\n    return user;\n  }\n\n  async setUserPremium(visitorId: string, isPremium: boolean, expiresAt?: Date): Promise<User | undefined> {\n    const user = this.usersMap.get(visitorId);\n    if (!user) return undefined;\n    user.isPremium = isPremium;\n    user.subscriptionExpiresAt = expiresAt || null;\n    user.updatedAt = new Date();\n    return user;\n  }\n\n  async updateUserEmail(visitorId: string, email: string): Promise<User | undefined> {\n    const user = this.usersMap.get(visitorId);\n    if (!user) return undefined;\n    user.email = email;\n    user.updatedAt = new Date();\n    return user;\n  }\n\n  async createPayment(insertPayment: InsertPayment): Promise<Payment> {\n    const payment: Payment = {\n      id: this.currentPaymentId++,\n      userId: insertPayment.userId,\n      orderId: insertPayment.orderId,\n      amount: insertPayment.amount,\n      currency: insertPayment.currency || 'USD',\n      status: insertPayment.status || 'pending',\n      maxelpayOrderId: insertPayment.maxelpayOrderId || null,\n      createdAt: new Date(),\n      updatedAt: new Date()\n    };\n    this.paymentsMap.set(insertPayment.orderId, payment);\n    return payment;\n  }\n\n  async getPaymentByOrderId(orderId: string): Promise<Payment | undefined> {\n    return this.paymentsMap.get(orderId);\n  }\n\n  async updatePaymentStatus(orderId: string, status: string, maxelpayOrderId?: string): Promise<Payment | undefined> {\n    const payment = this.paymentsMap.get(orderId);\n    if (!payment) return undefined;\n    payment.status = status;\n    if (maxelpayOrderId) payment.maxelpayOrderId = maxelpayOrderId;\n    payment.updatedAt = new Date();\n    return payment;\n  }\n\n  async createComparison(insertComparison: InsertComparison): Promise<Comparison> {\n    const id = this.currentComparisonId++;\n    const comparison: Comparison = { \n      id,\n      articleTitle: insertComparison.articleTitle,\n      selectedLanguages: insertComparison.selectedLanguages,\n      outputLanguage: insertComparison.outputLanguage,\n      comparisonResult: insertComparison.comparisonResult || null,\n      isFunnyMode: insertComparison.isFunnyMode || null,\n      isPremium: insertComparison.isPremium || null,\n      isPublic: insertComparison.isPublic ?? true,\n      createdAt: new Date()\n    };\n    this.comparisons.set(id, comparison);\n    return comparison;\n  }\n\n  async getComparison(id: number): Promise<Comparison | undefined> {\n    return this.comparisons.get(id);\n  }\n\n  async getPublicComparisons(outputLanguage?: string, limit: number = 20, offset: number = 0): Promise<Comparison[]> {\n    const allComparisons = Array.from(this.comparisons.values())\n      .filter(c => c.isPublic && c.comparisonResult)\n      .filter(c => !outputLanguage || c.outputLanguage === outputLanguage)\n      .sort((a, b) => {\n        const dateA = a.createdAt ? new Date(a.createdAt).getTime() : 0;\n        const dateB = b.createdAt ? new Date(b.createdAt).getTime() : 0;\n        return dateB - dateA;\n      });\n    \n    return allComparisons.slice(offset, offset + limit);\n  }\n\n  async getPublicComparisonsCount(outputLanguage?: string): Promise<number> {\n    return Array.from(this.comparisons.values())\n      .filter(c => c.isPublic && c.comparisonResult)\n      .filter(c => !outputLanguage || c.outputLanguage === outputLanguage)\n      .length;\n  }\n\n  async createSearchSession(insertSession: InsertSearchSession): Promise<SearchSession> {\n    const id = this.currentSessionId++;\n    const session: SearchSession = { \n      id,\n      sessionId: insertSession.sessionId,\n      searchQuery: insertSession.searchQuery || null,\n      selectedArticle: insertSession.selectedArticle || null,\n      availableLanguages: insertSession.availableLanguages || null,\n      createdAt: new Date()\n    };\n    this.searchSessions.set(insertSession.sessionId, session);\n    return session;\n  }\n\n  async getSearchSession(sessionId: string): Promise<SearchSession | undefined> {\n    return this.searchSessions.get(sessionId);\n  }\n\n  async updateSearchSession(sessionId: string, updates: Partial<InsertSearchSession>): Promise<SearchSession | undefined> {\n    const existing = this.searchSessions.get(sessionId);\n    if (!existing) return undefined;\n    \n    const updated: SearchSession = { ...existing, ...updates };\n    this.searchSessions.set(sessionId, updated);\n    return updated;\n  }\n\n  async createHighlight(insertHighlight: InsertHighlight): Promise<Highlight> {\n    const id = this.currentHighlightId++;\n    const highlight: Highlight = {\n      id,\n      comparisonId: insertHighlight.comparisonId,\n      startOffset: insertHighlight.startOffset,\n      endOffset: insertHighlight.endOffset,\n      color: insertHighlight.color,\n      excerpt: insertHighlight.excerpt,\n      createdAt: new Date()\n    };\n    this.highlights.set(id, highlight);\n    return highlight;\n  }\n\n  async getHighlightsByComparisonId(comparisonId: number): Promise<Highlight[]> {\n    const results: Highlight[] = [];\n    this.highlights.forEach((highlight) => {\n      if (highlight.comparisonId === comparisonId) {\n        results.push(highlight);\n      }\n    });\n    return results.sort((a, b) => a.startOffset - b.startOffset);\n  }\n\n  async deleteHighlight(id: number): Promise<boolean> {\n    return this.highlights.delete(id);\n  }\n\n  async deleteHighlightsByComparisonId(comparisonId: number): Promise<boolean> {\n    const toDelete: number[] = [];\n    this.highlights.forEach((highlight, id) => {\n      if (highlight.comparisonId === comparisonId) {\n        toDelete.push(id);\n      }\n    });\n    toDelete.forEach(id => this.highlights.delete(id));\n    return toDelete.length > 0;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":9201,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"server/services/openrouter.ts":{"content":"export interface ComparisonRequest {\n  articles: Record<string, string>; // language code -> article content\n  outputLanguage: string;\n  isFunnyMode?: boolean;\n}\n\nexport class OpenRouterService {\n  // List of free models to try in order of preference\n  private freeModels = [\n    \"google/gemini-2.0-flash-exp:free\",\n    \"qwen/qwen-2.5-7b-instruct:free\", \n    \"microsoft/phi-3.5-mini-instruct:free\",\n    \"mistralai/mistral-7b-instruct:free\"\n  ];\n\n  async compareArticles(request: ComparisonRequest): Promise<string> {\n    const { articles, outputLanguage, isFunnyMode = false } = request;\n    \n    if (!process.env.OPENROUTER_API_KEY) {\n      throw new Error('OpenRouter API key not configured');\n    }\n    \n    // Log the articles being compared for debugging\n    console.log('Articles being compared:', Object.keys(articles));\n    console.log('Article lengths:', Object.entries(articles).map(([lang, content]) => \n      `${lang}: ${content.length} characters`\n    ));\n    \n    const systemPrompt = isFunnyMode \n      ? this.getFunnyModeSystemPrompt(outputLanguage)\n      : this.getStandardSystemPrompt(outputLanguage);\n    \n    const userPrompt = this.buildUserPrompt(articles, isFunnyMode, outputLanguage);\n\n    // Try each model in order until one works\n    for (let i = 0; i < this.freeModels.length; i++) {\n      const model = this.freeModels[i];\n      console.log(`Attempting with model: ${model}`);\n      \n      try {\n        const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {\n          method: 'POST',\n          headers: {\n            'Authorization': `Bearer ${process.env.OPENROUTER_API_KEY}`,\n            'HTTP-Referer': process.env.YOUR_SITE_URL || 'http://localhost:5000',\n            'X-Title': 'WikiTruth',\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            model: model,\n            messages: [\n              { role: \"system\", content: systemPrompt },\n              { role: \"user\", content: userPrompt }\n            ],\n            temperature: isFunnyMode ? 0.8 : 0.3,\n            max_tokens: 2000\n          })\n        });\n\n        if (!response.ok) {\n          const errorText = await response.text();\n          console.error(`Model ${model} failed:`, errorText);\n          \n          // If this is the last model, throw the error\n          if (i === this.freeModels.length - 1) {\n            throw new Error(`OpenRouter API error: ${response.status} - ${errorText}`);\n          }\n          \n          // Otherwise, continue to next model\n          continue;\n        }\n\n        const data = await response.json();\n        const result = data.choices[0]?.message?.content;\n        \n        if (result) {\n          console.log(`Successfully used model: ${model}`);\n          return result;\n        }\n        \n        // If no content returned, try next model\n        if (i === this.freeModels.length - 1) {\n          throw new Error('No comparison content generated from any model');\n        }\n        \n      } catch (error) {\n        console.error(`Model ${model} error:`, error);\n        \n        // If this is the last model, throw the error\n        if (i === this.freeModels.length - 1) {\n          throw new Error(`OpenRouter comparison failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n        }\n        \n        // Otherwise, continue to next model\n        continue;\n      }\n    }\n    \n    // This should never be reached, but just in case\n    throw new Error('All OpenRouter models failed to generate comparison');\n  }\n\n  private truncateArticle(content: string, maxChars: number = 15000): string {\n    if (content.length <= maxChars) {\n      return content;\n    }\n\n    // Take first portion (intro/overview) and last portion (conclusion/recent info)\n    const frontChars = Math.floor(maxChars * 0.7);\n    const backChars = Math.floor(maxChars * 0.3);\n    \n    const frontPart = content.substring(0, frontChars);\n    const backPart = content.substring(content.length - backChars);\n    \n    return `${frontPart}\\n\\n[... CONTENT TRUNCATED FOR SIZE ...]\\n\\n${backPart}`;\n  }\n\n  private buildUserPrompt(articles: Record<string, string>, isFunnyMode: boolean, outputLanguage: string): string {\n    // Truncate articles to fit within token limits\n    const truncatedArticles: Record<string, string> = {};\n    const maxCharsPerArticle = Math.floor(25000 / Object.keys(articles).length); // Distribute available space\n    \n    for (const [lang, content] of Object.entries(articles)) {\n      truncatedArticles[lang] = this.truncateArticle(content, maxCharsPerArticle);\n      console.log(`Truncated ${lang} article: ${content.length} -> ${truncatedArticles[lang].length} characters`);\n    }\n    \n    const articleData = JSON.stringify(truncatedArticles, null, 2);\n    \n    if (isFunnyMode) {\n      return `Please compare these Wikipedia articles and provide insights in a humorous, entertaining way while still being informative. Respond in ${outputLanguage}:\n\n${articleData}\n\nMake the comparison engaging and fun while highlighting the interesting differences between how these different language versions present the topic.`;\n    }\n\n    return `Please compare these Wikipedia articles from different languages and provide a comprehensive analysis highlighting key differences, similarities, and cultural perspectives. Respond in ${outputLanguage}:\n\n${articleData}\n\nFocus on:\n1. Content differences (facts, emphasis, details included/excluded)\n2. Cultural perspectives and biases\n3. Historical context variations\n4. Notable differences in how the topic is presented\n5. Any unique insights from each language version\n\nProvide a thorough, balanced analysis that helps readers understand how the same topic can be presented differently across cultures and languages.`;\n  }\n\n  private getStandardSystemPrompt(outputLanguage: string): string {\n    return `You are a Wikipedia comparison expert. Your task is to analyze Wikipedia articles from different languages about the same topic and provide insightful comparisons.\n\nKey guidelines:\n- Respond ONLY in ${outputLanguage}, never mix languages\n- Focus on factual differences, not language quality\n- Highlight cultural perspectives and regional emphasis\n- Note any unique information found in specific language versions\n- Be objective and balanced in your analysis\n- Structure your response clearly with headers and bullet points\n- Aim for comprehensive yet concise analysis\n\nYour goal is to help users understand how different cultures and regions present the same topic through their Wikipedia articles.`;\n  }\n\n  private getFunnyModeSystemPrompt(outputLanguage: string): string {\n    return `You are a witty Wikipedia comparison expert with a great sense of humor. Your task is to analyze Wikipedia articles from different languages and provide entertaining yet informative comparisons.\n\nKey guidelines:\n- Respond ONLY in ${outputLanguage}, never mix languages\n- Make it funny and engaging while being factually accurate\n- Use humor to highlight interesting differences between articles\n- Point out amusing cultural quirks or biases with wit\n- Include clever observations and light-hearted commentary\n- Structure with entertaining headers and amusing bullet points\n- Keep it informative despite the humorous tone\n\nYour goal is to make Wikipedia comparison fun and memorable while genuinely helping users understand cultural differences in how topics are presented.`;\n  }\n}\n\nexport const openRouterService = new OpenRouterService();","path":null,"size_bytes":7495,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/privacy-policy-dialog.tsx":{"content":"import { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { ScrollArea } from '@/components/ui/scroll-area';\n\ninterface PrivacyPolicyDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onAccept: () => void;\n}\n\nexport function PrivacyPolicyDialog({ isOpen, onClose, onAccept }: PrivacyPolicyDialogProps) {\n  const [hasAcceptedPrivacy, setHasAcceptedPrivacy] = useState(false);\n  const [hasAcceptedTerms, setHasAcceptedTerms] = useState(false);\n\n  const handleAccept = () => {\n    if (hasAcceptedPrivacy && hasAcceptedTerms) {\n      onAccept();\n      onClose();\n    }\n  };\n\n  const isAcceptEnabled = hasAcceptedPrivacy && hasAcceptedTerms;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[80vh]\">\n        <DialogHeader>\n          <DialogTitle className=\"text-xl font-bold text-blue-800\">\n            Privacy Policy & Terms of Service\n          </DialogTitle>\n        </DialogHeader>\n        \n        <ScrollArea className=\"h-96 pr-4\">\n          <div className=\"space-y-6 text-sm leading-relaxed\">\n            \n            {/* Privacy Policy Section */}\n            <div>\n              <h3 className=\"text-lg font-semibold text-blue-800 mb-3\">Privacy Policy</h3>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Local Data Storage</h4>\n                  <p className=\"text-gray-700\">\n                    <strong>All your data is stored locally in your browser only.</strong> We do not collect, store, \n                    or transmit any personal information to our servers. Your search history, comparison results, \n                    and subscription status are saved exclusively in your browser's local storage (IndexedDB).\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Data Control</h4>\n                  <p className=\"text-gray-700\">\n                    You have complete control over your data. You can export all your data or permanently \n                    delete it at any time through the Settings menu. Clearing your browser data will \n                    permanently remove all stored information.\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Third-Party Services</h4>\n                  <p className=\"text-gray-700\">\n                    We use external APIs (Wikipedia, OpenAI, OpenRouter) to provide our services. \n                    Article content is sent to these services for analysis but is not stored by us. \n                    Please review their respective privacy policies.\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Data Loss Risks</h4>\n                  <p className=\"text-gray-700 bg-yellow-50 p-3 rounded border-l-4 border-yellow-400\">\n                    <strong>Important:</strong> Since all data is stored locally, you may lose your subscription \n                    status and comparison history if you:\n                    <ul className=\"list-disc ml-4 mt-2\">\n                      <li>Clear your browser data/cookies</li>\n                      <li>Use private/incognito browsing</li>\n                      <li>Switch to a different browser or device</li>\n                      <li>Experience browser issues or computer problems</li>\n                    </ul>\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Terms of Service Section */}\n            <div>\n              <h3 className=\"text-lg font-semibold text-blue-800 mb-3\">Terms of Service</h3>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Subscription Terms</h4>\n                  <p className=\"text-gray-700\">\n                    Premium subscriptions are processed through NowPayments secure payment system. \n                    Subscription status is validated locally in your browser for 30 days. \n                    No automatic renewals - you maintain control over your subscription.\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Service Availability</h4>\n                  <p className=\"text-gray-700\">\n                    Our service depends on external APIs (Wikipedia, AI services) which may \n                    experience downtime or rate limiting. We cannot guarantee 100% service availability.\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Content Accuracy</h4>\n                  <p className=\"text-gray-700\">\n                    AI-generated comparisons are for informational purposes only. We do not guarantee \n                    the accuracy of comparisons and recommend verifying important information from \n                    original sources.\n                  </p>\n                </div>\n\n                <div>\n                  <h4 className=\"font-semibold mb-2\">Acceptable Use</h4>\n                  <p className=\"text-gray-700\">\n                    Use our service responsibly and in compliance with Wikipedia's terms of service \n                    and applicable laws. Do not use the service for harmful, illegal, or abusive purposes.\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </ScrollArea>\n\n        {/* Agreement Checkboxes */}\n        <div className=\"space-y-3 border-t pt-4\">\n          <div className=\"flex items-start space-x-3\">\n            <Checkbox \n              id=\"privacy-agreement\"\n              checked={hasAcceptedPrivacy}\n              onCheckedChange={(checked) => setHasAcceptedPrivacy(checked as boolean)}\n            />\n            <label htmlFor=\"privacy-agreement\" className=\"text-sm leading-relaxed cursor-pointer\">\n              I understand that all my data is stored locally in my browser and I accept the \n              risks of potential data loss as outlined in the Privacy Policy.\n            </label>\n          </div>\n          \n          <div className=\"flex items-start space-x-3\">\n            <Checkbox \n              id=\"terms-agreement\"\n              checked={hasAcceptedTerms}\n              onCheckedChange={(checked) => setHasAcceptedTerms(checked as boolean)}\n            />\n            <label htmlFor=\"terms-agreement\" className=\"text-sm leading-relaxed cursor-pointer\">\n              I agree to the Terms of Service and understand the limitations of the service.\n            </label>\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        <div className=\"flex justify-end space-x-3 border-t pt-4\">\n          <Button variant=\"outline\" onClick={onClose}>\n            Cancel\n          </Button>\n          <Button \n            onClick={handleAccept}\n            disabled={!isAcceptEnabled}\n            className=\"wiki-button-primary\"\n          >\n            Accept & Continue to Payment\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":7355,"size_tokens":null},"README.md":{"content":"# WikiTruth Platform\r\n\r\nA **collaborative web tool** that lets you instantly compare the same Wikipedia article across multiple language editions and GPT models, highlight discrepancies, and export well‑structured reports.\r\n\r\n---\r\n\r\n## ✨ Key Features\r\n\r\n| Category                  | Highlights                                                                                       |\r\n| ------------------------- | ------------------------------------------------------------------------------------------------ |\r\n| **Multi-language diff**   | Side‑by‑side view of the source article and its translations with AI explanations of divergences |\r\n| **AI‑powered comparison** | Uses both OpenAI Chat and OpenRouter models for robust fact‑checking and style analysis          |\r\n| **One‑click export**      | Generate DOCX or shareable links suitable for journalists, students, and researchers             |\r\n| **Privacy‑first**         | No user tracking; all sessions stored in ephemeral Keyv storage                                  |\r\n| **Open architecture**     | Express + Node backend with clear API boundaries and pluggable services                          |\r\n\r\n---\r\n\r\n## 📐 System Architecture\r\n\r\nBelow is an updated, **layer‑centric Mermaid diagram** reflecting the current client‑server flow, page navigation, and subscription logic.\r\n\r\n**Legend**\r\n\r\n* **White nodes** — core SPA pages / UX states\r\n* **Blue nodes** — application layers (Frontend & Backend)\r\n* **Yellow nodes** — external APIs and payment gateway integrations\r\n\r\n```mermaid\r\n---\r\nconfig:\r\n  layout: fixed\r\n---\r\nflowchart TD\r\n subgraph CLIENT[\"Frontend (React 18 + Vite)\"]\r\n    direction TB\r\n        UI[\"UI Components (Tailwind / shadcn/ui)\"]\r\n        i18n[\"i18next (20 UI languages)\"]\r\n        idb[\"IndexedDB (idb-wrapper)\"]\r\n        router[\"React Router Dom\"]\r\n  end\r\n subgraph SERVER[\"Backend (Express.js REST Layer)\"]\r\n    direction TB\r\n        proxyWiki[\"Wikipedia Proxy (retry + error handling)\"]\r\n        proxyLLM[\"LLM Proxy (OpenRouter / OpenAI)\"]\r\n        checkout[\"Smart Glocal (Checkout Handoff)\"]\r\n  end\r\n subgraph EXTERNAL[\"External APIs & Services\"]\r\n    direction TB\r\n        wikipedia[\"(Wikipedia REST API)\"]\r\n        openrouter[\"(OpenRouter LLM)\"]\r\n        openai[\"(OpenAI API)\"]\r\n        smartGlocal[\"Smart Glocal (Payment Gateway)\"]\r\n  end\r\n subgraph PAGES[\"Core User Screens\"]\r\n    direction TB\r\n        main[\"Main Page (Search & Lang Selector)\"]\r\n        langPick[\"Article-Language (Selection)\"]\r\n        advSettings[\"Advanced Settings (Premium)\"]\r\n        genComp[\"Generate Comparison\"]\r\n        result[\"Result Page (Comparison + Share)\"]\r\n        history[\"History (Local)\"]\r\n        info[\"Informational Pages (About | Help | Privacy…)\"]\r\n        settings[\"Settings (Export / Erase Data)\"]\r\n  end\r\n    main -- type query --> langPick\r\n    langPick -- \"pick 2-5 langs\" --> genComp\r\n    langPick -- Premium user --> advSettings\r\n    advSettings -- confirm --> genComp\r\n    genComp -- success --> result\r\n    genComp -- quota hit / error --> upgrade[\"Upgrade Modal\"]\r\n    result -- \"re-run / delete\" --> history\r\n    result -- share --> shareAction[\"OS / Web Share\"]\r\n    main -- hamburger menu --> info\r\n    main -- settings icon --> settings\r\n    freePlan[\"Free Plan (2 comparisons/24 h)\"] -- click Unlock Premium --> checkout\r\n    checkout -- success --> premiumPlan[\"Premium Plan (Unlimited)\"]\r\n    premiumPlan -- render crown --> crown[\"Crown Badge (Premium)\"]\r\n    UI -- calls --> proxyWiki & proxyLLM\r\n    UI -- checkout --> checkout\r\n    proxyWiki --> wikipedia\r\n    proxyLLM -- ≤2/day --> openrouter\r\n    proxyLLM -- unlimited --> openai\r\n    checkout --> smartGlocal\r\n    uuid[\"Generate UUID (on first visit)\"] --> idb\r\n    history --> idb\r\n    settings -- export / erase --> idb\r\n     wikipedia:::ext\r\n     openrouter:::ext\r\n     openai:::ext\r\n     smartGlocal:::ext\r\n     main:::page\r\n     langPick:::page\r\n     advSettings:::page\r\n     genComp:::page\r\n     result:::page\r\n     history:::page\r\n     info:::page\r\n     settings:::page\r\n    classDef layer fill:#f0f5ff,stroke:#3b82f6,stroke-width:2px\r\n    classDef page fill:#ffffff,stroke:#60a5fa,stroke-dasharray:4 2\r\n    classDef ext fill:#fff1c1,stroke:#f59e0b,stroke-width:2px\r\n```\r\n\r\n---\r\n\r\n## 🚀 Getting Started\r\n\r\n1. **Clone** the repository\r\n2. `pnpm i` — install dependencies\r\n3. `pnpm dev` — start Vite dev server and backend concurrently\r\n4. Open [http://localhost:5173](http://localhost:5173) in your browser\r\n\r\n> ℹ️  Add an `OPENAI_API_KEY` and `OPENROUTER_API_KEY` to `.env.local` for full functionality.\r\n\r\n---\r\n\r\n## 🗂️ Project Structure\r\n\r\n```\r\napps/\r\n  web/          # React/Vite frontend\r\n  api/          # Express backend\r\npackages/\r\n  wikipedia/    # Wikipedia fetch wrapper\r\n  compare/      # GPT comparison logic\r\n  ui/           # Tailwind + shadcn/ui components\r\n```\r\n\r\n---\r\n\r\n## 🤝 Contributing\r\n\r\nPRs welcome! Please open an issue first to discuss your idea.\r\n\r\n---\r\n\r\n## 📄 License\r\n\r\nMIT © 2025 WikiTruth team\r\n","path":null,"size_bytes":5043,"size_tokens":null},"client/src/components/footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { SuggestImprovement } from \"./suggest-improvement\";\n\nexport function Footer() {\n  return (\n    <footer className=\"border-t border-border bg-muted/50 mt-12\">\n      <div className=\"max-w-6xl mx-auto px-4 py-8\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          <div>\n            <h3 className=\"font-bold text-lg mb-4 text-foreground\">Wiki Truth</h3>\n            <p className=\"text-sm text-muted-foreground mb-4\">\n              Privacy-first Wikipedia comparison platform\n            </p>\n            <SuggestImprovement />\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-3 text-foreground\">About</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"/how-it-works\" className=\"text-muted-foreground hover:text-foreground transition-colors\">How it works</Link></li>\n              <li><Link href=\"/privacy\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Privacy policy</Link></li>\n              <li><Link href=\"/terms-of-service\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Terms of service</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-3 text-foreground\">Support</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><Link href=\"/help\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Help center</Link></li>\n              <li><Link href=\"/contact-us\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Contact us</Link></li>\n              <li><Link href=\"/report-issues\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Report issues</Link></li>\n            </ul>\n          </div>\n          <div>\n            <h4 className=\"font-semibold mb-3 text-foreground\">Technology</h4>\n            <ul className=\"space-y-2 text-sm\">\n              <li><a href=\"https://www.mediawiki.org/wiki/API:Main_page\" className=\"text-muted-foreground hover:text-foreground transition-colors\" target=\"_blank\" rel=\"noopener noreferrer\">Wikipedia API</a></li>\n              <li><a href=\"https://openai.com/\" className=\"text-muted-foreground hover:text-foreground transition-colors\" target=\"_blank\" rel=\"noopener noreferrer\">OpenAI GPT-4</a></li>\n              <li><a href=\"#\" className=\"text-muted-foreground hover:text-foreground transition-colors\">Open source</a></li>\n            </ul>\n          </div>\n        </div>\n        <div className=\"border-t border-border mt-8 pt-6 text-center\">\n          <p className=\"text-sm text-muted-foreground\">\n            © 2025 Wiki Truth. This site is not affiliated with the Wikimedia Foundation.\n          </p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","path":null,"size_bytes":2802,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/pages/about.tsx":{"content":"import { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function AboutPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <main className=\"container mx-auto max-w-7xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        <h1 className=\"wiki-article-title\">About Wiki Truth</h1>\n        <p className=\"text-wiki-gray mb-6\">\n          Discover cultural perspectives and narrative differences across Wikipedia's language versions.\n        </p>\n\n        <div className=\"space-y-8\">\n          {/* Mission */}\n          <section>\n            <h2 className=\"wiki-section-title\">Our Mission</h2>\n            <div className=\"prose max-w-none\">\n              <p className=\"text-gray-700 leading-relaxed mb-4\">\n                Wiki Truth reveals how the same topic can be presented differently across Wikipedia's various language versions. \n                By comparing articles side-by-side with AI-powered analysis, we uncover cultural biases, narrative variations, \n                and factual differences that reflect diverse global perspectives.\n              </p>\n              <p className=\"text-gray-700 leading-relaxed\">\n                Our platform serves researchers, students, journalists, and curious minds who want to understand how culture \n                influences the presentation of information and discover the rich diversity of human knowledge.\n              </p>\n            </div>\n          </section>\n\n          {/* Features */}\n          <section>\n            <h2 className=\"wiki-section-title\">Key Features</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"bg-blue-50 border border-blue-200 rounded p-6\">\n                <h3 className=\"font-semibold text-blue-900 mb-3\">\n                  <i className=\"fas fa-brain mr-2\"></i>AI-Powered Analysis\n                </h3>\n                <p className=\"text-sm text-blue-800\">\n                  Advanced language models analyze content differences, cultural perspectives, and narrative variations \n                  across Wikipedia articles in different languages.\n                </p>\n              </div>\n\n              <div className=\"bg-green-50 border border-green-200 rounded p-6\">\n                <h3 className=\"font-semibold text-green-900 mb-3\">\n                  <i className=\"fas fa-shield-alt mr-2\"></i>Privacy First\n                </h3>\n                <p className=\"text-sm text-green-800\">\n                  All data stored locally in your browser. No accounts, no tracking, no server-side data storage. \n                  You maintain complete control over your information.\n                </p>\n              </div>\n\n              <div className=\"bg-purple-50 border border-purple-200 rounded p-6\">\n                <h3 className=\"font-semibold text-purple-900 mb-3\">\n                  <i className=\"fas fa-globe mr-2\"></i>35+ Languages\n                </h3>\n                <p className=\"text-sm text-purple-800\">\n                  Compare articles across major world languages including English, Spanish, French, German, \n                  Russian, Chinese, Arabic, Japanese, and many more.\n                </p>\n              </div>\n\n\n            </div>\n          </section>\n\n          {/* How It Works */}\n          <section>\n            <h2 className=\"wiki-section-title\">How It Works</h2>\n            <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n                <div className=\"text-center\">\n                  <div className=\"bg-wiki-blue text-white rounded-full w-12 h-12 flex items-center justify-center text-xl font-bold mx-auto mb-3\">1</div>\n                  <h3 className=\"font-semibold mb-2\">Search</h3>\n                  <p className=\"text-sm text-gray-600\">Find any Wikipedia article in your preferred language</p>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"bg-wiki-blue text-white rounded-full w-12 h-12 flex items-center justify-center text-xl font-bold mx-auto mb-3\">2</div>\n                  <h3 className=\"font-semibold mb-2\">Select</h3>\n                  <p className=\"text-sm text-gray-600\">Choose 2-5 language versions to compare</p>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"bg-wiki-blue text-white rounded-full w-12 h-12 flex items-center justify-center text-xl font-bold mx-auto mb-3\">3</div>\n                  <h3 className=\"font-semibold mb-2\">Analyze</h3>\n                  <p className=\"text-sm text-gray-600\">AI processes articles and identifies differences</p>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"bg-wiki-blue text-white rounded-full w-12 h-12 flex items-center justify-center text-xl font-bold mx-auto mb-3\">4</div>\n                  <h3 className=\"font-semibold mb-2\">Discover</h3>\n                  <p className=\"text-sm text-gray-600\">Review cultural insights and perspective differences</p>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          {/* Technology */}\n          <section>\n            <h2 className=\"wiki-section-title\">Technology</h2>\n            <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Open Source & Transparent</h3>\n                  <p className=\"text-sm text-gray-700 mb-3\">\n                    Wiki Truth is built with modern web technologies and open-source principles:\n                  </p>\n                  <ul className=\"text-sm text-gray-600 space-y-1\">\n                    <li>• React & TypeScript frontend</li>\n                    <li>• Privacy-first architecture</li>\n                    <li>• Direct Wikipedia API integration</li>\n                    <li>• Meta Llama AI models via OpenRouter</li>\n                    <li>• Local browser storage (IndexedDB)</li>\n                  </ul>\n                </div>\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Privacy & Security</h3>\n                  <p className=\"text-sm text-gray-700 mb-3\">\n                    Your privacy is our top priority:\n                  </p>\n                  <ul className=\"text-sm text-gray-600 space-y-1\">\n                    <li>• No user accounts or registration</li>\n                    <li>• No server-side data storage</li>\n                    <li>• No tracking or analytics</li>\n                    <li>• GDPR compliant by design</li>\n                    <li>• Complete data portability</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          {/* Use Cases */}\n          <section>\n            <h2 className=\"wiki-section-title\">Perfect For</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <div className=\"wiki-sidebar\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fas fa-graduation-cap mr-2 text-wiki-blue\"></i>Researchers & Students\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Understand cultural biases in information presentation and discover diverse perspectives on academic topics.\n                </p>\n              </div>\n              <div className=\"wiki-sidebar\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fas fa-newspaper mr-2 text-wiki-blue\"></i>Journalists & Writers\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Uncover different cultural framings of current events and historical narratives for richer storytelling.\n                </p>\n              </div>\n              <div className=\"wiki-sidebar\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fas fa-globe-americas mr-2 text-wiki-blue\"></i>Cultural Enthusiasts\n                </h3>\n                <p className=\"text-sm text-gray-600\">\n                  Explore how different cultures perceive and present the same topics, from history to science to politics.\n                </p>\n              </div>\n            </div>\n          </section>\n\n          {/* Call to Action */}\n          <section>\n            <div className=\"bg-wiki-blue text-white rounded p-8 text-center\">\n              <h2 className=\"text-2xl font-bold mb-4\">Start Exploring Cultural Perspectives</h2>\n              <p className=\"mb-6 opacity-90\">\n                Discover how the same topic is presented differently across Wikipedia's global community.\n              </p>\n              <Button \n                onClick={() => setLocation('/search')}\n                className=\"bg-white text-wiki-blue hover:bg-gray-100 font-semibold px-8 py-3\"\n              >\n                <i className=\"fas fa-search mr-2\"></i>\n                Begin Your First Comparison\n              </Button>\n            </div>\n          </section>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":9255,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/pages/how-it-works.tsx":{"content":"import { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function HowItWorksPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <main className=\"container mx-auto max-w-7xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">How Wiki Truth Works</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n          Learn about the technology and methodology behind cross-cultural Wikipedia analysis.\n        </p>\n\n        <div className=\"space-y-8\">\n          {/* Process Overview */}\n          <section>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">The Analysis Process</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n              <div className=\"text-center\">\n                <div className=\"bg-blue-100 dark:bg-blue-900/30 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4\">\n                  <i className=\"fas fa-search text-2xl text-blue-600 dark:text-blue-400\"></i>\n                </div>\n                <h3 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">1. Article Discovery</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Search Wikipedia's vast database using real-time API integration. Get suggestions as you type.\n                </p>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"bg-green-100 dark:bg-green-900/30 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4\">\n                  <i className=\"fas fa-language text-2xl text-green-600 dark:text-green-400\"></i>\n                </div>\n                <h3 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">2. Language Detection</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Automatically discover all available language versions using Wikipedia's language links system.\n                </p>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"bg-purple-100 dark:bg-purple-900/30 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4\">\n                  <i className=\"fas fa-download text-2xl text-purple-600 dark:text-purple-400\"></i>\n                </div>\n                <h3 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">3. Content Retrieval</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Fetch full article content from multiple Wikipedia language editions simultaneously.\n                </p>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"bg-orange-100 dark:bg-orange-900/30 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4\">\n                  <i className=\"fas fa-brain text-2xl text-orange-600 dark:text-orange-400\"></i>\n                </div>\n                <h3 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">4. AI Analysis</h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Advanced language models compare content and identify cultural perspectives and differences.\n                </p>\n              </div>\n            </div>\n          </section>\n\n          {/* Technical Architecture */}\n          <section>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">Technical Architecture</h2>\n            <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-6\">\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                <div>\n                  <h3 className=\"font-semibold mb-4 text-gray-900 dark:text-white\">\n                    <i className=\"fas fa-cogs mr-2 text-blue-600 dark:text-blue-400\"></i>Frontend Technology\n                  </h3>\n                  <ul className=\"space-y-2 text-sm text-gray-700 dark:text-gray-300\">\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>React 18:</strong> Modern component-based user interface</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>TypeScript:</strong> Type-safe development for reliability</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>IndexedDB:</strong> Local browser storage for privacy</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>TanStack Query:</strong> Efficient data fetching and caching</span>\n                    </li>\n                  </ul>\n                </div>\n                <div>\n                  <h3 className=\"font-semibold mb-4 text-gray-900 dark:text-white\">\n                    <i className=\"fas fa-server mr-2 text-blue-600 dark:text-blue-400\"></i>Backend Services\n                  </h3>\n                  <ul className=\"space-y-2 text-sm text-gray-700 dark:text-gray-300\">\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>Wikipedia API:</strong> Direct real-time article access</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>OpenRouter.ai:</strong> Meta Llama 3.1 AI models</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>Express.js:</strong> Lightweight API server</span>\n                    </li>\n                    <li className=\"flex items-start gap-2\">\n                      <i className=\"fas fa-chevron-right text-xs text-blue-600 dark:text-blue-400 mt-1\"></i>\n                      <span><strong>CORS Proxy:</strong> Cross-origin Wikipedia access</span>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          {/* AI Analysis Methodology */}\n          <section>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">AI Analysis Methodology</h2>\n            <div className=\"space-y-6\">\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded p-6\">\n                <h3 className=\"font-semibold text-blue-900 dark:text-blue-300 mb-3\">\n                  <i className=\"fas fa-microscope mr-2\"></i>Academic Analysis Mode\n                </h3>\n                <p className=\"text-sm text-blue-800 dark:text-blue-400 mb-3\">\n                  Scholarly approach focusing on objective comparison and research-grade insights:\n                </p>\n                <ul className=\"text-sm text-blue-700 dark:text-blue-400 space-y-1\">\n                  <li>• Factual differences and information variations</li>\n                  <li>• Cultural perspectives and regional viewpoints</li>\n                  <li>• Narrative emphasis and editorial choices</li>\n                  <li>• Structural and organizational differences</li>\n                  <li>• Source material and citation patterns</li>\n                </ul>\n              </div>\n\n              <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded p-6\">\n                <h3 className=\"font-semibold text-green-900 dark:text-green-300 mb-3\">\n                  <i className=\"fas fa-smile mr-2\"></i>Fun Mode Analysis\n                </h3>\n                <p className=\"text-sm text-green-800 dark:text-green-400 mb-3\">\n                  Entertaining approach that highlights cultural quirks while remaining informative:\n                </p>\n                <ul className=\"text-sm text-green-700 dark:text-green-400 space-y-1\">\n                  <li>• Humorous cultural biases and stereotypes</li>\n                  <li>• Absurd differences in cultural priorities</li>\n                  <li>• Witty observations about narrative framing</li>\n                  <li>• Pop culture references and engaging commentary</li>\n                  <li>• Entertaining while maintaining accuracy</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Privacy & Security */}\n          <section>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">Privacy & Security</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-6\">\n                <h3 className=\"font-semibold mb-3 text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-shield-alt mr-2 text-green-600 dark:text-green-400\"></i>Data Protection\n                </h3>\n                <ul className=\"text-sm space-y-2 text-gray-700 dark:text-gray-300\">\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-green-600 dark:text-green-400 mt-1\"></i>\n                    <span>No user accounts or registration required</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-green-600 dark:text-green-400 mt-1\"></i>\n                    <span>All data stored locally in your browser</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-green-600 dark:text-green-400 mt-1\"></i>\n                    <span>No server-side data storage or tracking</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-green-600 dark:text-green-400 mt-1\"></i>\n                    <span>GDPR compliant by design</span>\n                  </li>\n                </ul>\n              </div>\n              <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-6\">\n                <h3 className=\"font-semibold mb-3 text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-user-secret mr-2 text-blue-600 dark:text-blue-400\"></i>Privacy Features\n                </h3>\n                <ul className=\"text-sm space-y-2 text-gray-700 dark:text-gray-300\">\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-blue-600 dark:text-blue-400 mt-1\"></i>\n                    <span>Complete data portability and export</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-blue-600 dark:text-blue-400 mt-1\"></i>\n                    <span>One-click data deletion</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-blue-600 dark:text-blue-400 mt-1\"></i>\n                    <span>No analytics or tracking scripts</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <i className=\"fas fa-check text-blue-600 dark:text-blue-400 mt-1\"></i>\n                    <span>Open-source and transparent</span>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Content Handling */}\n          <section>\n            <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">Content Processing</h2>\n            <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded p-6\">\n              <h3 className=\"font-semibold text-yellow-900 dark:text-yellow-300 mb-3\">\n                <i className=\"fas fa-compress-alt mr-2\"></i>Large Article Handling\n              </h3>\n              <p className=\"text-sm text-yellow-800 dark:text-yellow-400 mb-3\">\n                When Wikipedia articles exceed AI processing limits, we use intelligent truncation:\n              </p>\n              <ul className=\"text-sm text-yellow-700 dark:text-yellow-400 space-y-1\">\n                <li>• Preserve article introductions (overview and key facts)</li>\n                <li>• Maintain conclusions and recent information</li>\n                <li>• Clearly mark truncated sections with \"[CONTENT TRUNCATED FOR SIZE]\"</li>\n                <li>• Distribute available space equally among selected languages</li>\n                <li>• Ensure meaningful analysis despite size constraints</li>\n              </ul>\n            </div>\n          </section>\n\n          {/* Call to Action */}\n          <section>\n            <div className=\"text-center bg-blue-600 dark:bg-blue-700 text-white rounded p-8\">\n              <h2 className=\"text-2xl font-bold mb-4\">Ready to Explore?</h2>\n              <p className=\"mb-6 opacity-90\">\n                Now that you understand how Wiki Truth works, start discovering cultural perspectives!\n              </p>\n              <div className=\"flex justify-center gap-4\">\n                <Button \n                  onClick={() => setLocation('/search')}\n                  className=\"bg-white text-blue-600 hover:bg-gray-100 font-semibold px-6 py-3\"\n                >\n                  <i className=\"fas fa-search mr-2\"></i>\n                  Start Comparing\n                </Button>\n                <Button \n                  onClick={() => setLocation('/help')}\n                  className=\"bg-transparent border-2 border-white text-white hover:bg-white hover:text-blue-600 font-semibold px-6 py-3\"\n                >\n                  <i className=\"fas fa-question-circle mr-2\"></i>\n                  Get Help\n                </Button>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":14786,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/lib/test-wikipedia.ts":{"content":"// Test function to validate Wikipedia API integration\nexport async function testWikipediaAPI() {\n  try {\n    console.log('Testing Wikipedia API...');\n    \n    // Test 1: Search functionality\n    const searchUrl = 'https://en.wikipedia.org/w/api.php?action=opensearch&search=Berlin&limit=3&namespace=0&format=json&origin=*';\n    const searchResponse = await fetch(searchUrl);\n    console.log('Search test:', searchResponse.ok, await searchResponse.json());\n    \n    // Test 2: Article content\n    const contentUrl = 'https://en.wikipedia.org/w/api.php?action=query&titles=Berlin&prop=extracts&exintro=false&explaintext=true&exsectionformat=plain&format=json&origin=*';\n    const contentResponse = await fetch(contentUrl);\n    const contentData = await contentResponse.json();\n    console.log('Content test:', contentResponse.ok, contentData);\n    \n    // Test 3: Language links\n    const langUrl = 'https://en.wikipedia.org/w/api.php?action=query&titles=Berlin&prop=langlinks&lllimit=5&format=json&origin=*';\n    const langResponse = await fetch(langUrl);\n    const langData = await langResponse.json();\n    console.log('Language links test:', langResponse.ok, langData);\n    \n    return { success: true, message: 'All tests passed' };\n  } catch (error) {\n    console.error('Wikipedia API test failed:', error);\n    return { success: false, error };\n  }\n}","path":null,"size_bytes":1355,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/comparison-chat.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { MessageCircle, Send, Bot, User, Sparkles } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface ChatMessage {\n  id: string;\n  role: 'user' | 'assistant';\n  content: string;\n  timestamp: Date;\n}\n\ninterface ComparisonChatProps {\n  comparisonResult: string;\n  articleTitle: string;\n  selectedLanguages: string[];\n  isVisible: boolean;\n  onToggle: () => void;\n}\n\nexport function ComparisonChat({ \n  comparisonResult, \n  articleTitle, \n  selectedLanguages, \n  isVisible, \n  onToggle \n}: ComparisonChatProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\n  const [input, setInput] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    if (isVisible && messages.length === 0) {\n      // Add initial assistant message\n      const initialMessage: ChatMessage = {\n        id: Date.now().toString(),\n        role: 'assistant',\n        content: `Hello! I've analyzed the comparison of \"${articleTitle}\" across ${selectedLanguages.join(', ')} languages. You can ask me questions about the findings, request clarifications, or explore specific aspects of the differences I found. What would you like to know more about?`,\n        timestamp: new Date()\n      };\n      setMessages([initialMessage]);\n    }\n  }, [isVisible, messages.length, articleTitle, selectedLanguages]);\n\n  useEffect(() => {\n    // Scroll to bottom when new messages are added\n    if (scrollAreaRef.current) {\n      scrollAreaRef.current.scrollTop = scrollAreaRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  const sendMessage = async () => {\n    if (!input.trim() || isLoading) return;\n\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      role: 'user',\n      content: input.trim(),\n      timestamp: new Date()\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInput(\"\");\n    setIsLoading(true);\n\n    try {\n      // Call API to get chat response\n      const response = await fetch('/api/chat-comparison', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          message: userMessage.content,\n          comparisonContext: comparisonResult,\n          articleTitle,\n          selectedLanguages,\n          chatHistory: messages.slice(-5) // Send last 5 messages for context\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to get chat response');\n      }\n\n      const data = await response.json();\n      \n      const assistantMessage: ChatMessage = {\n        id: (Date.now() + 1).toString(),\n        role: 'assistant',\n        content: data.response,\n        timestamp: new Date()\n      };\n\n      setMessages(prev => [...prev, assistantMessage]);\n    } catch (error) {\n      console.error('Chat error:', error);\n      toast({\n        title: \"Chat Error\",\n        description: \"Failed to get response. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  if (!isVisible) {\n    return (\n      <div className=\"fixed bottom-20 left-6 z-50\">\n        <Button\n          onClick={onToggle}\n          className=\"rounded-full w-14 h-14 bg-green-500 hover:bg-green-600 shadow-lg animate-bounce\"\n        >\n          <MessageCircle className=\"h-6 w-6\" />\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fixed bottom-20 left-6 w-[420px] max-w-[calc(100vw-3rem)] h-[550px] max-h-[calc(100vh-6rem)] z-50\">\n      <Card className=\"h-full flex flex-col shadow-xl border-2 bg-white dark:bg-gray-900\">\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <MessageCircle className=\"h-5 w-5\" />\n              <CardTitle className=\"text-lg\">Chat with Analysis</CardTitle>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"secondary\" className=\"text-xs\">\n                <Sparkles className=\"h-3 w-3 mr-1\" />\n                AI\n              </Badge>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={onToggle}\n                className=\"h-8 w-8 p-0\"\n              >\n                ✕\n              </Button>\n            </div>\n          </div>\n          <CardDescription>\n            Ask questions about your comparison findings\n          </CardDescription>\n        </CardHeader>\n        \n        <Separator />\n        \n        <CardContent className=\"flex-1 flex flex-col p-0 overflow-hidden\">\n          <ScrollArea className=\"flex-1 px-4 py-2\" ref={scrollAreaRef}>\n            <div className=\"space-y-3 min-h-0\">\n              {messages.map((message) => (\n                <div\n                  key={message.id}\n                  className={`flex gap-3 ${\n                    message.role === 'user' ? 'justify-end' : 'justify-start'\n                  }`}\n                >\n                  {message.role === 'assistant' && (\n                    <div className=\"w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center flex-shrink-0\">\n                      <Bot className=\"h-4 w-4 text-purple-600\" />\n                    </div>\n                  )}\n                  \n                  <div\n                    className={`max-w-[85%] rounded-lg px-4 py-3 ${\n                      message.role === 'user'\n                        ? 'bg-purple-600 text-white'\n                        : 'bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white border'\n                    }`}\n                  >\n                    <div className=\"text-sm leading-6 whitespace-pre-wrap break-words font-normal\">\n                      {message.content}\n                    </div>\n                    <div className={`text-xs mt-2 ${\n                      message.role === 'user' \n                        ? 'text-purple-200' \n                        : 'text-gray-500 dark:text-gray-400'\n                    }`}>\n                      {message.timestamp.toLocaleTimeString([], { \n                        hour: '2-digit', \n                        minute: '2-digit' \n                      })}\n                    </div>\n                  </div>\n                  \n                  {message.role === 'user' && (\n                    <div className=\"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0\">\n                      <User className=\"h-4 w-4 text-blue-600\" />\n                    </div>\n                  )}\n                </div>\n              ))}\n              \n              {isLoading && (\n                <div className=\"flex gap-3 justify-start\">\n                  <div className=\"w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center flex-shrink-0\">\n                    <Bot className=\"h-4 w-4 text-purple-600\" />\n                  </div>\n                  <div className=\"bg-gray-100 dark:bg-gray-800 rounded-lg px-3 py-2\">\n                    <div className=\"flex space-x-1\">\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.1s'}}></div>\n                      <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.2s'}}></div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </ScrollArea>\n          \n          <Separator />\n          \n          <div className=\"p-4\">\n            <div className=\"flex gap-2\">\n              <Input\n                placeholder=\"Ask about the comparison...\"\n                value={input}\n                onChange={(e) => setInput(e.target.value)}\n                onKeyPress={handleKeyPress}\n                disabled={isLoading}\n                className=\"flex-1\"\n              />\n              <Button \n                onClick={sendMessage} \n                disabled={!input.trim() || isLoading}\n                size=\"sm\"\n              >\n                <Send className=\"h-4 w-4\" />\n              </Button>\n            </div>\n            <p className=\"text-xs text-gray-500 mt-2\">\n              Press Enter to send • Powered by free AI model\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","path":null,"size_bytes":9096,"size_tokens":null},"replit.md":{"content":"# Wiki Truth - Privacy-First Wikipedia Comparison Platform\n\n## Overview\nWiki Truth is a freemium web application designed to allow users to compare Wikipedia articles across multiple languages using artificial intelligence. The platform offers a free tier utilizing Meta Llama AI analysis and a premium tier ($10/month) with OpenAI GPT-4o analysis and enhanced features. Emphasizing privacy, all user data is stored locally in the browser. The core purpose is to reveal how topics are presented differently across various linguistic and cultural contexts.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n### Subscription Flow Preferences\n- Free users should not see which AI model is being used (hide technical details)\n- Don't interrupt users with plan selection during comparison workflow\n- Auto-start comparisons with user's current plan (free or premium)\n- Provide optional upgrade button that doesn't disrupt user experience\n- Use demo payment links for Smart Glocal integration testing\n\n## System Architecture\n\n### UI/UX Decisions\n- **Design System**: Wikipedia-inspired design system with Tailwind CSS.\n- **Component Library**: Radix UI primitives with shadcn/ui components.\n- **Responsiveness**: Mobile-first approach with grid-based layouts.\n- **Accessibility**: ARIA labels, keyboard navigation, screen reader support.\n- **Notifications**: Toast notifications for user feedback.\n- **Loading States**: Skeleton loading and progress indicators.\n- **Premium Indicators**: Green premium badges and crown icons for visual premium status.\n- **Social Sharing**: Round circular buttons with platform labels and unique designs.\n- **Dark Mode**: Toggle between light and dark themes with localStorage persistence.\n- **Donation Banner**: Wikipedia-style carousel banner with Ko-Fi donation link (no branding visible).\n- **Suggest Improvement**: Footer button linking to email form (worldtruthfoundation@gmail.com).\n\n### Technical Implementations\n- **Frontend**: React 18 with TypeScript, Wouter for routing, TanStack Query for server state, Vite as build tool.\n- **Backend**: Node.js with Express.js for static file serving only (minimal server).\n- **Data Storage**: IndexedDB for structured data, localStorage for UUID-based accounts and subscription tracking. All data is client-side; no server-side data storage or tracking.\n- **AI Comparison Engine**: Integrates with OpenRouter.ai (Meta Llama 3.1 8B Instruct for free tier) and OpenAI (GPT-4o for premium tier). Supports academic and \"funny\" comparison modes.\n- **Search and Discovery**: Direct API integration with Wikipedia's OpenSearch and LangLinks APIs for real-time, debounced search with autocomplete and multi-language support (35+ languages). Filters out disambiguation pages and low-content articles.\n- **Export and Sharing**: DOCX generation for comparison reports and URL-based sharing of results.\n- **Subscription Management**: Browser-based premium subscription with 30-day validation, integrated with NowPayments.\n\n### Feature Specifications\n- **Freemium Model**: Free (Llama-powered) and Premium (GPT-4o powered) tiers.\n- **Privacy-First**: All user and comparison data stored locally in the browser (IndexedDB, localStorage).\n- **Multi-language Comparison**: Supports comparing articles across 2-5 user-selected languages.\n- **Cultural Analysis**: AI focuses on factual differences, framing variations, and cultural perspectives.\n- **Payment Processing**: NowPayments integration for premium subscriptions.\n- **User Accounts**: UUID-based accounts created and managed locally in the browser.\n\n## External Dependencies\n\n### APIs and Services\n- **Wikipedia API**: For article search, language links, and content retrieval.\n- **OpenRouter.ai API**: For free tier AI comparison and analysis (Meta Llama models).\n- **OpenAI API**: For premium tier AI comparison and analysis (GPT-4o).\n- **NowPayments**: For cryptocurrency payment processing and premium subscription management.\n- **AllOrigins**: A CORS proxy service used for bypassing browser CORS restrictions with Wikipedia.\n\n### Libraries and Frameworks\n- **React**: Frontend framework.\n- **TypeScript**: Programming language.\n- **Tailwind CSS**: Utility-first CSS framework.\n- **Radix UI**: Headless component primitives.\n- **Wouter**: Lightweight client-side routing.\n- **TanStack Query**: Server state management.\n- **idb**: Library for IndexedDB interactions.\n- **docx**: Library for DOCX document generation.\n\n### Development Tools\n- **Vite**: Frontend build tool.\n- **Node.js**: JavaScript runtime environment.\n- **Express.js**: Minimal backend framework for static file serving.\n- **tsx**: For TypeScript execution in development.","path":null,"size_bytes":4690,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/sidebar.tsx":{"content":"import { Link } from \"wouter\";\nimport { PremiumIndicator } from \"./premium-indicator\";\n\nexport function Sidebar() {\n  return (\n    <aside className=\"lg:col-span-1\">\n      <div className=\"wiki-sidebar mb-6\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-bold text-lg\">Navigation</h3>\n          <PremiumIndicator />\n        </div>\n        <ul className=\"space-y-2 text-sm\">\n          <li><Link href=\"/\" className=\"wiki-link\">Main page</Link></li>\n          <li><Link href=\"/search\" className=\"wiki-link\">Search articles</Link></li>\n          <li><Link href=\"/compare\" className=\"wiki-link\">Compare</Link></li>\n        </ul>\n      </div>\n      \n      <div className=\"wiki-sidebar mb-6\">\n        <h3 className=\"font-bold text-lg mb-3\">Tools</h3>\n        <ul className=\"space-y-2 text-sm\">\n          <li><Link href=\"/tools\" className=\"wiki-link\">Random article</Link></li>\n          <li><Link href=\"/recent\" className=\"wiki-link\">Recent comparisons</Link></li>\n        </ul>\n      </div>\n\n      <div className=\"wiki-sidebar\">\n        <h3 className=\"font-bold text-lg mb-3\">Help</h3>\n        <ul className=\"space-y-2 text-sm\">\n          <li><Link href=\"/about\" className=\"wiki-link\">About</Link></li>\n          <li><Link href=\"/how-it-works\" className=\"wiki-link\">How it works</Link></li>\n          <li><Link href=\"/help\" className=\"wiki-link\">Help</Link></li>\n          <li><Link href=\"/privacy\" className=\"wiki-link\">Privacy</Link></li>\n        </ul>\n      </div>\n    </aside>\n  );\n}\n","path":null,"size_bytes":1529,"size_tokens":null},"server/services/openaiChat.ts":{"content":"import OpenAI from 'openai';\n\n// Initialize Grok client (x.ai API) - compatible with OpenAI SDK\nconst grok = process.env.GROK_API_KEY \n  ? new OpenAI({ \n      apiKey: process.env.GROK_API_KEY,\n      baseURL: \"https://api.x.ai/v1\"\n    }) \n  : null;\n\nexport async function chatWithGrok(\n  messages: { role: 'system' | 'user' | 'assistant'; content: string }[],\n  temperature = 0.7,\n  maxTokens = 500,\n  model = 'grok-4-latest'\n) {\n  if (!grok) {\n    throw new Error('Grok API key not configured');\n  }\n\n  const resp = await grok.chat.completions.create({\n    model,\n    messages,\n    temperature,\n    max_tokens: maxTokens,\n  });\n\n  return resp.choices[0].message.content?.trim() || '';\n}","path":null,"size_bytes":686,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nwindow.addEventListener(\"unhandledrejection\", (event) => {\n  const errorMessage = event.reason?.message || \"\";\n  const errorStack = event.reason?.stack || \"\";\n  \n  if (\n    errorMessage.includes(\"MetaMask\") ||\n    errorStack.includes(\"chrome-extension://\") ||\n    errorStack.includes(\"moz-extension://\")\n  ) {\n    event.preventDefault();\n    console.warn(\"Browser extension error suppressed:\", errorMessage);\n  }\n});\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":575,"size_tokens":null},"client/src/lib/openai-client.ts":{"content":"export interface ComparisonRequest {\n  articles: Record<string, string>; // language code -> article content\n  outputLanguage: string;\n  isFunnyMode?: boolean;\n}\n\nclass OpenRouterClient {\n  private baseUrl = '/api/openrouter';\n\n  async compareArticles(request: ComparisonRequest): Promise<string> {\n    try {\n      console.log('Starting comparison with OpenRouter API...');\n\n      // OpenRouter API endpoint - completely free for all users\n      const response = await fetch('/api/openrouter/compare', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(request)\n      });\n\n      console.log('OpenRouter API response status:', response.status);\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('OpenRouter API error response:', errorText);\n        \n        let errorData;\n        try {\n          errorData = JSON.parse(errorText);\n        } catch {\n          errorData = { error: { message: errorText } };\n        }\n        \n        throw new Error(`OpenRouter API error: ${response.status} - ${errorData.error?.message || errorText}`);\n      }\n\n      const data = await response.json();\n      console.log('OpenRouter comparison completed successfully');\n      \n      return data.comparisonResult || 'No comparison generated';\n    } catch (error) {\n      console.error('OpenRouter comparison error:', error);\n      if (error instanceof Error) {\n        throw error;\n      }\n      throw new Error('Failed to generate comparison');\n    }\n  }\n\n  private getStandardSystemPrompt(outputLanguage: string): string {\n    return `You are an expert cultural and linguistic analyst specializing in Wikipedia content comparison. Your task is to analyze and compare Wikipedia articles about the same topic across different languages, focusing on cultural perspectives, factual differences, and narrative variations.\n\nANALYSIS FRAMEWORK:\n1. **Factual Differences**: Identify any differences in dates, numbers, events, or verifiable facts\n2. **Cultural Perspectives**: Highlight how different cultures frame or emphasize aspects of the topic\n3. **Narrative Focus**: Note what each language version prioritizes or emphasizes\n4. **Missing Information**: Point out significant content present in some versions but absent in others\n5. **Bias Detection**: Identify potential cultural, political, or historical biases in presentation\n\nOUTPUT REQUIREMENTS:\n- Respond in ${outputLanguage}\n- Use clear, academic language\n- Organize findings into the 5 categories above\n- Provide specific examples with language references\n- Maintain objectivity while highlighting differences\n- Include a summary of key insights\n\nBe thorough but concise. Focus on meaningful differences that reveal cultural perspectives rather than minor stylistic variations.`;\n  }\n\n  private getFunnyModeSystemPrompt(outputLanguage: string): string {\n    return `You are a witty cultural commentator with a humorous take on how different cultures present the same topics on Wikipedia. Your job is to find the amusing, ironic, or delightfully weird differences between Wikipedia articles in different languages.\n\nCOMEDIC ANALYSIS APPROACH:\n1. **Cultural Quirks**: Find funny ways different cultures emphasize unexpected aspects\n2. **National Pride Moments**: Spot where countries subtly (or not so subtly) make themselves look better\n3. **Lost in Translation**: Highlight amusing differences in how concepts are explained\n4. **Bureaucratic Humor**: Point out overly formal or unnecessarily detailed sections\n5. **The Elephant in the Room**: Note what some versions awkwardly avoid mentioning\n\nOUTPUT STYLE:\n- Respond in ${outputLanguage}\n- Use humor while remaining respectful\n- Include funny observations and light commentary\n- Use analogies and witty comparisons\n- Keep it educational but entertaining\n- Add emoji where appropriate 😄\n\nRemember: We're laughing WITH cultural differences, not AT them. Keep it light, fun, and insightful while avoiding anything mean-spirited or offensive.`;\n  }\n}\n\nexport const openaiClient = new OpenRouterClient();","path":null,"size_bytes":4123,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5742,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/lib/api.ts":{"content":"import { clientStorage } from './storage';\nimport { wikipediaClient, type WikipediaSearchResult, type WikipediaLanguageLink } from './wikipedia-client';\nimport { simpleWikipedia } from './wikipedia-simple';\nimport { openaiClient } from './openai-client';\n\nexport interface SearchResult {\n  title: string;\n  snippet: string;\n  pageid: number;\n}\n\nexport interface LanguageLink {\n  lang: string;\n  title: string;\n  url: string;\n}\n\nexport interface ComparisonRequest {\n  articleTitle: string;\n  selectedLanguages: string[];\n  outputLanguage: string;\n  baseLanguage?: string;\n  isFunnyMode?: boolean;\n  isPremium?: boolean;\n  languageTitles: Record<string, string>; // language -> article title\n  premiumOptions?: {\n    outputFormat: 'bullet-points' | 'narrative';\n    focusPoints: string;\n    formality: 'formal' | 'casual' | 'academic';\n    aiModel: 'free' | 'premium';\n    analysisMode: 'academic' | 'biography' | 'funny';\n  };\n}\n\nexport interface ComparisonResult {\n  id: string;\n  articleTitle: string;\n  selectedLanguages: string[];\n  outputLanguage: string;\n  comparisonResult: string;\n  isFunnyMode: boolean;\n  isPremium: boolean;\n  createdAt: string;\n  articles: Array<{\n    language: string;\n    title: string;\n    content: string;\n    contentLength: number;\n  }>;\n}\n\nexport interface SearchSession {\n  id: string;\n  searchQuery?: string;\n  selectedArticle?: any;\n  availableLanguages?: LanguageLink[];\n  createdAt: string;\n}\n\nexport const api = {\n  async searchArticles(query: string, language: string = 'en', limit: number = 10): Promise<SearchResult[]> {\n    try {\n      // Use server endpoint to avoid CORS issues\n      const response = await fetch(`/api/wikipedia/search?query=${encodeURIComponent(query)}&language=${language}&limit=${limit}`);\n      if (!response.ok) {\n        throw new Error(`Search failed: ${response.status}`);\n      }\n      const results = await response.json();\n      return results.map((result: any) => ({\n        title: result.title,\n        snippet: result.snippet,\n        pageid: result.pageid\n      }));\n    } catch (error) {\n      console.error('Search error:', error);\n      return [];\n    }\n  },\n\n  async getLanguageLinks(title: string, language: string = 'en'): Promise<LanguageLink[]> {\n    try {\n      // Use server endpoint to avoid CORS issues\n      const response = await fetch(`/api/wikipedia/languages?title=${encodeURIComponent(title)}&language=${language}`);\n      if (!response.ok) {\n        throw new Error(`Language links failed: ${response.status}`);\n      }\n      const links = await response.json();\n      return links.map((link: any) => ({\n        lang: link.lang,\n        title: link.title,\n        url: link.url\n      }));\n    } catch (error) {\n      console.error('Language links error:', error);\n      return [];\n    }\n  },\n\n  async createSession(sessionData: Partial<SearchSession> = {}): Promise<SearchSession> {\n    try {\n      return await clientStorage.saveSession(sessionData);\n    } catch (error) {\n      console.error('Create session error:', error);\n      throw error;\n    }\n  },\n\n  async updateSession(sessionId: string, updates: Partial<SearchSession>): Promise<SearchSession> {\n    try {\n      const result = await clientStorage.updateSession(sessionId, updates);\n      if (!result) {\n        throw new Error('Session not found');\n      }\n      return result;\n    } catch (error) {\n      console.error('Update session error:', error);\n      throw error;\n    }\n  },\n\n  async getSession(sessionId: string): Promise<SearchSession> {\n    try {\n      const session = await clientStorage.getSession(sessionId);\n      if (!session) {\n        throw new Error('Session not found');\n      }\n      return session;\n    } catch (error) {\n      console.error('Get session error:', error);\n      throw error;\n    }\n  },\n\n  async compareArticles(comparisonData: ComparisonRequest): Promise<ComparisonResult> {\n    try {\n      console.log('Starting comparison with data:', comparisonData);\n\n      // Check if user can generate (generation limit check)\n      const visitorId = await clientStorage.getVisitorId();\n      const canGenerateResponse = await fetch('/api/user/can-generate', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ visitorId })\n      });\n      \n      if (!canGenerateResponse.ok) {\n        throw new Error('Failed to check generation limit');\n      }\n      \n      const canGenerateResult = await canGenerateResponse.json();\n      if (!canGenerateResult.canGenerate) {\n        const error = new Error('GENERATION_LIMIT_EXCEEDED');\n        (error as any).requiresSubscription = true;\n        (error as any).generationsUsed = canGenerateResult.generationsUsed;\n        (error as any).generationLimit = canGenerateResult.generationLimit;\n        throw error;\n      }\n\n      // Fetch articles using server endpoints to avoid CORS issues\n      const articles = [];\n      console.log('Fetching articles for languages:', comparisonData.languageTitles);\n      \n      for (const [language, title] of Object.entries(comparisonData.languageTitles)) {\n        try {\n          // Use server endpoint to avoid CORS issues\n          const response = await fetch(`/api/wikipedia/article?title=${encodeURIComponent(title)}&language=${language}`);\n          if (!response.ok) {\n            throw new Error(`Article fetch failed: ${response.status}`);\n          }\n          const article = await response.json();\n          articles.push(article);\n          console.log(`✓ Fetched ${language}: ${article.title} (${article.content.length} chars)`);\n        } catch (error) {\n          console.error(`✗ Failed to fetch ${language}: ${title}`, error);\n        }\n      }\n\n      if (articles.length < 1) {\n        throw new Error(`No articles could be fetched. Please verify the article exists and try again.`);\n      }\n      \n      console.log(`Successfully fetched ${articles.length} articles for comparison`);\n\n      // Prepare content for OpenAI\n      const articleContents: Record<string, string> = {};\n      articles.forEach((article: any) => {\n        articleContents[article.language] = article.content;\n      });\n\n      console.log('Sending to AI service for comparison...');\n      console.log('Article content lengths:', Object.entries(articleContents).map(([lang, content]) => `${lang}: ${content.length} chars`));\n      console.log('Premium options being sent:', comparisonData.premiumOptions);\n      \n      // Send to server for AI comparison (routes between OpenRouter/OpenAI based on subscription)\n      let comparisonResult;\n      try {\n        const response = await fetch('/api/compare', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            articleTitle: comparisonData.articleTitle,\n            selectedLanguages: comparisonData.selectedLanguages,\n            outputLanguage: comparisonData.outputLanguage,\n            baseLanguage: comparisonData.baseLanguage || 'en',\n            isFunnyMode: comparisonData.isFunnyMode,\n            isPremium: comparisonData.isPremium,\n            articles: articleContents,\n            premiumOptions: comparisonData.premiumOptions,\n            visitorId // Include for backend-side generation tracking\n          })\n        });\n\n        if (!response.ok) {\n          const errorText = await response.text();\n          throw new Error(`Server error: ${response.status} - ${errorText}`);\n        }\n\n        const result = await response.json();\n        comparisonResult = result.comparisonResult;\n        console.log('AI comparison result length:', comparisonResult.length);\n      } catch (serverError) {\n        console.error('Server comparison failed:', serverError);\n        throw new Error(`AI comparison failed: ${serverError instanceof Error ? serverError.message : 'Unknown error'}`);\n      }\n\n      console.log('OpenAI comparison completed, saving to local storage...');\n\n      // Save comparison to local storage\n      const comparison = await clientStorage.saveComparison({\n        articleTitle: comparisonData.articleTitle,\n        selectedLanguages: comparisonData.selectedLanguages,\n        outputLanguage: comparisonData.outputLanguage,\n        baseLanguage: comparisonData.baseLanguage || comparisonData.selectedLanguages[0],\n        comparisonResult,\n        isFunnyMode: comparisonData.isFunnyMode || false,\n        isPremium: comparisonData.isPremium || false,\n        articles\n      });\n\n      // Record the generation after successful comparison (required before returning)\n      const recordResponse = await fetch('/api/user/record-generation', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ visitorId })\n      });\n      \n      if (!recordResponse.ok) {\n        console.error('Failed to record generation, but comparison succeeded');\n      }\n\n      console.log('Comparison saved successfully:', comparison.id);\n      return comparison;\n    } catch (error) {\n      console.error('Compare articles error:', error);\n      \n      // Re-throw generation limit errors as-is\n      if (error instanceof Error && error.message === 'GENERATION_LIMIT_EXCEEDED') {\n        throw error;\n      }\n      \n      // Provide more specific error information\n      if (error instanceof Error) {\n        if (error.message.includes('API key')) {\n          throw new Error('OpenAI API key issue: ' + error.message + '. Please check your API key in Settings.');\n        } else if (error.message.includes('Wikipedia')) {\n          throw new Error('Wikipedia data error: ' + error.message + '. Please try a different article.');\n        } else {\n          throw new Error('Comparison failed: ' + error.message);\n        }\n      } else {\n        throw new Error('Comparison failed: Unknown error occurred');\n      }\n    }\n  },\n\n  async getComparison(id: string): Promise<ComparisonResult> {\n    try {\n      const comparison = await clientStorage.getComparison(id);\n      if (!comparison) {\n        throw new Error('Comparison not found');\n      }\n      return comparison;\n    } catch (error) {\n      console.error('Get comparison error:', error);\n      throw error;\n    }\n  },\n\n  async getUserComparisons(): Promise<ComparisonResult[]> {\n    try {\n      return await clientStorage.getUserComparisons();\n    } catch (error) {\n      console.error('Get user comparisons error:', error);\n      return [];\n    }\n  },\n\n  async deleteComparison(id: string): Promise<void> {\n    try {\n      await clientStorage.deleteComparison(id);\n    } catch (error) {\n      console.error('Delete comparison error:', error);\n      throw error;\n    }\n  },\n\n  async exportComparison(id: string): Promise<Blob> {\n    try {\n      const localComparison = await clientStorage.getComparison(id);\n      if (!localComparison) {\n        throw new Error('Comparison not found');\n      }\n\n      // Send comparison data directly to export endpoint\n      const response = await fetch('/api/export/docx', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          articleTitle: localComparison.articleTitle,\n          languages: localComparison.selectedLanguages,\n          outputLanguage: localComparison.outputLanguage,\n          content: localComparison.comparisonResult,\n          isFunnyMode: localComparison.isFunnyMode\n        })\n      });\n      \n      if (!response.ok) {\n        throw new Error('Export request failed');\n      }\n\n      return await response.blob();\n    } catch (error) {\n      console.error('Export comparison error:', error);\n      throw error;\n    }\n  },\n\n  async shareComparison(id: string, platform: string): Promise<string> {\n    try {\n      const comparison = await clientStorage.getComparison(id);\n      if (!comparison) {\n        throw new Error('Comparison not found');\n      }\n\n      const baseUrl = window.location.origin;\n      const shareUrl = `${baseUrl}/results/${id}`;\n      \n      // Create full comparison text for clipboard\n      const fullComparisonText = `\nWiki Truth Comparison: \"${comparison.articleTitle}\"\n${comparison.selectedLanguages.map(lang => `• ${lang.toUpperCase()}`).join('\\n')}\nGenerated: ${new Date(comparison.createdAt).toLocaleDateString()}\n\n${comparison.comparisonResult}\n\nView full comparison: ${shareUrl}\n      `.trim();\n\n      // Copy full text to clipboard\n      await navigator.clipboard.writeText(fullComparisonText);\n\n      const platformMessages: Record<string, string> = {\n        twitter: `Check out this fascinating comparison of \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} languages! 🌍 #WikiTruth #Wikipedia`,\n        linkedin: `Interesting cultural perspectives on \"${comparison.articleTitle}\" revealed through multi-language Wikipedia analysis.`,\n        whatsapp: `Found some interesting differences in how \"${comparison.articleTitle}\" is presented across different Wikipedia languages!`,\n        telegram: `Multi-language Wikipedia comparison: \"${comparison.articleTitle}\" - revealing cultural perspectives and narrative differences`,\n        reddit: `Cultural differences in \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} Wikipedia languages`\n      };\n\n      const message = platformMessages[platform] || `Check out this Wikipedia comparison: \"${comparison.articleTitle}\"`;\n      \n      // Create platform-specific share URLs (but we've already copied text to clipboard)\n      const shareUrls: Record<string, string> = {\n        twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&url=${encodeURIComponent(shareUrl)}`,\n        linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}&summary=${encodeURIComponent(message)}`,\n        whatsapp: `https://wa.me/?text=${encodeURIComponent(message + ' ' + shareUrl)}`,\n        telegram: `https://t.me/share/url?url=${encodeURIComponent(shareUrl)}&text=${encodeURIComponent(message)}`,\n        reddit: `https://reddit.com/submit?url=${encodeURIComponent(shareUrl)}&title=${encodeURIComponent(message)}`\n      };\n\n      return shareUrls[platform] || shareUrl;\n    } catch (error) {\n      console.error('Share comparison error:', error);\n      throw error;\n    }\n  }\n};","path":null,"size_bytes":14303,"size_tokens":null},"client/src/lib/wikipedia-client.ts":{"content":"export interface WikipediaSearchResult {\n  title: string;\n  snippet: string;\n  pageid: number;\n}\n\nexport interface WikipediaLanguageLink {\n  lang: string;\n  title: string;\n  url: string;\n}\n\nexport interface WikipediaArticle {\n  title: string;\n  content: string;\n  language: string;\n  contentLength: number;\n}\n\nclass WikipediaClient {\n  private getCorsProxyUrl(url: string): string {\n    // Use AllOrigins as a more reliable CORS proxy\n    return `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;\n  }\n\n  private getApiUrl(language: string): string {\n    return `https://${language}.wikipedia.org/w/api.php`;\n  }\n\n  async searchArticles(query: string, language: string = 'en', limit: number = 10): Promise<WikipediaSearchResult[]> {\n    try {\n      const apiUrl = this.getApiUrl(language);\n      const params = new URLSearchParams({\n        action: 'opensearch',\n        search: query,\n        limit: limit.toString(),\n        namespace: '0',\n        format: 'json',\n        origin: '*'\n      });\n\n      const url = `${apiUrl}?${params}`;\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`Wikipedia API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      \n      if (!Array.isArray(data) || data.length < 4) {\n        return [];\n      }\n\n      const [, titles, snippets, urls] = data;\n      \n      return titles.map((title: string, index: number) => ({\n        title,\n        snippet: snippets[index] || '',\n        pageid: index + 1\n      }));\n    } catch (error) {\n      console.error('Wikipedia search error:', error);\n      return [];\n    }\n  }\n\n  async getLanguageLinks(title: string, language: string = 'en'): Promise<WikipediaLanguageLink[]> {\n    try {\n      const apiUrl = this.getApiUrl(language);\n      const params = new URLSearchParams({\n        action: 'query',\n        titles: title,\n        prop: 'langlinks',\n        lllimit: '500',\n        format: 'json',\n        origin: '*'\n      });\n\n      const url = `${apiUrl}?${params}`;\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`Wikipedia API error: ${response.status}`);\n      }\n\n      const data = await response.json();\n      const pages = data.query?.pages;\n      \n      if (!pages) return [];\n\n      const pageId = Object.keys(pages)[0];\n      const langlinks = pages[pageId]?.langlinks || [];\n\n      const languageLinks = langlinks.map((link: any) => ({\n        lang: link.lang,\n        title: link['*'],\n        url: `https://${link.lang}.wikipedia.org/wiki/${encodeURIComponent(link['*'])}`\n      }));\n\n      // Add the current language version\n      languageLinks.unshift({\n        lang: language,\n        title: title,\n        url: `https://${language}.wikipedia.org/wiki/${encodeURIComponent(title)}`\n      });\n\n      return languageLinks;\n    } catch (error) {\n      console.error('Wikipedia language links error:', error);\n      return [];\n    }\n  }\n\n  async getArticleContent(title: string, language: string = 'en'): Promise<WikipediaArticle> {\n    console.log(`Fetching article \"${title}\" in ${language}...`);\n    \n    const apiUrl = this.getApiUrl(language);\n    const params = new URLSearchParams({\n      action: 'query',\n      titles: title,\n      prop: 'extracts',\n      exintro: 'false',\n      explaintext: 'true',\n      exsectionformat: 'plain',\n      format: 'json',\n      origin: '*'\n    });\n\n    const url = `${apiUrl}?${params}`;\n    \n    try {\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n      const pages = data.query?.pages;\n      \n      if (!pages) {\n        throw new Error('No pages found in response');\n      }\n\n      const pageId = Object.keys(pages)[0];\n      const page = pages[pageId];\n      \n      if (pageId === '-1' || !page) {\n        throw new Error(`Article \"${title}\" not found`);\n      }\n      \n      const content = page.extract || '';\n      if (content.length < 100) {\n        throw new Error(`Article \"${title}\" has insufficient content (${content.length} chars)`);\n      }\n      \n      console.log(`✓ Fetched ${language}:${title} (${content.length} chars)`);\n      \n      return {\n        title: page.title || title,\n        content,\n        language,\n        contentLength: content.length\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      console.error(`✗ Failed to fetch ${language}:${title}:`, errorMessage);\n      throw new Error(`Failed to fetch ${language} article: ${errorMessage}`);\n    }\n  }\n\n  async getMultipleArticleContents(\n    articlesByLanguage: Record<string, string>, // language -> title\n    baseLanguage: string = 'en'\n  ): Promise<WikipediaArticle[]> {\n    const articles: WikipediaArticle[] = [];\n    \n    console.log('Starting article fetch for:', articlesByLanguage);\n    \n    // Ensure we have at least the base language\n    if (!articlesByLanguage[baseLanguage]) {\n      console.error('Base language not found in article mapping');\n      throw new Error(`Base language \"${baseLanguage}\" not found in language mapping`);\n    }\n    \n    // Fetch articles sequentially to avoid rate limiting\n    for (const [language, title] of Object.entries(articlesByLanguage)) {\n      if (!title || title.trim() === '') {\n        console.warn(`Skipping ${language}: empty title`);\n        continue;\n      }\n      \n      try {\n        const article = await this.getArticleContent(title.trim(), language);\n        articles.push(article);\n      } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : String(error);\n        console.error(`Failed to fetch ${language} article \"${title}\":`, errorMessage);\n        \n        // If this is the base language and it fails, try with original search term\n        if (language === baseLanguage && articles.length === 0) {\n          console.log(`Retrying base language with fallback...`);\n          try {\n            const fallbackArticle = await this.getArticleContent(title.trim(), language);\n            articles.push(fallbackArticle);\n          } catch (fallbackError) {\n            const fallbackMessage = fallbackError instanceof Error ? fallbackError.message : String(fallbackError);\n            console.error(`Fallback also failed:`, fallbackMessage);\n          }\n        }\n      }\n      \n      // Small delay to be respectful to Wikipedia's servers\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n    \n    console.log(`Fetched ${articles.length} out of ${Object.keys(articlesByLanguage).length} articles`);\n    \n    if (articles.length === 0) {\n      throw new Error('No articles could be fetched. Please check that the article exists in the selected languages.');\n    }\n    \n    return articles;\n  }\n}\n\nexport const wikipediaClient = new WikipediaClient();","path":null,"size_bytes":6955,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"debug-openai.js":{"content":"// Quick test to check OpenAI API functionality\n// Run this in browser console to test the API directly\n\nasync function testOpenAI() {\n  const apiKey = localStorage.getItem('openai-api-key');\n  \n  if (!apiKey) {\n    console.log('No API key found in localStorage');\n    return;\n  }\n  \n  console.log('API key found, testing...');\n  \n  try {\n    const response = await fetch('https://api.openai.com/v1/models', {\n      headers: {\n        'Authorization': `Bearer ${apiKey}`\n      }\n    });\n    \n    console.log('Models API response:', response.status);\n    \n    if (response.ok) {\n      console.log('API key is valid');\n      \n      // Test simple completion\n      const testResponse = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n          model: 'gpt-4o',\n          messages: [\n            { role: 'user', content: 'Say \"API test successful\"' }\n          ],\n          max_tokens: 10\n        })\n      });\n      \n      console.log('Chat completion response:', testResponse.status);\n      \n      if (testResponse.ok) {\n        const data = await testResponse.json();\n        console.log('Test result:', data.choices[0].message.content);\n      } else {\n        const error = await testResponse.text();\n        console.error('Chat completion error:', error);\n      }\n    } else {\n      const error = await response.text();\n      console.error('API key validation failed:', error);\n    }\n  } catch (error) {\n    console.error('Network error:', error);\n  }\n}\n\n// Run the test\ntestOpenAI();","path":null,"size_bytes":1673,"size_tokens":null},"client/src/pages/comparison-results.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { useRoute, useLocation } from 'wouter';\nimport { useQuery } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Crown, Globe } from 'lucide-react';\nimport { api } from '@/lib/api';\nimport { getLanguageName, getLanguageNativeName } from '@/lib/languages';\nimport { useToast } from '@/hooks/use-toast';\nimport { ComparisonChat } from '@/components/comparison-chat';\nimport { clientStorage } from '@/lib/storage';\nimport { TextHighlighter } from '@/components/text-highlighter';\n\n\n// Enhanced markdown formatter function\nfunction formatMarkdownContent(content: string) {\n  // Clean up problematic symbols that cause mobile display issues first\n  content = content\n    // Remove standalone equal sign dividers (common AI output issue)\n    .replace(/^={3,}$/gm, '')\n    // Remove standalone dash dividers\n    .replace(/^-{3,}$/gm, '')\n    // Remove standalone asterisk dividers\n    .replace(/^\\*{3,}$/gm, '')\n    // Remove lines with only symbols and whitespace\n    .replace(/^\\s*[=\\-\\*]{3,}\\s*$/gm, '');\n  \n  // Split content into lines for better processing\n  let lines = content.split('\\n');\n  let result = [];\n  let inList = false;\n  \n  for (let i = 0; i < lines.length; i++) {\n    let line = lines[i];\n    \n    // Handle headers (#### ### ## #)\n    if (line.match(/^#{1,4}\\s+/)) {\n      const level = line.match(/^(#{1,4})/)?.[1].length || 1;\n      const text = line.replace(/^#{1,4}\\s+/, '').trim();\n      \n      switch (level) {\n        case 1:\n          result.push(`<h1 class=\"text-2xl font-bold mb-6 mt-0 text-foreground border-b border-border pb-3\">${formatInlineMarkdown(text)}</h1>`);\n          break;\n        case 2:\n          result.push(`<h2 class=\"text-xl font-semibold mb-3 text-foreground mt-8 border-b border-border/50 pb-2\">${formatInlineMarkdown(text)}</h2>`);\n          break;\n        case 3:\n          result.push(`<h3 class=\"text-lg font-semibold mb-2 text-foreground mt-6\">${formatInlineMarkdown(text)}</h3>`);\n          break;\n        case 4:\n          result.push(`<h4 class=\"text-base font-semibold mb-2 text-foreground mt-4\">${formatInlineMarkdown(text)}</h4>`);\n          break;\n      }\n      continue;\n    }\n    \n    // Handle bullet points\n    if (line.match(/^[\\s]*[-*+]\\s+/)) {\n      if (!inList) {\n        result.push('<ul class=\"list-disc pl-6 mb-4 space-y-2\">');\n        inList = true;\n      }\n      const text = line.replace(/^[\\s]*[-*+]\\s+/, '').trim();\n      result.push(`<li class=\"leading-relaxed text-foreground/90\">${formatInlineMarkdown(text)}</li>`);\n      continue;\n    }\n    \n    // Handle numbered lists\n    if (line.match(/^[\\s]*\\d+\\.\\s+/)) {\n      if (!inList) {\n        result.push('<ol class=\"list-decimal pl-6 mb-4 space-y-2\">');\n        inList = true;\n      }\n      const text = line.replace(/^[\\s]*\\d+\\.\\s+/, '').trim();\n      result.push(`<li class=\"leading-relaxed text-foreground/90\">${formatInlineMarkdown(text)}</li>`);\n      continue;\n    }\n    \n    // Close list if we're in one and hit non-list content\n    if (inList && !line.match(/^[\\s]*[-*+\\d]/)) {\n      result.push(inList ? '</ul>' : '</ol>');\n      inList = false;\n    }\n    \n    // Handle empty lines\n    if (line.trim() === '') {\n      if (!inList) {\n        result.push('');\n      }\n      continue;\n    }\n    \n    // Handle regular paragraphs\n    if (!inList) {\n      result.push(`<p class=\"mb-4 leading-relaxed text-foreground/90\">${formatInlineMarkdown(line)}</p>`);\n    }\n  }\n  \n  // Close any open list\n  if (inList) {\n    result.push('</ul>');\n  }\n  \n  return result.join('\\n');\n}\n\n// Helper function for inline markdown (bold, italic, etc.)\nfunction formatInlineMarkdown(text: string): string {\n  return text\n    // Replace **bold** text with proper HTML - using primary color for emphasis\n    .replace(/\\*\\*(.+?)\\*\\*/g, '<strong class=\"font-semibold text-foreground\">$1</strong>')\n    // Replace *italic* text with proper HTML (but not bullet points)\n    .replace(/(?<!\\*)\\*([^*]+?)\\*(?!\\*)/g, '<em class=\"italic text-muted-foreground\">$1</em>')\n    // Clean up any remaining stray markdown symbols and problematic formatting\n    .replace(/#{5,}/g, '')\n    .replace(/^\\s*[#]+\\s*$/g, '')\n    // Remove equal signs that might be used as dividers (common mobile issue)\n    .replace(/^={3,}$/gm, '')\n    .replace(/\\s*={3,}\\s*/g, '')\n    // Remove dash dividers that display poorly on mobile\n    .replace(/^-{3,}$/gm, '')\n    .replace(/\\s*-{5,}\\s*/g, '')\n    // Clean up asterisk dividers\n    .replace(/^\\*{3,}$/gm, '')\n    .replace(/\\s*\\*{5,}\\s*/g, '');\n}\n\nexport default function ComparisonResults() {\n  const [match, params] = useRoute('/results/:id');\n  const [, setLocation] = useLocation();\n  const [isPremiumUser, setIsPremiumUser] = useState(false);\n  const [isChatVisible, setIsChatVisible] = useState(false);\n  const { toast } = useToast();\n  \n  const comparisonId = params?.id || null;\n\n  // Check premium status\n  useEffect(() => {\n    const checkPremiumStatus = async () => {\n      try {\n        const user = await clientStorage.getCurrentUser();\n        const status = await clientStorage.checkSubscriptionStatus();\n        setIsPremiumUser(status.isValid && user.subscription.isPremium);\n      } catch (error) {\n        console.error('Failed to check premium status:', error);\n      }\n    };\n    checkPremiumStatus();\n  }, []);\n\n  const comparisonQuery = useQuery({\n    queryKey: ['/api/compare', comparisonId],\n    queryFn: () => api.getComparison(comparisonId!),\n    enabled: !!comparisonId,\n  });\n\n  const handleExport = async () => {\n    if (!comparisonId) return;\n    \n    try {\n      const blob = await api.exportComparison(comparisonId);\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `wiki-truth-${comparisonQuery.data?.articleTitle}-comparison.docx`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n      \n      toast({\n        title: \"Export Successful\",\n        description: \"Comparison has been exported as a Word document.\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Export Failed\",\n        description: \"Failed to export the comparison document.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleShare = async (platform: string) => {\n    if (!comparisonId || !comparisonQuery.data) return;\n    \n    try {\n      const comparison = comparisonQuery.data;\n      const wikiTruthUrl = window.location.origin;\n      const currentUrl = window.location.href;\n      \n      // Create full text for clipboard\n      const fullText = `Wiki Truth Comparison: \"${comparison.articleTitle}\"\\n\\nLanguages compared: ${comparison.selectedLanguages.map(lang => lang.toUpperCase()).join(', ')}\\n\\n${comparison.comparisonResult}\\n\\nDiscover more at ${wikiTruthUrl}`;\n      \n      // Copy to clipboard\n      await navigator.clipboard.writeText(fullText);\n      \n      // Create platform-specific messages and URLs\n      const platformMessages: Record<string, string> = {\n        twitter: `🌍 Fascinating Wikipedia comparison: \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} languages reveals cultural differences! #WikiTruth #Wikipedia #X`,\n        facebook: `Check out this interesting Wikipedia comparison of \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} languages. The cultural perspectives are fascinating!`,\n        linkedin: `I just compared the Wikipedia article \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} languages. The AI analysis reveals interesting cultural perspectives and factual variations.`,\n        whatsapp: `Check out this interesting Wikipedia comparison: \"${comparison.articleTitle}\" across ${comparison.selectedLanguages.length} languages. The differences are quite revealing!`,\n        telegram: `📖 Multi-language Wikipedia comparison: \"${comparison.articleTitle}\" - revealing cultural perspectives and narrative differences across ${comparison.selectedLanguages.length} languages`,\n        reddit: `TIL: The Wikipedia article for \"${comparison.articleTitle}\" varies significantly across ${comparison.selectedLanguages.length} languages. Here's an AI analysis of the differences:`\n      };\n\n      const message = platformMessages[platform] || `Check out this Wikipedia comparison: \"${comparison.articleTitle}\"`;\n      \n      // Create platform-specific share URLs\n      const shareUrls: Record<string, string> = {\n        twitter: `https://twitter.com/intent/tweet?text=${encodeURIComponent(message)}&url=${encodeURIComponent(currentUrl)}`,\n        facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(currentUrl)}&quote=${encodeURIComponent(message)}`,\n        linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(currentUrl)}&summary=${encodeURIComponent(message)}`,\n        whatsapp: `https://wa.me/?text=${encodeURIComponent(message + ' ' + currentUrl)}`,\n        telegram: `https://t.me/share/url?url=${encodeURIComponent(currentUrl)}&text=${encodeURIComponent(message)}`,\n        reddit: `https://reddit.com/submit?url=${encodeURIComponent(currentUrl)}&title=${encodeURIComponent(message)}`\n      };\n\n      // Open social media sharing window\n      if (shareUrls[platform]) {\n        window.open(shareUrls[platform], '_blank', 'width=600,height=400');\n      }\n      \n      toast({\n        title: \"Ready to Share\",\n        description: `Content copied to clipboard and ${platform} sharing opened.`,\n      });\n    } catch (error) {\n      console.error('Share error:', error);\n      toast({\n        title: \"Share Failed\",\n        description: \"Failed to prepare sharing content.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (!comparisonId) {\n    return (\n      <main className=\"lg:col-span-3\">\n        <div className=\"wiki-content-section\">\n          <h2 className=\"font-bold text-2xl mb-4\">Invalid Comparison</h2>\n          <p className=\"text-wiki-gray mb-4\">The comparison ID is invalid or missing.</p>\n          <Button onClick={() => setLocation('/')} className=\"wiki-button\">\n            Back to Search\n          </Button>\n        </div>\n      </main>\n    );\n  }\n\n  if (comparisonQuery.isLoading) {\n    return (\n      <main className=\"lg:col-span-3\">\n        <div className=\"wiki-content-section\">\n          <div className=\"text-center py-12\">\n            <i className=\"fas fa-spinner fa-spin text-4xl text-wiki-gray mb-4\"></i>\n            <h2 className=\"font-bold text-2xl mb-2\">Loading Comparison</h2>\n            <p className=\"text-wiki-gray\">Please wait while we load your comparison results...</p>\n          </div>\n        </div>\n      </main>\n    );\n  }\n\n  if (comparisonQuery.error || !comparisonQuery.data) {\n    return (\n      <main className=\"lg:col-span-3\">\n        <div className=\"wiki-content-section\">\n          <h2 className=\"font-bold text-2xl mb-4\">Comparison Not Found</h2>\n          <p className=\"text-wiki-gray mb-4\">\n            The requested comparison could not be found or loaded.\n          </p>\n          <Button onClick={() => setLocation('/')} className=\"wiki-button\">\n            Back to Search\n          </Button>\n        </div>\n      </main>\n    );\n  }\n\n  const comparison = comparisonQuery.data;\n  const languageNames = comparison.selectedLanguages.map(lang => \n    `${getLanguageNativeName(lang)} (${getLanguageName(lang)})`\n  ).join(', ');\n\n  return (\n    <main className=\"lg:col-span-3\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"flex flex-col gap-4 mb-6\">\n          <div className=\"flex flex-col gap-2\">\n            <h2 className=\"font-bold text-xl md:text-2xl\">\n              Comparison Results\n            </h2>\n            <div className=\"flex flex-wrap items-center gap-2\">\n              {comparison.isPremium && (\n                <Badge className=\"bg-green-100 text-green-800 border-green-300 text-xs md:text-sm\">\n                  <Crown className=\"h-3 w-3 mr-1\" />\n                  Premium\n                </Badge>\n              )}\n              {comparison.isFunnyMode && (\n                <Badge className=\"bg-gradient-to-r from-pink-500 to-yellow-500 text-white text-xs md:text-sm\">\n                  FUNNY MODE\n                </Badge>\n              )}\n            </div>\n          </div>\n          <div className=\"flex flex-col sm:flex-row gap-2\">\n            <Button onClick={handleExport} className=\"wiki-button text-sm flex-1 sm:flex-initial\">\n              <i className=\"fas fa-file-word mr-2\"></i>Export DOCX\n            </Button>\n            <Button \n              onClick={() => handleShare('general')} \n              className=\"wiki-button text-sm flex-1 sm:flex-initial\"\n            >\n              <i className=\"fas fa-share mr-2\"></i>Share\n            </Button>\n          </div>\n        </div>\n\n        {/* Article Metadata */}\n        <div className=\"mb-6 p-3 md:p-4 bg-wiki-light-gray border border-wiki-light-border rounded\">\n          <h3 className=\"font-semibold mb-2 text-sm md:text-base\">\n            Compared Article: <span className=\"text-wiki-blue break-words\">{comparison.articleTitle}</span>\n          </h3>\n          <div className=\"text-xs md:text-sm text-wiki-gray space-y-1 md:space-y-0\">\n            <div className=\"flex flex-col md:flex-row md:items-center gap-1 md:gap-2\">\n              <span>Languages compared: <span className=\"font-medium\">{languageNames}</span></span>\n              <span className=\"hidden md:inline\">•</span>\n              <span>Output language: <span className=\"font-medium\">{getLanguageName(comparison.outputLanguage)}</span></span>\n            </div>\n          </div>\n          {comparison.articles && (\n            <div className=\"text-xs md:text-sm text-wiki-gray mt-2\">\n              <div className=\"font-medium mb-1\">Article lengths:</div>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-1 md:gap-2\">\n                {comparison.articles.map(a => (\n                  <span key={a.language} className=\"block md:inline\">\n                    {getLanguageNativeName(a.language)}: {(a.contentLength || 0).toLocaleString()} chars\n                  </span>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Comparison Content with Highlighting */}\n        <TextHighlighter\n          content={comparison.comparisonResult}\n          comparisonId={comparison.id}\n          formatContent={formatMarkdownContent}\n        />\n\n        {/* Share Buttons */}\n        <div className=\"mt-6 md:mt-8 pt-4 md:pt-6 border-t border-wiki-light-border\">\n          <h3 className=\"font-semibold text-base md:text-lg mb-4 md:mb-6 text-center\">Share this comparison</h3>\n          \n          {/* Copy to Clipboard */}\n          <div className=\"mb-4 md:mb-6 flex justify-center px-4\">\n            <Button \n              onClick={async () => {\n                try {\n                  const comparison = comparisonQuery.data!;\n                  const wikiTruthUrl = window.location.origin;\n                  const fullText = `Wiki Truth Comparison: \"${comparison.articleTitle}\"\\n\\nLanguages compared: ${comparison.selectedLanguages.map(lang => lang.toUpperCase()).join(', ')}\\n\\n${comparison.comparisonResult}\\n\\nDiscover more at ${wikiTruthUrl}`;\n                  await navigator.clipboard.writeText(fullText);\n                  toast({\n                    title: \"Copied to Clipboard\",\n                    description: \"Comparison and Wiki Truth link copied to clipboard\",\n                  });\n                } catch (error) {\n                  toast({\n                    title: \"Copy Failed\", \n                    description: \"Could not copy to clipboard\",\n                    variant: \"destructive\"\n                  });\n                }\n              }} \n              className=\"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-4 md:px-6 py-2 md:py-3 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105 text-sm md:text-base w-full sm:w-auto\"\n            >\n              <i className=\"fas fa-copy mr-2 md:mr-3 text-base md:text-lg\"></i>\n              <span className=\"font-semibold\">Copy Full Text + Link</span>\n            </Button>\n          </div>\n\n          {/* Social Media Buttons */}\n          <div className=\"flex flex-wrap justify-center gap-3 md:gap-4 px-4\">\n            {/* X (Twitter) */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('twitter')} \n                className=\"bg-black hover:bg-gray-800 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on X\"\n              >\n                <span className=\"text-lg md:text-2xl font-bold group-hover:animate-pulse\">𝕏</span>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">X</span>\n            </div>\n\n            {/* Facebook */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('facebook')} \n                className=\"bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on Facebook\"\n              >\n                <i className=\"fab fa-facebook-f text-base md:text-xl group-hover:animate-pulse\"></i>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">Facebook</span>\n            </div>\n\n            {/* LinkedIn */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('linkedin')} \n                className=\"bg-blue-700 hover:bg-blue-800 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on LinkedIn\"\n              >\n                <i className=\"fab fa-linkedin text-base md:text-xl group-hover:animate-pulse\"></i>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">LinkedIn</span>\n            </div>\n\n            {/* WhatsApp */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('whatsapp')} \n                className=\"bg-green-500 hover:bg-green-600 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on WhatsApp\"\n              >\n                <i className=\"fab fa-whatsapp text-base md:text-xl group-hover:animate-pulse\"></i>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">WhatsApp</span>\n            </div>\n\n            {/* Telegram */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('telegram')} \n                className=\"bg-blue-500 hover:bg-blue-600 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on Telegram\"\n              >\n                <i className=\"fab fa-telegram text-base md:text-xl group-hover:animate-pulse\"></i>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">Telegram</span>\n            </div>\n\n            {/* Reddit */}\n            <div className=\"flex flex-col items-center gap-1 md:gap-2\">\n              <Button \n                onClick={() => handleShare('reddit')} \n                className=\"bg-orange-600 hover:bg-orange-700 text-white w-12 h-12 md:w-16 md:h-16 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 flex items-center justify-center group p-0\"\n                title=\"Share on Reddit\"\n              >\n                <i className=\"fab fa-reddit text-base md:text-xl group-hover:animate-pulse\"></i>\n              </Button>\n              <span className=\"text-xs text-gray-600 font-medium\">Reddit</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mt-6 text-center px-4\">\n          <Button\n            variant=\"ghost\"\n            onClick={() => setLocation('/')}\n            className=\"wiki-link text-sm md:text-base\"\n          >\n            ← Start New Comparison\n          </Button>\n        </div>\n      </div>\n\n      {/* Premium Chat Feature */}\n      {isPremiumUser && (\n        <ComparisonChat\n          comparisonResult={comparison.comparisonResult}\n          articleTitle={comparison.articleTitle}\n          selectedLanguages={comparison.selectedLanguages}\n          isVisible={isChatVisible}\n          onToggle={() => setIsChatVisible(!isChatVisible)}\n        />\n      )}\n    </main>\n  );\n}\n","path":null,"size_bytes":21395,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/premium-indicator.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Crown } from 'lucide-react';\nimport { clientStorage, type UserAccount } from '@/lib/storage';\n\nexport function PremiumIndicator() {\n  const [user, setUser] = useState<UserAccount | null>(null);\n\n  useEffect(() => {\n    const loadUser = async () => {\n      try {\n        const userData = await clientStorage.getCurrentUser();\n        setUser(userData);\n      } catch (error) {\n        console.error('Failed to load user data:', error);\n      }\n    };\n\n    loadUser();\n  }, []);\n\n  if (!user?.subscription.isPremium) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex items-center gap-1 px-2 py-1 bg-lime-100 text-lime-700 rounded-full text-xs font-medium\">\n      <Crown className=\"h-3 w-3 text-yellow-500\" />\n      <span>Premium</span>\n    </div>\n  );\n}","path":null,"size_bytes":815,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":2627,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/pages/privacy.tsx":{"content":"import { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function PrivacyPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <main className=\"container mx-auto max-w-7xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        <h1 className=\"wiki-article-title\">Privacy Policy</h1>\n        <p className=\"text-wiki-gray mb-6\">\n          Your privacy is fundamental to Wiki Truth. Learn how we protect your data and ensure complete privacy.\n        </p>\n\n        <div className=\"space-y-8\">\n          {/* Privacy Summary */}\n          <section>\n            <div className=\"bg-green-50 border border-green-200 rounded p-6\">\n              <h2 className=\"font-semibold text-green-900 mb-3\">\n                <i className=\"fas fa-shield-alt mr-2\"></i>Privacy Summary\n              </h2>\n              <p className=\"text-green-800 mb-3\">\n                Wiki Truth is designed with privacy-first principles:\n              </p>\n              <ul className=\"text-sm text-green-700 space-y-1\">\n                <li>• <strong>No accounts required</strong> - Use the service completely anonymously</li>\n                <li>• <strong>Local storage only</strong> - All data stays in your browser</li>\n                <li>• <strong>No tracking</strong> - No analytics, cookies, or user profiling</li>\n                <li>• <strong>No server storage</strong> - We don't store any comparison data</li>\n                <li>• <strong>Open source</strong> - Code is transparent and auditable</li>\n              </ul>\n            </div>\n          </section>\n\n          {/* Data Collection */}\n          <section>\n            <h2 className=\"wiki-section-title\">Data Collection</h2>\n            <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n              <h3 className=\"font-semibold mb-3\">What We DO NOT Collect</h3>\n              <ul className=\"text-sm space-y-2 mb-4\">\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-times text-red-500 mt-1\"></i>\n                  <span>Personal information (name, email, address)</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-times text-red-500 mt-1\"></i>\n                  <span>User accounts or login credentials</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-times text-red-500 mt-1\"></i>\n                  <span>IP addresses or device fingerprints</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-times text-red-500 mt-1\"></i>\n                  <span>Usage analytics or tracking data</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-times text-red-500 mt-1\"></i>\n                  <span>Cookies for tracking purposes</span>\n                </li>\n              </ul>\n\n              <h3 className=\"font-semibold mb-3\">What We DO Collect</h3>\n              <ul className=\"text-sm space-y-2\">\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-check text-green-500 mt-1\"></i>\n                  <span>Article content temporarily during AI analysis (deleted immediately after)</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <i className=\"fas fa-check text-green-500 mt-1\"></i>\n                  <span>Basic error logs for system functionality (no personal data)</span>\n                </li>\n              </ul>\n            </div>\n          </section>\n\n          {/* Local Storage */}\n          <section>\n            <h2 className=\"wiki-section-title\">Local Data Storage</h2>\n            <div className=\"bg-blue-50 border border-blue-200 rounded p-6\">\n              <h3 className=\"font-semibold text-blue-900 mb-3\">\n                <i className=\"fas fa-database mr-2\"></i>Browser Storage\n              </h3>\n              <p className=\"text-sm text-blue-800 mb-3\">\n                All your comparison data is stored locally in your browser using IndexedDB:\n              </p>\n              <ul className=\"text-sm text-blue-700 space-y-2\">\n                <li>• <strong>Comparison results:</strong> Your AI-generated analyses</li>\n                <li>• <strong>Search history:</strong> Articles you've compared</li>\n                <li>• <strong>User preferences:</strong> Language and theme settings</li>\n                <li>• <strong>Session data:</strong> Temporary comparison state</li>\n              </ul>\n              \n              <div className=\"mt-4 p-3 bg-blue-100 rounded\">\n                <p className=\"text-sm text-blue-800\">\n                  <i className=\"fas fa-info-circle mr-2\"></i>\n                  This data never leaves your device and is completely under your control.\n                </p>\n              </div>\n            </div>\n          </section>\n\n          {/* External Services */}\n          <section>\n            <h2 className=\"wiki-section-title\">External Services</h2>\n            <div className=\"space-y-4\">\n              <div className=\"bg-gray-50 border border-gray-200 rounded p-4\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fab fa-wikipedia-w mr-2 text-gray-600\"></i>Wikipedia API\n                </h3>\n                <p className=\"text-sm text-gray-700\">\n                  We access Wikipedia's public API to retrieve article content. This is done directly from your browser \n                  using Wikipedia's official endpoints. No personal data is sent to Wikipedia.\n                </p>\n              </div>\n\n              <div className=\"bg-gray-50 border border-gray-200 rounded p-4\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fas fa-brain mr-2 text-purple-600\"></i>OpenRouter.ai\n                </h3>\n                <p className=\"text-sm text-gray-700\">\n                  Article content is sent to OpenRouter.ai for AI analysis using Meta Llama models. \n                  This data is processed temporarily and not stored by the AI service. No personal information is included.\n                </p>\n              </div>\n\n              <div className=\"bg-gray-50 border border-gray-200 rounded p-4\">\n                <h3 className=\"font-semibold mb-2\">\n                  <i className=\"fas fa-globe mr-2 text-blue-600\"></i>CORS Proxy\n                </h3>\n                <p className=\"text-sm text-gray-700\">\n                  We use AllOrigins service to bypass browser CORS restrictions when accessing Wikipedia. \n                  This is a technical requirement and doesn't involve personal data transmission.\n                </p>\n              </div>\n            </div>\n          </section>\n\n          {/* Your Rights */}\n          <section>\n            <h2 className=\"wiki-section-title\">Your Rights & Control</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"bg-green-50 border border-green-200 rounded p-4\">\n                <h3 className=\"font-semibold text-green-900 mb-3\">\n                  <i className=\"fas fa-user-check mr-2\"></i>Complete Control\n                </h3>\n                <ul className=\"text-sm text-green-800 space-y-1\">\n                  <li>• Export all your data at any time</li>\n                  <li>• Delete individual comparisons</li>\n                  <li>• Clear all data with one click</li>\n                  <li>• No external accounts to manage</li>\n                  <li>• Use the service anonymously</li>\n                </ul>\n              </div>\n\n              <div className=\"bg-blue-50 border border-blue-200 rounded p-4\">\n                <h3 className=\"font-semibold text-blue-900 mb-3\">\n                  <i className=\"fas fa-download mr-2\"></i>Data Portability\n                </h3>\n                <ul className=\"text-sm text-blue-800 space-y-1\">\n                  <li>• Export data in standard JSON format</li>\n                  <li>• Copy comparison results to clipboard</li>\n                  <li>• No vendor lock-in or data hostage</li>\n                  <li>• Transfer data between devices manually</li>\n                  <li>• Backup and restore capabilities</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* GDPR Compliance */}\n          <section>\n            <h2 className=\"wiki-section-title\">GDPR & Legal Compliance</h2>\n            <div className=\"bg-purple-50 border border-purple-200 rounded p-6\">\n              <h3 className=\"font-semibold text-purple-900 mb-3\">\n                <i className=\"fas fa-balance-scale mr-2\"></i>Privacy by Design\n              </h3>\n              <p className=\"text-sm text-purple-800 mb-3\">\n                Wiki Truth is GDPR compliant by design, meaning privacy protection is built into the system architecture:\n              </p>\n              <ul className=\"text-sm text-purple-700 space-y-2\">\n                <li>• <strong>Data Minimization:</strong> We collect only what's necessary for functionality</li>\n                <li>• <strong>Purpose Limitation:</strong> Data used only for article comparison</li>\n                <li>• <strong>Storage Limitation:</strong> No long-term data retention on servers</li>\n                <li>• <strong>Transparency:</strong> Open-source code for full auditability</li>\n                <li>• <strong>User Control:</strong> Complete ownership of your data</li>\n              </ul>\n            </div>\n          </section>\n\n          {/* Security */}\n          <section>\n            <h2 className=\"wiki-section-title\">Security Measures</h2>\n            <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Technical Security</h3>\n                  <ul className=\"text-sm space-y-1\">\n                    <li>• HTTPS encryption for all communications</li>\n                    <li>• No server-side data storage vulnerabilities</li>\n                    <li>• Client-side data encryption in browser</li>\n                    <li>• Regular security audits of dependencies</li>\n                  </ul>\n                </div>\n                <div>\n                  <h3 className=\"font-semibold mb-3\">Operational Security</h3>\n                  <ul className=\"text-sm space-y-1\">\n                    <li>• Minimal attack surface (no user databases)</li>\n                    <li>• No payment processing or financial data</li>\n                    <li>• Open-source transparency</li>\n                    <li>• Privacy-first development practices</li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          {/* Contact */}\n          <section>\n            <h2 className=\"wiki-section-title\">Questions About Privacy?</h2>\n            <div className=\"bg-gray-50 border border-gray-200 rounded p-6 text-center\">\n              <p className=\"text-gray-700 mb-4\">\n                If you have questions about our privacy practices or want to learn more about how Wiki Truth protects your data:\n              </p>\n              <div className=\"flex justify-center gap-4\">\n                <Button \n                  onClick={() => setLocation('/about')}\n                  className=\"wiki-button\"\n                >\n                  <i className=\"fas fa-info-circle mr-2\"></i>\n                  Learn More About Wiki Truth\n                </Button>\n                <Button \n                  onClick={() => setLocation('/tools')}\n                  className=\"wiki-button-primary\"\n                >\n                  <i className=\"fas fa-tools mr-2\"></i>\n                  Manage Your Data\n                </Button>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":12132,"size_tokens":null},"client/src/pages/tools.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { api } from '@/lib/api';\nimport { clientStorage } from '@/lib/storage';\nimport { useToast } from '@/hooks/use-toast';\nimport { getLanguageName } from '@/lib/languages';\n\nexport default function ToolsPage() {\n  const { toast } = useToast();\n\n  const comparisonsQuery = useQuery({\n    queryKey: ['/api/comparisons'],\n    queryFn: () => api.getUserComparisons(),\n  });\n\n  const handleExportAll = async () => {\n    try {\n      const allData = await clientStorage.exportAllData();\n      const dataStr = JSON.stringify(allData, null, 2);\n      const blob = new Blob([dataStr], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `wiki-truth-data-${new Date().toISOString().split('T')[0]}.json`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n      \n      toast({\n        title: \"Data Exported\",\n        description: \"All your data has been exported successfully\",\n      });\n    } catch (error) {\n      toast({\n        title: \"Export Failed\",\n        description: \"Could not export data\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleClearAll = async () => {\n    if (confirm('Are you sure you want to delete all your comparison data? This cannot be undone.')) {\n      try {\n        await clientStorage.clearAllData();\n        comparisonsQuery.refetch();\n        toast({\n          title: \"Data Cleared\",\n          description: \"All comparison data has been deleted\",\n        });\n      } catch (error) {\n        toast({\n          title: \"Clear Failed\",\n          description: \"Could not clear data\",\n          variant: \"destructive\"\n        });\n      }\n    }\n  };\n\n  const getRandomArticle = () => {\n    const topics = [\n      'Albert Einstein', 'World War II', 'Climate Change', 'Napoleon Bonaparte',\n      'Democracy', 'Artificial Intelligence', 'COVID-19', 'Renaissance',\n      'Buddhism', 'Leonardo da Vinci', 'Industrial Revolution', 'Quantum Physics',\n      'French Revolution', 'Ancient Rome', 'Socialism', 'Global Warming',\n      'Isaac Newton', 'World War I', 'Capitalism', 'Ancient Egypt'\n    ];\n    return topics[Math.floor(Math.random() * topics.length)];\n  };\n\n  return (\n    <main className=\"lg:col-span-3\">\n      <div className=\"wiki-content-section\">\n        <h1 className=\"wiki-article-title\">Tools & Utilities</h1>\n        <p className=\"text-wiki-gray mb-6\">\n          Manage your comparison data and explore additional features.\n        </p>\n\n        <div className=\"space-y-6\">\n          {/* Random Article Tool */}\n          <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n            <h2 className=\"font-semibold text-lg mb-3\">\n              <i className=\"fas fa-random mr-2\"></i>Random Article Generator\n            </h2>\n            <p className=\"text-wiki-gray mb-4\">\n              Get a random Wikipedia article suggestion for comparison.\n            </p>\n            <Button \n              onClick={() => {\n                const article = getRandomArticle();\n                toast({\n                  title: \"Random Article Suggestion\",\n                  description: `Try comparing: \"${article}\"`,\n                });\n              }}\n              className=\"wiki-button\"\n            >\n              <i className=\"fas fa-dice mr-2\"></i>\n              Generate Random Article\n            </Button>\n          </div>\n\n          {/* Data Management */}\n          <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n            <h2 className=\"font-semibold text-lg mb-3\">\n              <i className=\"fas fa-database mr-2\"></i>Data Management\n            </h2>\n            <p className=\"text-wiki-gray mb-4\">\n              Export or clear your comparison history stored locally in your browser.\n            </p>\n            \n            <div className=\"flex flex-wrap gap-3\">\n              <Button \n                onClick={handleExportAll}\n                className=\"wiki-button\"\n              >\n                <i className=\"fas fa-download mr-2\"></i>\n                Export All Data\n              </Button>\n              <Button \n                onClick={handleClearAll}\n                className=\"wiki-button-secondary\"\n              >\n                <i className=\"fas fa-trash mr-2\"></i>\n                Clear All Data\n              </Button>\n            </div>\n          </div>\n\n          {/* Comparison Statistics */}\n          <div className=\"bg-gray-50 border border-gray-200 rounded p-6\">\n            <h2 className=\"font-semibold text-lg mb-3\">\n              <i className=\"fas fa-chart-bar mr-2\"></i>Your Statistics\n            </h2>\n            \n            {comparisonsQuery.isLoading ? (\n              <p className=\"text-wiki-gray\">Loading statistics...</p>\n            ) : (\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-wiki-blue\">\n                    {comparisonsQuery.data?.length || 0}\n                  </div>\n                  <div className=\"text-sm text-wiki-gray\">Total Comparisons</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-wiki-blue\">\n                    {Array.from(new Set(comparisonsQuery.data?.flatMap(c => c.selectedLanguages) || [])).length}\n                  </div>\n                  <div className=\"text-sm text-wiki-gray\">Languages Used</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-wiki-blue\">\n                    {comparisonsQuery.data?.filter(c => c.isFunnyMode).length || 0}\n                  </div>\n                  <div className=\"text-sm text-wiki-gray\">Fun Mode</div>\n                </div>\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-wiki-blue\">\n                    {comparisonsQuery.data?.filter(c => !c.isFunnyMode).length || 0}\n                  </div>\n                  <div className=\"text-sm text-wiki-gray\">Academic</div>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Browser Info */}\n          <div className=\"bg-blue-50 border border-blue-200 rounded p-4\">\n            <h3 className=\"font-semibold text-blue-900 mb-2\">\n              <i className=\"fas fa-info-circle mr-2\"></i>Privacy Notice\n            </h3>\n            <p className=\"text-sm text-blue-800\">\n              All your comparison data is stored locally in your browser using IndexedDB. \n              No data is sent to external servers except for the AI analysis process.\n            </p>\n          </div>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":6933,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-lg border p-4 pr-6 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        /** обычный */\n        default: \"border bg-background text-foreground\",\n\n        /** ошибки/красный */\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n\n        /** ✅ наш новый салатовый вариант */\n        success:\n          \"border-green-300 bg-green-100 text-green-800\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4893,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1858,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2254,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/pages/terms-of-service.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { ArrowLeft, Download, Printer, ExternalLink } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function TermsOfServicePage() {\n  const handlePrint = () => {\n    window.print();\n  };\n\n  const handleDownload = () => {\n    const content = document.getElementById('terms-content')?.innerText || '';\n    const blob = new Blob([content], { type: 'text/plain' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = 'wiki-truth-terms-of-service.txt';\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Header with navigation and actions */}\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10\">\n        <div className=\"container mx-auto px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n              <Button variant=\"ghost\" size=\"sm\" asChild>\n                <Link href=\"/\">\n                  <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                  Back to Wiki Truth\n                </Link>\n              </Button>\n              <div className=\"h-6 w-px bg-gray-300 dark:bg-gray-600\" />\n              <h1 className=\"text-xl font-semibold text-gray-900 dark:text-white\">Terms of Service</h1>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handlePrint}>\n                <Printer className=\"h-4 w-4 mr-2\" />\n                Print\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n                <Download className=\"h-4 w-4 mr-2\" />\n                Download\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-6 py-8 max-w-6xl\">\n        <div className=\"grid lg:grid-cols-4 gap-8\">\n          {/* Table of Contents - Desktop Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-24\">\n              <CardContent className=\"p-4\">\n                <h3 className=\"font-semibold mb-4 text-gray-900 dark:text-white\">Contents</h3>\n                <ScrollArea className=\"h-[calc(100vh-200px)]\">\n                  <nav className=\"space-y-2\">\n                    <a href=\"#agreement\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">1. Agreement to Terms</a>\n                    <a href=\"#service\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">2. Service Description</a>\n                    <a href=\"#privacy\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">3. Privacy and Data</a>\n                    <a href=\"#subscription\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">4. Premium Subscription</a>\n                    <a href=\"#use\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">5. Acceptable Use</a>\n                    <a href=\"#intellectual\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">6. Intellectual Property</a>\n                    <a href=\"#warranties\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">7. Disclaimer</a>\n                    <a href=\"#liability\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">8. Limitation of Liability</a>\n                    <a href=\"#changes\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">9. Changes to Terms</a>\n                    <a href=\"#contact\" className=\"block text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\">10. Contact Information</a>\n                  </nav>\n                </ScrollArea>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"space-y-8\">\n            <div className=\"text-center lg:text-left\">\n              <div className=\"inline-flex items-center gap-2 bg-blue-100 dark:bg-blue-900/30 px-3 py-1 rounded-full text-sm text-blue-700 dark:text-blue-300 mb-4\">\n                <ExternalLink className=\"h-4 w-4\" />\n                Legal Document\n              </div>\n              <h1 className=\"text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-4\">\n                Terms of Service\n              </h1>\n              <p className=\"text-lg text-gray-600 dark:text-gray-300\">\n                Last updated: January 2, 2025 • Effective immediately\n              </p>\n            </div>\n\n            <div id=\"terms-content\" className=\"space-y-8\">\n              <Card>\n                <CardContent className=\"p-8 space-y-6\">\n                  <section id=\"agreement\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">1. Agreement to Terms</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      By accessing and using Wiki Truth, you accept and agree to be bound by the terms and provision of this agreement. \n                      If you do not agree to abide by the above, please do not use this service.\n                    </p>\n                  </section>\n\n                  <section id=\"service\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">2. Service Description</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed mb-3\">\n                      Wiki Truth is a freemium web application that enables users to compare Wikipedia articles across multiple languages using AI analysis:\n                    </p>\n                    <ul className=\"list-disc pl-6 text-gray-700 dark:text-gray-300 space-y-2\">\n                      <li><strong>Free Tier:</strong> Unlimited AI-powered comparisons with standard analysis</li>\n                      <li><strong>Premium Tier ($5/month):</strong> Enhanced AI analysis with full document processing capabilities</li>\n                      <li><strong>Privacy-First:</strong> All user data stored locally in your browser only</li>\n                    </ul>\n                  </section>\n\n                  <section id=\"privacy\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">3. Privacy and Data Storage</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed mb-3\">\n                      <strong>Local Data Storage:</strong> All your personal data, comparison history, and preferences are stored exclusively in your browser's local storage. We do not collect, store, or transmit your personal data to our servers.\n                    </p>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed mb-3\">\n                      <strong>Data Control:</strong> You have complete control over your data. You can export or delete all stored data at any time through the Settings menu.\n                    </p>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      <strong>Third-Party APIs:</strong> The service uses Wikipedia API for article content and AI services for analysis. These interactions are processed according to their respective privacy policies.\n                    </p>\n                  </section>\n\n                  <section id=\"subscription\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">4. Premium Subscription</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed mb-3\">\n                      Premium subscriptions are processed through NowPayments secure payment system at $10 USD per month:\n                    </p>\n                    <ul className=\"list-disc pl-6 text-gray-700 dark:text-gray-300 space-y-2\">\n                      <li>Subscription automatically renews monthly unless cancelled</li>\n                      <li>Subscription status is validated locally in your browser for 30 days</li>\n                      <li>No refunds for partial months, but you retain access until expiration</li>\n                      <li>You can cancel anytime through your payment provider</li>\n                    </ul>\n                  </section>\n\n                  <section id=\"use\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">5. Acceptable Use</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed mb-3\">\n                      You agree to use Wiki Truth responsibly:\n                    </p>\n                    <ul className=\"list-disc pl-6 text-gray-700 dark:text-gray-300 space-y-2\">\n                      <li>Do not use the service for any illegal or unauthorized purpose</li>\n                      <li>Do not attempt to reverse engineer or compromise the service</li>\n                      <li>Respect Wikipedia's terms of service when accessing their content</li>\n                      <li>Do not abuse AI analysis features or attempt to circumvent usage limits</li>\n                    </ul>\n                  </section>\n\n                  <section id=\"intellectual\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">6. Intellectual Property</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      Wikipedia content is licensed under Creative Commons. AI-generated analysis is provided for informational purposes. \n                      The Wiki Truth application and its original content are protected by copyright and intellectual property laws.\n                    </p>\n                  </section>\n\n                  <section id=\"warranties\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">7. Disclaimer of Warranties</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      Wiki Truth is provided \"as is\" without warranties of any kind. We do not guarantee the accuracy, completeness, or reliability of AI-generated comparisons. \n                      The service depends on third-party APIs (Wikipedia, AI services) which may experience downtime or changes.\n                    </p>\n                  </section>\n\n                  <section id=\"liability\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">8. Limitation of Liability</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      In no event shall Wiki Truth be liable for any indirect, incidental, special, consequential, or punitive damages, \n                      including without limitation, loss of profits, data, use, goodwill, or other intangible losses.\n                    </p>\n                  </section>\n\n                  <section id=\"changes\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">9. Changes to Terms</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      We reserve the right to modify these terms at any time. Changes will be posted on this page with an updated date. \n                      Continued use of the service after changes constitutes acceptance of the new terms.\n                    </p>\n                  </section>\n\n                  <section id=\"contact\">\n                    <h2 className=\"text-2xl font-semibold mb-3\">10. Contact Information</h2>\n                    <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                      For questions about these Terms of Service, please contact us through our Contact Us page or report issues through our Report Issues page.\n                    </p>\n                  </section>\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":12320,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { wikipediaService } from \"./services/wikipedia\";\nimport { openaiService } from \"./services/openai\";\nimport { openRouterService } from \"./services/openrouter\";\nimport { exportService } from \"./services/export\";\nimport { insertComparisonSchema, insertSearchSessionSchema, insertHighlightSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { nanoid } from \"nanoid\";\nimport { chatWithGrok } from './services/openaiChat';\nimport { createCheckoutSession } from './services/maxelpay';\n\nconst FREE_GENERATION_LIMIT = 1;\n\n// Free models to try in order of preference (shared between comparison and chat)\nconst freeModels = [\n  \"google/gemini-2.0-flash-exp:free\",\n  \"qwen/qwen-2.5-7b-instruct:free\", \n  \"microsoft/phi-3.5-mini-instruct:free\",\n  \"mistralai/mistral-7b-instruct:free\"\n];\n\n// Helper function for OpenRouter API calls with fallback\nasync function callOpenRouterWithFallback(messages: any[], temperature = 0.7, maxTokens = 500): Promise<string> {\n  if (!process.env.OPENROUTER_API_KEY) {\n    throw new Error('OpenRouter API key not configured');\n  }\n\n  for (let i = 0; i < freeModels.length; i++) {\n    const model = freeModels[i];\n    console.log(`Attempting chat with model: ${model}`);\n    \n    try {\n      const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${process.env.OPENROUTER_API_KEY}`,\n          'HTTP-Referer': process.env.YOUR_SITE_URL || 'http://localhost:5000',\n          'X-Title': 'WikiTruth',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          model: model,\n          messages: messages,\n          temperature: temperature,\n          max_tokens: maxTokens\n        })\n      });\n\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error(`Chat model ${model} failed:`, errorText);\n        \n        if (i === freeModels.length - 1) {\n          throw new Error(`OpenRouter API error: ${response.status} - ${errorText}`);\n        }\n        continue;\n      }\n\n      const data = await response.json();\n      const result = data.choices[0]?.message?.content;\n      \n      if (result) {\n        console.log(`Successfully used chat model: ${model}`);\n        return result;\n      }\n      \n      if (i === freeModels.length - 1) {\n        throw new Error('No chat response generated from any model');\n      }\n      \n    } catch (error) {\n      console.error(`Chat model ${model} error:`, error);\n      \n      if (i === freeModels.length - 1) {\n        throw new Error(`OpenRouter chat failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n      }\n      continue;\n    }\n  }\n  \n  throw new Error('All OpenRouter chat models failed');\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  \n  // Wikipedia search endpoint with optimized filtering\n  app.get(\"/api/wikipedia/search\", async (req, res) => {\n    try {\n      const { query, language = 'en', limit = 10 } = req.query;\n      \n      if (!query || typeof query !== 'string') {\n        return res.status(400).json({ error: \"Query parameter is required\" });\n      }\n\n      // Fetch more results initially since we'll filter some out\n      const initialLimit = Math.max(Number(limit) * 2, 15);\n      const results = await wikipediaService.searchArticles(\n        query,\n        language as string,\n        initialLimit\n      );\n      \n      // Batch check language links for better performance\n      const languageLinksPromises = results.map(async (result) => {\n        try {\n          const languageLinks = await wikipediaService.getLanguageLinks(\n            result.title,\n            language as string\n          );\n          return {\n            result,\n            hasMultipleLanguages: languageLinks.length > 0,\n            languageCount: languageLinks.length + 1 // +1 for the original language\n          };\n        } catch (error) {\n          return {\n            result,\n            hasMultipleLanguages: false,\n            languageCount: 1\n          };\n        }\n      });\n      \n      // Process all language link checks in parallel\n      const languageResults = await Promise.allSettled(languageLinksPromises);\n      \n      // Filter and sort results\n      const filteredResults = languageResults\n        .filter((promiseResult): promiseResult is PromiseFulfilledResult<any> => \n          promiseResult.status === 'fulfilled'\n        )\n        .map(promiseResult => promiseResult.value)\n        .filter(item => item.hasMultipleLanguages)\n        .sort((a, b) => b.languageCount - a.languageCount) // Sort by number of languages (more = better)\n        .slice(0, Number(limit))\n        .map(item => item.result);\n      \n      res.json(filteredResults);\n    } catch (error) {\n      console.error('Search error:', error);\n      res.status(500).json({ error: \"Failed to search articles\" });\n    }\n  });\n\n  // Get language links for an article\n  app.get(\"/api/wikipedia/languages\", async (req, res) => {\n    try {\n      const { title, language = 'en' } = req.query;\n      \n      if (!title || typeof title !== 'string') {\n        return res.status(400).json({ error: \"Title parameter is required\" });\n      }\n\n      const languageLinks = await wikipediaService.getLanguageLinks(\n        title,\n        language as string\n      );\n      \n      res.json(languageLinks);\n    } catch (error) {\n      console.error('Language links error:', error);\n      res.status(500).json({ error: \"Failed to fetch language links\" });\n    }\n  });\n\n  // Get article content\n  app.get(\"/api/wikipedia/article\", async (req, res) => {\n    try {\n      const { title, language = 'en' } = req.query;\n      \n      if (!title || typeof title !== 'string') {\n        return res.status(400).json({ error: \"Title parameter is required\" });\n      }\n\n      const article = await wikipediaService.getArticleContent(\n        title,\n        language as string\n      );\n      \n      res.json(article);\n    } catch (error) {\n      console.error('Article content error:', error);\n      res.status(500).json({ error: \"Failed to fetch article content\" });\n    }\n  });\n\n  // Create search session\n  app.post(\"/api/sessions\", async (req, res) => {\n    try {\n      const sessionData = {\n        sessionId: nanoid(),\n        searchQuery: null,\n        selectedArticle: null,\n        availableLanguages: null,\n        ...req.body\n      };\n\n      const validatedData = insertSearchSessionSchema.parse(sessionData);\n      const session = await storage.createSearchSession(validatedData);\n      \n      res.json(session);\n    } catch (error) {\n      console.error('Session creation error:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: \"Invalid session data\", details: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to create session\" });\n    }\n  });\n\n  // Update search session\n  app.patch(\"/api/sessions/:sessionId\", async (req, res) => {\n    try {\n      const { sessionId } = req.params;\n      const updates = req.body;\n\n      const session = await storage.updateSearchSession(sessionId, updates);\n      \n      if (!session) {\n        return res.status(404).json({ error: \"Session not found\" });\n      }\n      \n      res.json(session);\n    } catch (error) {\n      console.error('Session update error:', error);\n      res.status(500).json({ error: \"Failed to update session\" });\n    }\n  });\n\n  // Get search session\n  app.get(\"/api/sessions/:sessionId\", async (req, res) => {\n    try {\n      const { sessionId } = req.params;\n      const session = await storage.getSearchSession(sessionId);\n      \n      if (!session) {\n        return res.status(404).json({ error: \"Session not found\" });\n      }\n      \n      res.json(session);\n    } catch (error) {\n      console.error('Session fetch error:', error);\n      res.status(500).json({ error: \"Failed to fetch session\" });\n    }\n  });\n\n  // Compare articles with plan selection support (accepts client-provided articles)\n  app.post(\"/api/compare\", async (req, res) => {\n    try {\n      const { \n        articleTitle, \n        selectedLanguages, \n        outputLanguage, \n        baseLanguage = 'en',\n        isFunnyMode = false,\n        isPremium = false,\n        articles = null, // Client can provide pre-fetched articles\n        premiumOptions = null, // Premium analysis options (outputFormat, focusPoints, formality, analysisMode)\n        visitorId = null // For generation tracking as backend fail-safe\n      } = req.body;\n\n      if (!articleTitle || !selectedLanguages || !outputLanguage) {\n        return res.status(400).json({ \n          error: \"Missing required fields: articleTitle, selectedLanguages, outputLanguage\" \n        });\n      }\n\n      if (selectedLanguages.length < 2 || selectedLanguages.length > 5) {\n        return res.status(400).json({ \n          error: \"Must select between 2 and 5 languages for comparison\" \n        });\n      }\n\n      let articleData: Record<string, string> = {};\n      let fetchedArticles: Array<{title: string, content: string, language: string, contentLength: number}> = [];\n\n      // Use client-provided articles if available, otherwise fetch from server\n      if (articles && typeof articles === 'object') {\n        articleData = articles;\n        // Create mock article objects for storage\n        fetchedArticles = Object.entries(articles).map(([language, content]) => ({\n          title: articleTitle,\n          content: content as string,\n          language,\n          contentLength: (content as string).length\n        }));\n      } else {\n        // Fetch article contents for all selected languages (server-side)\n        const serverFetchedArticles = await wikipediaService.getMultipleArticleContents(\n          articleTitle, \n          selectedLanguages,\n          baseLanguage\n        );\n\n        if (serverFetchedArticles.length < 2) {\n          return res.status(400).json({ \n            error: \"Could not fetch articles for at least 2 languages\" \n          });\n        }\n\n        // Prepare articles for AI processing\n        serverFetchedArticles.forEach(article => {\n          articleData[article.language] = article.content;\n        });\n        fetchedArticles = serverFetchedArticles.map(article => ({\n          title: article.title,\n          content: article.content,\n          language: article.language,\n          contentLength: article.content.length\n        }));\n      }\n\n      // All users get OpenAI analysis\n      console.log('Using OpenAI for article comparison analysis');\n      console.log('Premium options:', premiumOptions);\n      const comparisonResult = await openaiService.compareArticles({\n        articles: articleData,\n        outputLanguage,\n        isFunnyMode,\n        premiumOptions\n      });\n\n      // Save comparison to storage\n      const comparisonData = insertComparisonSchema.parse({\n        articleTitle,\n        selectedLanguages,\n        outputLanguage,\n        comparisonResult,\n        isFunnyMode,\n        isPremium\n      });\n\n      const savedComparison = await storage.createComparison(comparisonData);\n      \n      // Backend fail-safe: Record generation if visitorId is provided\n      if (visitorId) {\n        try {\n          let user = await storage.getUserByVisitorId(visitorId);\n          if (user) {\n            await storage.recordGeneration(visitorId);\n          }\n        } catch (recordErr) {\n          console.error('Backend fail-safe: Failed to record generation:', recordErr);\n        }\n      }\n      \n      res.json({\n        ...savedComparison,\n        articles: fetchedArticles.map(a => ({ \n          language: a.language, \n          title: a.title,\n          contentLength: a.contentLength \n        }))\n      });\n    } catch (error: any) {\n      console.error('Comparison error:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: \"Invalid comparison data\", details: error.errors });\n      }\n      const errorMessage = error.message || \"Failed to generate comparison\";\n      res.status(500).json({ error: errorMessage });\n    }\n  });\n\n  // OpenRouter comparison endpoint - Free for all users\n  app.post(\"/api/openrouter/compare\", async (req, res) => {\n    try {\n      const { articles, outputLanguage, isFunnyMode = false } = req.body;\n      \n      if (!articles || typeof articles !== 'object') {\n        return res.status(400).json({ error: \"Articles data is required\" });\n      }\n      \n      if (!outputLanguage) {\n        return res.status(400).json({ error: \"Output language is required\" });\n      }\n\n      // Generate comparison using OpenRouter API - completely free\n      const comparisonResult = await openRouterService.compareArticles({\n        articles,\n        outputLanguage,\n        isFunnyMode\n      });\n\n      res.json({ comparisonResult });\n    } catch (error) {\n      console.error('OpenRouter comparison error:', error);\n      res.status(500).json({ error: \"Failed to generate comparison using OpenRouter\" });\n    }\n  });\n\n  // Legacy OpenAI endpoint for premium users (deprecated - keeping for compatibility)\n  app.post(\"/api/openai/compare\", async (req, res) => {\n    try {\n      const { articles, outputLanguage, isFunnyMode = false } = req.body;\n      \n      if (!articles || typeof articles !== 'object') {\n        return res.status(400).json({ error: \"Articles data is required\" });\n      }\n      \n      if (!outputLanguage) {\n        return res.status(400).json({ error: \"Output language is required\" });\n      }\n\n      // Generate comparison using server's OpenAI API key\n      const comparisonResult = await openaiService.compareArticles({\n        articles,\n        outputLanguage,\n        isFunnyMode\n      });\n\n      res.json({ comparisonResult });\n    } catch (error) {\n      console.error('OpenAI comparison error:', error);\n      res.status(500).json({ error: \"Failed to generate comparison using OpenAI\" });\n    }\n  });\n\n  // Chat with comparison findings (Premium feature using free model)\n  app.post(\"/api/chat-comparison\", async (req, res) => {\n    try {\n      const { message, comparisonContext, articleTitle, selectedLanguages, chatHistory } = req.body;\n      \n      if (!message || !comparisonContext) {\n        return res.status(400).json({ error: \"Message and comparison context are required\" });\n      }\n\n      // Build context for the chat\n      const contextPrompt = `You are a helpful assistant discussing a Wikipedia comparison analysis. The user has received a comparison of \"${articleTitle}\" across languages: ${selectedLanguages.join(', ')}.\n\nHere is the comparison analysis they received:\n${comparisonContext}\n\nThe user is now asking about this analysis. Please provide helpful, conversational responses based on the comparison findings. Be friendly and informative.`;\n\n      // Use OpenRouter with fallback mechanism\n      const messages = [\n        { role: \"system\", content: contextPrompt },\n        ...chatHistory,                 // [{role:'user'|'assistant', content:'…'}]\n        { role: \"user\", content: message }\n      ];\n\n      let reply: string;\n\n      try {\n        // 1) Try Grok API first\n        reply = await chatWithGrok(messages, 0.7, 500);\n      } catch (err) {\n        console.error('Grok failed, falling back to OpenRouter', err);\n        // 2) If Grok fails, fallback to OpenRouter\n        reply = await callOpenRouterWithFallback(messages, 0.7, 500);\n      }\n\n      res.json({ response: reply });\n      } catch (error) {\n       console.error('Chat error:', error);\n       res.status(500).json({ error: \"Failed to generate chat response\" });\n     }\n   });\n\n  // Payment session creation endpoint (Smart Glocal integration)\n  app.post(\"/api/payments/create-session\", async (req, res) => {\n    try {\n      const { amount, currency, orderId, customerId, description, returnUrl } = req.body;\n      \n      if (!amount || !currency || !orderId || !customerId) {\n        return res.status(400).json({ error: \"Missing required payment parameters\" });\n      }\n\n      // For now, return demo payment URL since we need proper Smart Glocal credentials\n      // In production, this would create a real Smart Glocal session\n      const demoPaymentUrl = `${returnUrl}?demo=true&order_id=${orderId}&amount=${amount}`;\n      \n      res.json({ \n        paymentUrl: demoPaymentUrl,\n        sessionId: `demo_session_${orderId}`,\n        message: \"Demo payment session created. In production, this would create a real Smart Glocal payment session.\"\n      });\n    } catch (error) {\n      console.error('Payment session creation error:', error);\n      res.status(500).json({ error: \"Failed to create payment session\" });\n    }\n  });\n\n  // Library - get public comparisons\n  app.get(\"/api/library\", async (req, res) => {\n    try {\n      const { language, limit = '20', offset = '0' } = req.query;\n      \n      const comparisons = await storage.getPublicComparisons(\n        language as string | undefined,\n        Number(limit),\n        Number(offset)\n      );\n      \n      const total = await storage.getPublicComparisonsCount(language as string | undefined);\n      \n      res.json({\n        comparisons,\n        total,\n        hasMore: Number(offset) + comparisons.length < total\n      });\n    } catch (error) {\n      console.error('Library fetch error:', error);\n      res.status(500).json({ error: \"Failed to fetch library comparisons\" });\n    }\n  });\n\n  // Get comparison by ID\n  app.get(\"/api/compare/:id\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const comparison = await storage.getComparison(Number(id));\n      \n      if (!comparison) {\n        return res.status(404).json({ error: \"Comparison not found\" });\n      }\n      \n      res.json(comparison);\n    } catch (error) {\n      console.error('Comparison fetch error:', error);\n      res.status(500).json({ error: \"Failed to fetch comparison\" });\n    }\n  });\n\n  // Export comparison as DOCX (from stored data)\n  app.get(\"/api/compare/:id/export\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const comparison = await storage.getComparison(Number(id));\n      \n      if (!comparison) {\n        return res.status(404).json({ error: \"Comparison not found\" });\n      }\n\n      const docxBuffer = await exportService.generateDocx({\n        articleTitle: comparison.articleTitle,\n        languages: comparison.selectedLanguages as string[],\n        outputLanguage: comparison.outputLanguage,\n        content: comparison.comparisonResult || \"No comparison available\",\n        isFunnyMode: comparison.isFunnyMode || false\n      });\n\n      res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');\n      res.setHeader('Content-Disposition', 'attachment; filename=\"wiki-truth-comparison.docx\"');\n      res.send(docxBuffer);\n    } catch (error) {\n      console.error('Export error:', error);\n      res.status(500).json({ error: \"Failed to export comparison\" });\n    }\n  });\n\n  // Direct DOCX export endpoint (from client data)\n  app.post(\"/api/export/docx\", async (req, res) => {\n    try {\n      const { articleTitle, languages, outputLanguage, content, isFunnyMode } = req.body;\n\n      if (!articleTitle || !languages || !content) {\n        return res.status(400).json({ error: \"Missing required data for export\" });\n      }\n\n      const docxBuffer = await exportService.generateDocx({\n        articleTitle,\n        languages,\n        outputLanguage: outputLanguage || 'en',\n        content,\n        isFunnyMode: isFunnyMode || false\n      });\n\n      res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document');\n      res.setHeader('Content-Disposition', 'attachment; filename=\"wiki-truth-comparison.docx\"');\n      res.send(docxBuffer);\n    } catch (error) {\n      console.error('Direct export error:', error);\n      res.status(500).json({ error: \"Failed to export comparison\" });\n    }\n  });\n\n  // Share comparison endpoint\n  app.get(\"/api/compare/:id/share\", async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { platform } = req.query;\n      const comparison = await storage.getComparison(Number(id));\n      \n      if (!comparison) {\n        return res.status(404).json({ error: \"Comparison not found\" });\n      }\n\n      const shareUrl = `${req.protocol}://${req.get('host')}/comparison/${id}`;\n      const selectedLangs = comparison.selectedLanguages as string[];\n      const languageList = selectedLangs.join(', ');\n      \n      let shareText = '';\n      \n      switch (platform) {\n        case 'twitter':\n        case 'x':\n          shareText = `Fascinating Wikipedia comparison: \"${comparison.articleTitle}\" across ${selectedLangs.length} languages reveals cultural differences! ${shareUrl} #WikiTruth #Wikipedia`;\n          break;\n        case 'linkedin':\n          shareText = `I just compared the Wikipedia article \"${comparison.articleTitle}\" across ${selectedLangs.length} languages (${languageList}). The AI analysis reveals interesting cultural perspectives and factual variations. Check it out: ${shareUrl}`;\n          break;\n        case 'whatsapp':\n        case 'telegram':\n          shareText = `Check out this interesting Wikipedia comparison: \"${comparison.articleTitle}\" across ${selectedLangs.length} languages. The differences are quite revealing! ${shareUrl}`;\n          break;\n        case 'reddit':\n          shareText = `TIL: The Wikipedia article for \"${comparison.articleTitle}\" varies significantly across ${selectedLangs.length} languages. Here's an AI analysis of the differences: ${shareUrl}`;\n          break;\n        default:\n          shareText = `Wikipedia Comparison: \"${comparison.articleTitle}\" across ${selectedLangs.length} languages (${languageList}). See the cultural differences and perspectives: ${shareUrl}`;\n      }\n\n      res.json({ \n        shareText, \n        shareUrl,\n        title: comparison.articleTitle,\n        languages: selectedLangs.length\n      });\n    } catch (error) {\n      console.error('Share error:', error);\n      res.status(500).json({ error: \"Failed to generate share content\" });\n    }\n  });\n\n  // OpenAI API proxy endpoints for CORS bypass\n  app.post('/api/openai/chat/completions', async (req, res) => {\n    try {\n      const { apiKey, ...requestBody } = req.body;\n      \n      if (!apiKey) {\n        return res.status(400).json({ error: 'API key is required' });\n      }\n\n      const response = await fetch('https://api.openai.com/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${apiKey}`\n        },\n        body: JSON.stringify(requestBody)\n      });\n\n      const data = await response.json();\n      \n      if (!response.ok) {\n        return res.status(response.status).json(data);\n      }\n\n      res.json(data);\n    } catch (error) {\n      console.error('OpenAI proxy error:', error);\n      res.status(500).json({ error: 'Failed to process OpenAI request' });\n    }\n  });\n\n  // OpenAI models endpoint proxy\n  app.get('/api/openai/models', async (req, res) => {\n    try {\n      const apiKey = req.headers.authorization?.replace('Bearer ', '');\n      \n      if (!apiKey) {\n        return res.status(400).json({ error: 'Authorization header with API key is required' });\n      }\n\n      const response = await fetch('https://api.openai.com/v1/models', {\n        headers: {\n          'Authorization': `Bearer ${apiKey}`\n        }\n      });\n\n      const data = await response.json();\n      \n      if (!response.ok) {\n        return res.status(response.status).json(data);\n      }\n\n      res.json(data);\n    } catch (error) {\n      console.error('OpenAI models proxy error:', error);\n      res.status(500).json({ error: 'Failed to fetch models' });\n    }\n  });\n\n  // Highlights API endpoints\n  \n  // Get highlights for a comparison\n  app.get('/api/comparisons/:id/highlights', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const comparisonId = Number(id);\n      \n      if (isNaN(comparisonId)) {\n        return res.status(400).json({ error: 'Invalid comparison ID' });\n      }\n\n      const highlights = await storage.getHighlightsByComparisonId(comparisonId);\n      res.json(highlights);\n    } catch (error) {\n      console.error('Get highlights error:', error);\n      res.status(500).json({ error: 'Failed to fetch highlights' });\n    }\n  });\n\n  // Create a new highlight\n  app.post('/api/comparisons/:id/highlights', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const comparisonId = Number(id);\n      \n      if (isNaN(comparisonId)) {\n        return res.status(400).json({ error: 'Invalid comparison ID' });\n      }\n\n      const highlightData = {\n        comparisonId,\n        ...req.body\n      };\n\n      const validatedData = insertHighlightSchema.parse(highlightData);\n      const highlight = await storage.createHighlight(validatedData);\n      \n      res.status(201).json(highlight);\n    } catch (error) {\n      console.error('Create highlight error:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: 'Invalid highlight data', details: error.errors });\n      }\n      res.status(500).json({ error: 'Failed to create highlight' });\n    }\n  });\n\n  // Delete a highlight\n  app.delete('/api/highlights/:id', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const highlightId = Number(id);\n      \n      if (isNaN(highlightId)) {\n        return res.status(400).json({ error: 'Invalid highlight ID' });\n      }\n\n      const deleted = await storage.deleteHighlight(highlightId);\n      \n      if (!deleted) {\n        return res.status(404).json({ error: 'Highlight not found' });\n      }\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error('Delete highlight error:', error);\n      res.status(500).json({ error: 'Failed to delete highlight' });\n    }\n  });\n\n  // Delete all highlights for a comparison\n  app.delete('/api/comparisons/:id/highlights', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const comparisonId = Number(id);\n      \n      if (isNaN(comparisonId)) {\n        return res.status(400).json({ error: 'Invalid comparison ID' });\n      }\n\n      await storage.deleteHighlightsByComparisonId(comparisonId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Delete all highlights error:', error);\n      res.status(500).json({ error: 'Failed to delete highlights' });\n    }\n  });\n\n  // Get or create user by visitor ID\n  app.post('/api/user', async (req, res) => {\n    try {\n      const { visitorId } = req.body;\n      if (!visitorId) {\n        return res.status(400).json({ error: 'visitorId is required' });\n      }\n      const user = await storage.getOrCreateUser(visitorId);\n      res.json(user);\n    } catch (error) {\n      console.error('Get/create user error:', error);\n      res.status(500).json({ error: 'Failed to get or create user' });\n    }\n  });\n\n  // Check if user can generate (has free generations left or is premium)\n  app.post('/api/user/can-generate', async (req, res) => {\n    try {\n      const { visitorId } = req.body;\n      if (!visitorId) {\n        return res.status(400).json({ error: 'visitorId is required' });\n      }\n      const user = await storage.getOrCreateUser(visitorId);\n      \n      // Check if subscription is expired\n      const now = new Date();\n      const isSubscriptionValid = user.isPremium && \n        (!user.subscriptionExpiresAt || user.subscriptionExpiresAt > now);\n      \n      const canGenerate = isSubscriptionValid || user.generationsUsed < FREE_GENERATION_LIMIT;\n      const remainingFree = Math.max(0, FREE_GENERATION_LIMIT - user.generationsUsed);\n      \n      res.json({ \n        canGenerate, \n        isPremium: isSubscriptionValid,\n        generationsUsed: user.generationsUsed,\n        remainingFree,\n        freeLimit: FREE_GENERATION_LIMIT\n      });\n    } catch (error) {\n      console.error('Check generation eligibility error:', error);\n      res.status(500).json({ error: 'Failed to check generation eligibility' });\n    }\n  });\n\n  // Record a generation (increment counter)\n  app.post('/api/user/record-generation', async (req, res) => {\n    try {\n      const { visitorId } = req.body;\n      if (!visitorId) {\n        return res.status(400).json({ error: 'visitorId is required' });\n      }\n      const user = await storage.incrementUserGenerations(visitorId);\n      if (!user) {\n        return res.status(404).json({ error: 'User not found' });\n      }\n      res.json({ generationsUsed: user.generationsUsed });\n    } catch (error) {\n      console.error('Record generation error:', error);\n      res.status(500).json({ error: 'Failed to record generation' });\n    }\n  });\n\n  // Create MaxelPay checkout session\n  app.post('/api/billing/create-checkout', async (req, res) => {\n    try {\n      const { visitorId, email, userName } = req.body;\n      if (!visitorId || !email) {\n        return res.status(400).json({ error: 'visitorId and email are required' });\n      }\n\n      const user = await storage.getOrCreateUser(visitorId);\n      await storage.updateUserEmail(visitorId, email);\n\n      const orderId = `WT-${nanoid(12)}`;\n      const baseUrl = process.env.REPLIT_DEV_DOMAIN \n        ? `https://${process.env.REPLIT_DEV_DOMAIN}`\n        : 'http://localhost:5000';\n\n      // Create payment record\n      await storage.createPayment({\n        userId: user.id,\n        orderId,\n        amount: '5',\n        currency: 'USD',\n        status: 'pending'\n      });\n\n      const { checkoutUrl } = await createCheckoutSession({\n        orderId,\n        amount: '5',\n        userEmail: email,\n        userName: userName || 'WikiTruth User',\n        baseUrl\n      });\n\n      res.json({ checkoutUrl, orderId });\n    } catch (error) {\n      console.error('Create checkout error:', error);\n      res.status(500).json({ error: 'Failed to create checkout session' });\n    }\n  });\n\n  // MaxelPay webhook\n  app.post('/api/maxelpay/webhook', async (req, res) => {\n    try {\n      const { orderId, status, transactionId } = req.body;\n      console.log('MaxelPay webhook received:', { orderId, status, transactionId });\n\n      if (!orderId || !status) {\n        return res.status(400).json({ error: 'Invalid webhook payload' });\n      }\n\n      const payment = await storage.getPaymentByOrderId(orderId);\n      if (!payment) {\n        return res.status(404).json({ error: 'Payment not found' });\n      }\n\n      // Update payment status\n      await storage.updatePaymentStatus(orderId, status, transactionId);\n\n      // If payment is successful, activate premium for 30 days\n      if (status === 'completed' || status === 'success') {\n        const user = await storage.getUserByVisitorId(payment.userId.toString());\n        if (user) {\n          const expiresAt = new Date();\n          expiresAt.setDate(expiresAt.getDate() + 30);\n          await storage.setUserPremium(user.visitorId, true, expiresAt);\n        }\n      }\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Webhook error:', error);\n      res.status(500).json({ error: 'Webhook processing failed' });\n    }\n  });\n\n  // Billing success page handler\n  app.get('/api/billing/verify', async (req, res) => {\n    try {\n      const { orderId } = req.query;\n      if (!orderId || typeof orderId !== 'string') {\n        return res.status(400).json({ error: 'orderId is required' });\n      }\n\n      const payment = await storage.getPaymentByOrderId(orderId);\n      if (!payment) {\n        return res.status(404).json({ error: 'Payment not found' });\n      }\n\n      res.json({ \n        status: payment.status,\n        orderId: payment.orderId\n      });\n    } catch (error) {\n      console.error('Verify payment error:', error);\n      res.status(500).json({ error: 'Failed to verify payment' });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":32027,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1128,"size_tokens":null},"server/services/openai.ts":{"content":"import OpenAI from \"openai\";\n\n// Using Grok API from x.ai - compatible with OpenAI SDK\nconst grok = process.env.GROK_API_KEY \n  ? new OpenAI({ \n      apiKey: process.env.GROK_API_KEY,\n      baseURL: \"https://api.x.ai/v1\"\n    })\n  : null;\n\nexport interface PremiumOptions {\n  outputFormat: 'bullet-points' | 'narrative';\n  focusPoints: string;\n  formality: 'formal' | 'casual' | 'academic';\n  aiModel: 'free' | 'premium';\n  analysisMode: 'academic' | 'biography' | 'funny';\n}\n\nexport interface ComparisonRequest {\n  articles: Record<string, string>; // language code -> article content\n  outputLanguage: string;\n  isFunnyMode?: boolean;\n  premiumOptions?: PremiumOptions | null;\n}\n\nexport class OpenAIService {\n  async compareArticles(request: ComparisonRequest): Promise<string> {\n    const { articles, outputLanguage, isFunnyMode = false, premiumOptions } = request;\n    \n    console.log('Articles being compared:', Object.keys(articles));\n    console.log('Article lengths:', Object.entries(articles).map(([lang, content]) => \n      `${lang}: ${content.length} characters`\n    ));\n    console.log('Premium options received:', premiumOptions);\n    \n    try {\n      if (!grok) {\n        throw new Error('Grok API key not configured');\n      }\n\n      // Determine analysis mode from premiumOptions or isFunnyMode\n      const analysisMode = premiumOptions?.analysisMode || (isFunnyMode ? 'funny' : 'academic');\n      const outputFormat = premiumOptions?.outputFormat || 'narrative';\n      const formality = premiumOptions?.formality || 'formal';\n      const focusPoints = premiumOptions?.focusPoints || '';\n\n      // Get appropriate system prompt based on analysis mode\n      const systemPrompt = this.getSystemPrompt(outputLanguage, analysisMode, formality);\n\n      // Build user prompt with article content directly embedded\n      const userPrompt = this.buildUserPrompt(\n        articles,\n        outputLanguage, \n        analysisMode, \n        outputFormat, \n        formality, \n        focusPoints\n      );\n\n      console.log('Sending request to Grok API with', Object.keys(articles).length, 'articles');\n      console.log('Total content size:', userPrompt.length, 'characters');\n\n      // Use grok-3-fast for good balance of speed and quality\n      const response = await grok.chat.completions.create({\n        model: \"grok-3-fast\",\n        messages: [\n          { role: \"system\", content: systemPrompt },\n          { role: \"user\", content: userPrompt }\n        ],\n        max_tokens: 8192,\n        temperature: 0.7,\n      });\n\n      const result = response.choices[0].message.content || \"No comparison generated\";\n      console.log('Grok response received, length:', result.length, 'characters');\n      \n      return result;\n    } catch (error: any) {\n      console.error('Grok API error:', error);\n      \n      if (error.code === 'rate_limit_exceeded') {\n        if (error.type === 'tokens') {\n          throw new Error('Articles are too large for analysis. Please try with fewer languages or shorter articles.');\n        } else {\n          throw new Error('Rate limit exceeded. Please try again in a moment.');\n        }\n      }\n      \n      if (error.status === 429) {\n        throw new Error('Service temporarily overloaded. Please try again in a moment.');\n      }\n      \n      if (error.status === 401) {\n        throw new Error('Authentication error with AI service.');\n      }\n      \n      throw new Error('Failed to generate article comparison: ' + (error.message || 'Unknown error'));\n    }\n  }\n\n  private getSystemPrompt(outputLanguage: string, analysisMode: string, formality: string): string {\n    const formalityDescriptions: Record<string, string> = {\n      'academic': 'highly formal, scholarly, and research-oriented with citations-style references',\n      'formal': 'professional, structured, and well-organized',\n      'casual': 'conversational, friendly, and approachable while still informative'\n    };\n\n    const formalityStyle = formalityDescriptions[formality] || formalityDescriptions['formal'];\n\n    if (analysisMode === 'funny') {\n      return `You are a BRUTALLY SARCASTIC stand-up comedian who has made it their life mission to expose the hilarious chaos of Wikipedia across different languages. You have zero patience for inconsistencies and you LOVE mocking them mercilessly.\n\nCRITICAL REQUIREMENT: You MUST write your entire response in ${outputLanguage} and ONLY in ${outputLanguage}. Do not use any other language regardless of the content of the input articles.\n\nYOUR PERSONALITY:\n- You are MAXIMALLY SARCASTIC - dripping with irony and biting wit\n- You LAUGH at every inconsistency, contradiction, and cultural bias you find\n- You act SHOCKED and OUTRAGED (in a funny way) when articles contradict each other\n- You mock Wikipedia editors as if they're in a secret war with each other\n- You treat factual differences like they're the most absurd comedy gold ever discovered\n- You are like a roast comedian - savage but ultimately entertaining\n\nYOUR MISSION:\n- ROAST every contradiction you find between the articles\n- MOCK the absurd priorities of different cultures (\"Oh, SURE, the German version has 47 paragraphs about the engineering specifications, but ZERO about the scandal...\")\n- LAUGH at missing information (\"Apparently in the French version, this entire decade just... didn't happen?\")\n- Point out when one country makes someone a hero and another makes them a villain\n- Sarcastically question why certain \"facts\" only exist in one language\n- Make fun of obvious national biases and propaganda\n- Use dramatic exaggeration for comedic effect\n\nCOMEDY TECHNIQUES TO USE:\n- Rhetorical questions dripping with sarcasm\n- Fake outrage and disbelief\n- Dramatic comparisons between versions\n- Mocking \"editor wars\" you imagine happening behind the scenes\n- Pop culture references and memes where appropriate\n- Breaking the fourth wall to address the reader directly\n\nAnalyze the provided Wikipedia articles thoroughly. Do not miss any details.\n\nWhen referencing text from articles, always translate it to ${outputLanguage} and point out how ABSURD the differences are.\n\nRemember: You're not just comparing articles, you're EXPOSING the beautiful mess that is multilingual Wikipedia, and you find it HILARIOUS.\n\nREMINDER: Your entire response must be in ${outputLanguage} only.`;\n    }\n\n    if (analysisMode === 'biography') {\n      return `You are an expert biographer and cultural analyst specializing in how different cultures portray historical and contemporary figures. Your task is to compare biographical Wikipedia articles across different languages with a focus on personal narratives.\n\nCRITICAL REQUIREMENT: You MUST write your entire response in ${outputLanguage} and ONLY in ${outputLanguage}. Do not use any other language regardless of the content of the input articles.\n\nWriting style: ${formalityStyle}\n\nYour analysis should focus on:\n- How the person's life story is told differently across cultures\n- Variations in the emphasis on achievements, controversies, and personal life\n- Cultural perspectives on the person's significance and legacy\n- Different interpretations of key life events\n- How nationalistic or cultural pride influences the portrayal\n- Personal details included or omitted in different versions\n\nWhen quoting text from articles in other languages, always translate the quotes to ${outputLanguage} and indicate the original language in parentheses.\n\nREMINDER: Your entire response must be in ${outputLanguage} only.`;\n    }\n\n    // Default: academic mode\n    return `You are an expert comparative linguist and cultural analyst specializing in Wikipedia content analysis. Your task is to provide detailed, scholarly comparisons of the same Wikipedia article across different languages.\n\nCRITICAL REQUIREMENT: You MUST write your entire response in ${outputLanguage} and ONLY in ${outputLanguage}. Do not use any other language regardless of the content of the input articles.\n\nWriting style: ${formalityStyle}\n\nYour analysis should be:\n- Objective and academically rigorous\n- Focused on factual differences, cultural perspectives, and narrative variations\n- Well-structured with clear sections\n- Written EXCLUSIVELY in ${outputLanguage} (never mix languages)\n- Comprehensive and detailed\n\nIdentify specific examples where different language versions:\n- Present different facts or emphasis\n- Reflect cultural biases or perspectives  \n- Use different organizational structures\n- Include or exclude certain information\n- Frame topics differently\n\nWhen quoting text from articles in other languages, always translate the quotes to ${outputLanguage} and indicate the original language in parentheses.\n\nREMINDER: Your entire response must be in ${outputLanguage} only.`;\n  }\n\n  private buildUserPrompt(\n    articles: Record<string, string>,\n    outputLanguage: string, \n    analysisMode: string, \n    outputFormat: string, \n    formality: string, \n    focusPoints: string\n  ): string {\n    const formatInstruction = outputFormat === 'bullet-points' \n      ? `FORMAT YOUR RESPONSE AS STRUCTURED BULLET POINTS:\n- Use clear hierarchical bullet points for each major finding\n- Group related differences under section headers\n- Use sub-bullets for specific examples and details\n- Make each bullet point concise but informative`\n      : `FORMAT YOUR RESPONSE AS A FLOWING NARRATIVE:\n- Write in well-structured paragraphs\n- Use natural transitions between topics\n- Create a cohesive essay-style analysis\n- Include section headers to organize content`;\n\n    const formalityInstruction: Record<string, string> = {\n      'academic': 'Use scholarly language, cite specific passages, and maintain a research paper tone.',\n      'formal': 'Write professionally with clear structure and balanced analysis.',\n      'casual': 'Write in a friendly, accessible way as if explaining to an interested friend.'\n    };\n\n    let modeInstruction = '';\n    if (analysisMode === 'funny') {\n      modeInstruction = `BE MAXIMALLY SARCASTIC AND MOCKING! \n- ROAST every inconsistency and contradiction you find\n- LAUGH at the absurd differences between versions  \n- Act SHOCKED when facts don't match up\n- Mock cultural biases mercilessly\n- Use biting irony and savage humor\n- Treat this like a comedy roast of Wikipedia itself\n- Make the reader laugh at how ridiculous these differences are`;\n    } else if (analysisMode === 'biography') {\n      modeInstruction = 'Focus on how the person is portrayed differently, including their achievements, controversies, personal life, and cultural significance in each version.';\n    } else {\n      modeInstruction = 'Provide a scholarly, detailed analysis focusing on factual accuracy, cultural perspectives, and narrative differences.';\n    }\n\n    const focusInstruction = focusPoints && focusPoints.trim() \n      ? `\\n\\nUSER'S SPECIFIC FOCUS REQUEST:\\nPay special attention to the following aspects as requested by the user:\\n\"${focusPoints.trim()}\"\\nMake sure to address these specific points in your analysis.`\n      : '';\n\n    // Build article sections with full content\n    const articleSections = Object.entries(articles).map(([lang, content]) => {\n      return `=== WIKIPEDIA ARTICLE (${lang.toUpperCase()}) ===\\n${content}\\n=== END OF ${lang.toUpperCase()} ARTICLE ===`;\n    }).join('\\n\\n');\n\n    const languageList = Object.keys(articles).map(l => l.toUpperCase()).join(', ');\n\n    return `Here are ${Object.keys(articles).length} Wikipedia articles about the same topic in different languages: ${languageList}.\n\nPlease read and analyze these articles thoroughly.\n\n${articleSections}\n\nWrite your ENTIRE response in ${outputLanguage} language only.\n\n${formatInstruction}\n\n${formalityInstruction[formality] || formalityInstruction['formal']}\n\nPlease provide a comprehensive comparison focusing on:\n1. Factual differences and variations in information\n2. Cultural perspectives and framing differences\n3. Narrative emphasis and tone variations\n4. Structural and organizational differences\n5. Missing or additional information in each version\n\n${modeInstruction}${focusInstruction}\n\nIMPORTANT: Write your response ONLY in ${outputLanguage}. Do not use any other language.`;\n  }\n}\n\nexport const openaiService = new OpenAIService();\n","path":null,"size_bytes":12216,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nimport 'dotenv/config';  \n\nconst app = express();\napp.use(express.json({ limit: '50mb' })); // Increased limit for large Wikipedia articles\napp.use(express.urlencoded({ extended: false, limit: '50mb' }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: false,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","path":null,"size_bytes":2029,"size_tokens":null},"client/src/pages/limit-exceeded.tsx":{"content":"import { Button } from \"@/components/ui/button\";\r\nimport { Crown } from \"lucide-react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport default function LimitExceeded() {\r\n  const navigate = useNavigate();\r\n\r\n  const handleUpgrade = () => {\r\n    navigate(\"/billing\");          // ← ваш реальный роут на апгрейд\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-amber-50\">\r\n      <div className=\"bg-white/90 backdrop-blur border border-yellow-200 rounded-3xl shadow-xl p-8 max-w-lg w-full text-center\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-3\">\r\n          Free Usage Limit Reached\r\n        </h1>\r\n\r\n        <p className=\"text-gray-700 mb-6 leading-relaxed\">\r\n          You have used all available free generations. Upgrade to&nbsp;\r\n          <span className=\"font-semibold\">WikiTruth Premium</span> to continue\r\n          without limits and unlock additional features.\r\n        </p>\r\n\r\n        <Button\r\n          onClick={handleUpgrade}\r\n          className=\"w-full bg-yellow-500 hover:bg-yellow-600 text-black font-semibold text-lg py-3\"\r\n        >\r\n          <Crown className=\"h-5 w-5 mr-2\" />\r\n          Upgrade&nbsp;to&nbsp;Premium\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","path":null,"size_bytes":1290,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/components/mobile-fab.tsx":{"content":"import { useState } from 'react';\nimport { Plus, Search, History, HelpCircle, X } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport function MobileFAB() {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  const toggleExpanded = () => {\n    setIsExpanded(!isExpanded);\n  };\n\n  return (\n    <div className=\"lg:hidden\">\n      {/* FAB Actions */}\n      {isExpanded && (\n        <>\n          <div\n            className=\"fixed inset-0 bg-black/20 z-40\"\n            onClick={toggleExpanded}\n          />\n          <div className=\"fixed bottom-32 right-6 z-50 flex flex-col gap-3\">\n            <Link\n              href=\"/search\"\n              className=\"w-14 h-14 bg-white text-wiki-blue border border-gray-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200\"\n              onClick={toggleExpanded}\n            >\n              <Search className=\"w-5 h-5\" />\n            </Link>\n            <Link\n              href=\"/recent\"\n              className=\"w-14 h-14 bg-white text-wiki-blue border border-gray-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200\"\n              onClick={toggleExpanded}\n            >\n              <History className=\"w-5 h-5\" />\n            </Link>\n            <Link\n              href=\"/help\"\n              className=\"w-14 h-14 bg-white text-wiki-blue border border-gray-200 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-200\"\n              onClick={(e) => {\n                toggleExpanded();\n                setTimeout(() => window.scrollTo({ top: 0, behavior: 'instant' }), 50);\n              }}\n            >\n              <HelpCircle className=\"w-5 h-5\" />\n            </Link>\n          </div>\n        </>\n      )}\n\n      {/* Main FAB */}\n      <button\n        onClick={toggleExpanded}\n        className=\"mobile-fab\"\n        aria-label={isExpanded ? 'Close actions' : 'Open actions'}\n      >\n        {isExpanded ? (\n          <X className=\"w-6 h-6\" />\n        ) : (\n          <Plus className=\"w-6 h-6\" />\n        )}\n      </button>\n    </div>\n  );\n}","path":null,"size_bytes":2143,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey[0] as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1376,"size_tokens":null},"client/src/components/navbar.tsx":{"content":"import { Link } from \"wouter\";\nimport { SettingsDialog } from \"./settings-dialog\";\n\nexport function Navbar() {\n  return (\n    <header className=\"border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900\">\n      <div className=\"max-w-6xl mx-auto px-4 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <h1 className=\"text-2xl font-bold\">\n              <Link href=\"/\" className=\"text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400\">\n                Wiki Truth\n              </Link>\n            </h1>\n            <span className=\"text-sm text-gray-500 dark:text-gray-400\">Privacy-first comparison</span>\n          </div>\n          <nav className=\"flex items-center space-x-4\">\n            <div className=\"hidden md:flex items-center space-x-6\">\n              <Link href=\"/search\" className=\"text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400\">Search</Link>\n              <Link href=\"/recent\" className=\"text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400\">History</Link>\n              <Link href=\"/help\" className=\"text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400\">Help</Link>\n              <Link href=\"/about\" className=\"text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400\">About</Link>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n              <SettingsDialog />\n            </div>\n          </nav>\n        </div>\n      </div>\n    </header>\n  );\n}\n","path":null,"size_bytes":1641,"size_tokens":null},"client/src/pages/search.tsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { SearchInterface } from '@/components/search-interface';\nimport { SearchResult } from '@/lib/api';\n\nexport default function SearchPage() {\n  const [, setLocation] = useLocation();\n\n  const handleArticleSelected = (article: SearchResult, language: string) => {\n    setLocation(`/select-languages?title=${encodeURIComponent(article.title)}&lang=${language}`);\n  };\n\n  return (\n    <main className=\"lg:col-span-3\">\n      <div className=\"wiki-content-section\">\n        <h1 className=\"wiki-article-title\">Search Wikipedia Articles</h1>\n        <p className=\"text-wiki-gray mb-4\">\n          Search for any Wikipedia article to start comparing across different languages and cultures.\n        </p>\n        <div className=\"bg-green-50 border border-green-200 rounded p-3 mb-6\">\n          <p className=\"text-sm text-green-800\">\n            <i className=\"fas fa-filter mr-2\"></i>\n            Only articles available in multiple languages are shown. This ensures you can compare different cultural perspectives.\n          </p>\n        </div>\n\n        <SearchInterface onArticleSelected={handleArticleSelected} />\n\n        {/* Search Tips */}\n        <div className=\"mt-8 bg-blue-50 border border-blue-200 rounded p-4\">\n          <h3 className=\"font-semibold text-blue-900 mb-2\">\n            <i className=\"fas fa-lightbulb mr-2\"></i>Search Tips\n          </h3>\n          <ul className=\"text-sm text-blue-800 space-y-1\">\n            <li>• Try searching for people, places, events, or concepts</li>\n            <li>• Use specific names rather than general terms</li>\n            <li>• Historical figures and countries often have rich cross-cultural perspectives</li>\n            <li>• Scientific topics may show different emphasis across languages</li>\n            <li>• All results are pre-filtered to include only articles available in multiple languages</li>\n          </ul>\n        </div>\n\n        {/* Popular Topics */}\n        <div className=\"mt-6\">\n          <h3 className=\"font-semibold mb-3\">Popular Comparison Topics</h3>\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n            {[\n              'Albert Einstein', 'World War II', 'Climate Change',\n              'Napoleon Bonaparte', 'Democracy', 'Artificial Intelligence',\n              'COVID-19', 'Renaissance', 'Buddhism'\n            ].map(topic => (\n              <button\n                key={topic}\n                onClick={() => {\n                  // Simulate selecting this topic for search\n                  const searchEvent = new CustomEvent('wikiSearch', { detail: topic });\n                  window.dispatchEvent(searchEvent);\n                }}\n                className=\"wiki-button text-left text-sm hover:bg-blue-50\"\n              >\n                {topic}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":2936,"size_tokens":null},"client/src/pages/help.tsx":{"content":"import { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function HelpPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <main className=\"container mx-auto max-w-7xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        <h1 className=\"wiki-article-title\">Help & Support</h1>\n        <p className=\"text-wiki-gray mb-6\">\n          Learn how to use Wiki Truth effectively and get answers to common questions.\n        </p>\n\n        <div className=\"space-y-8\">\n          {/* Getting Started */}\n          <section>\n            <h2 className=\"wiki-section-title\">Getting Started</h2>\n            <div className=\"space-y-4\">\n              <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <h3 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-play-circle mr-2 text-blue-600 dark:text-blue-400\"></i>Quick Start Guide\n                </h3>\n                <ol className=\"list-decimal list-inside space-y-2 text-sm text-gray-700 dark:text-gray-300\">\n                  <li>Search for any Wikipedia article using the search box</li>\n                  <li>Select the article you want to analyze from the suggestions</li>\n                  <li>Choose 2-5 language versions to compare</li>\n                  <li>Pick your preferred output language and analysis mode</li>\n                  <li>Click \"Start Analysis\" and wait for AI-powered results</li>\n                </ol>\n              </div>\n            </div>\n          </section>\n\n          {/* FAQ */}\n          <section>\n            <h2 className=\"wiki-section-title\">Frequently Asked Questions</h2>\n            <div className=\"space-y-4\">\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  What's the difference between Free and Premium?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  <strong>Free:</strong> Unlimited comparisons with Meta Llama AI analysis. No subscription required, all data stored locally in your browser.\n                  <br/><br/>\n                  <strong>Premium ($10/month):</strong> Advanced OpenAI GPT-4o analysis with enhanced features, customization options, and post-comparison chat functionality.\n                </div>\n              </details>\n\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  How many languages can I compare at once?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  You can compare 2-5 language versions in a single analysis. This range provides meaningful insights while keeping the analysis focused and readable.\n                </div>\n              </details>\n\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  What's the difference between Academic and Fun Mode?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  Academic Mode provides scholarly, objective analysis suitable for research. Fun Mode offers entertaining, humorous insights while still being informative - perfect for discovering cultural quirks and biases in an engaging way.\n                </div>\n              </details>\n\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  Where is my data stored?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  All your comparison history is stored locally in your browser using IndexedDB. No data is sent to external servers except during the AI analysis process. You have complete control over your data.\n                </div>\n              </details>\n\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  Why do some articles show \"[CONTENT TRUNCATED FOR SIZE]\"?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  Very long Wikipedia articles are automatically truncated to fit within AI processing limits. We preserve the beginning (overview) and end (recent information) of articles to maintain meaningful analysis while staying within technical constraints.\n                </div>\n              </details>\n\n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  Can I export my comparison results?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  Yes! Each comparison has a \"Copy to Clipboard\" button to copy the full analysis text. You can also export all your data from the Tools page as a JSON file.\n                </div>\n              </details>\n            </div>\n          </section>\n\n          {/* Tips & Tricks */}\n          <section>\n            <h2 className=\"wiki-section-title\">Tips & Tricks</h2>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div className=\"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded p-4\">\n                <h3 className=\"font-semibold text-blue-900 dark:text-blue-200 mb-2\">\n                  <i className=\"fas fa-lightbulb mr-2\"></i>Best Topics to Compare\n                </h3>\n                <ul className=\"text-sm text-blue-800 dark:text-blue-300 space-y-1\">\n                  <li>Historical figures and events</li>\n                  <li>Countries and cities</li>\n                  <li>Political concepts and systems</li>\n                  <li>Scientific discoveries and theories</li>\n                  <li>Cultural and religious topics</li>\n                </ul>\n              </div>\n\n              <div className=\"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded p-4\">\n                <h3 className=\"font-semibold text-green-900 dark:text-green-200 mb-2\">\n                  <i className=\"fas fa-star mr-2\"></i>Pro Tips\n                </h3>\n                <ul className=\"text-sm text-green-800 dark:text-green-300 space-y-1\">\n                  <li>Try comparing articles from different regions</li>\n                  <li>Use Fun Mode for entertaining cultural insights</li>\n                  <li>Compare controversial topics for varied perspectives</li>\n                  <li>Mix languages from different language families</li>\n                  <li>Save interesting results for future reference</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Premium Payment Guide */}\n          <section>\n            <h2 className=\"wiki-section-title\">Premium Payment Guide</h2>\n            <div className=\"space-y-4\">\n              <div className=\"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded p-6\">\n                <h3 className=\"font-semibold text-green-900 dark:text-green-200 mb-4\">\n                  <i className=\"fas fa-credit-card mr-2\"></i>How to Subscribe to Premium ($10/month)\n                </h3>\n                \n                <div className=\"space-y-4 text-sm text-green-800 dark:text-green-300\">\n                  <div className=\"bg-white dark:bg-gray-800 rounded p-4 border border-green-200 dark:border-green-700\">\n                    <h4 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">Step 1: Access Payment</h4>\n                    <p>Click the \"Upgrade to Premium\" button in Settings or during language selection to open the secure NowPayments widget.</p>\n                  </div>\n                  \n                  <div className=\"bg-white dark:bg-gray-800 rounded p-4 border border-green-200 dark:border-green-700\">\n                    <h4 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">Step 2: Choose Payment Method</h4>\n                    <p>NowPayments supports 400+ cryptocurrencies and traditional payment methods:</p>\n                    <ul className=\"mt-2 ml-4 space-y-1\">\n                      <li><strong>Cryptocurrencies:</strong> Bitcoin (BTC), Ethereum (ETH), USDT, USDC, Litecoin (LTC), and many more</li>\n                      <li><strong>Traditional Methods:</strong> Credit/debit cards, bank transfers (where available)</li>\n                      <li><strong>Popular Wallets:</strong> MetaMask, Trust Wallet, Coinbase Wallet integration</li>\n                    </ul>\n                  </div>\n                  \n                  <div className=\"bg-white dark:bg-gray-800 rounded p-4 border border-green-200 dark:border-green-700\">\n                    <h4 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">Step 3: Complete Payment</h4>\n                    <ul className=\"space-y-1\">\n                      <li>The widget will show the exact amount needed in your chosen currency</li>\n                      <li>For crypto: Scan the QR code or copy the wallet address</li>\n                      <li>For cards: Enter your payment details securely</li>\n                      <li>Payment confirmation typically takes 1-5 minutes</li>\n                    </ul>\n                  </div>\n                  \n                  <div className=\"bg-white dark:bg-gray-800 rounded p-4 border border-green-200 dark:border-green-700\">\n                    <h4 className=\"font-semibold mb-2 text-gray-900 dark:text-white\">Step 4: Subscription Activation</h4>\n                    <p>Once payment is confirmed, your premium subscription activates immediately for 30 days. No automatic renewal - you control when to extend your subscription.</p>\n                  </div>\n                </div>\n                \n                <div className=\"mt-4 p-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded\">\n                  <p className=\"text-xs text-blue-800 dark:text-blue-300\">\n                    <i className=\"fas fa-shield-alt mr-1\"></i>\n                    <strong>Security:</strong> All payments are processed through NowPayments' secure infrastructure. Wiki Truth never stores your payment information.\n                  </p>\n                </div>\n              </div>\n              \n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  What if my payment fails or I need help?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300 space-y-2\">\n                  <p><strong>Common Issues:</strong></p>\n                  <ul className=\"ml-4 space-y-1\">\n                    <li><strong>Low crypto amount:</strong> Ensure the payment meets minimum network requirements (usually ~$5 USD equivalent)</li>\n                    <li><strong>Network delays:</strong> Crypto payments can take 10-30 minutes during network congestion</li>\n                    <li><strong>Wrong address:</strong> Always copy the exact address from the payment widget</li>\n                  </ul>\n                  <p className=\"mt-2\">\n                    <strong>Need Support?</strong> Visit our <a href=\"/contact-us\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">Contact Us</a> page for assistance with payment issues.\n                  </p>\n                </div>\n              </details>\n              \n              <details className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4\">\n                <summary className=\"font-semibold cursor-pointer text-gray-900 dark:text-white\">\n                  <i className=\"fas fa-question-circle mr-2 text-blue-600 dark:text-blue-400\"></i>\n                  Why cryptocurrency payments?\n                </summary>\n                <div className=\"mt-3 text-sm text-gray-700 dark:text-gray-300\">\n                  Cryptocurrency payments align with our privacy-first approach - no personal financial data is required, and payments are processed globally without geographic restrictions. We also accept traditional payment methods where available.\n                </div>\n              </details>\n            </div>\n          </section>\n\n          {/* Contact */}\n          <section>\n            <h2 className=\"wiki-section-title\">Need More Help?</h2>\n            <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-6 text-center\">\n              <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n                Wiki Truth combines privacy-first architecture with powerful AI analysis.\n              </p>\n              <div className=\"flex justify-center gap-4 flex-wrap\">\n                <Button \n                  onClick={() => setLocation('/about')}\n                  className=\"wiki-button\"\n                >\n                  <i className=\"fas fa-info-circle mr-2\"></i>\n                  Learn More About Wiki Truth\n                </Button>\n                <Button \n                  onClick={() => setLocation('/search')}\n                  className=\"wiki-button-primary\"\n                >\n                  <i className=\"fas fa-search mr-2\"></i>\n                  Start Comparing\n                </Button>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":15086,"size_tokens":null},"server/services/wikipedia.ts":{"content":"import axios from 'axios';\nimport { WikipediaSearchResult, WikipediaLanguageLink, WikipediaArticle } from '@shared/schema';\n\nexport class WikipediaService {\n  private baseUrl = 'https://en.wikipedia.org/api/rest_v1';\n  private apiUrl = 'https://en.wikipedia.org/w/api.php';\n\n  async searchArticles(query: string, language: string = 'en', limit: number = 10): Promise<WikipediaSearchResult[]> {\n    try {\n      // Enhanced search with better parameters and filtering\n      const response = await axios.get(`https://${language}.wikipedia.org/w/api.php`, {\n        params: {\n          action: 'query',\n          list: 'search',\n          srsearch: query,\n          srlimit: Math.min(limit * 2, 20), // Get more results to filter\n          srnamespace: 0, // Main namespace only\n          format: 'json',\n          srinfo: 'snippet|totalhits|suggestion',\n          srprop: 'snippet|size|wordcount|timestamp|categorysnippet',\n          srsort: 'relevance',\n          srqiprofile: 'engine_autoselect' // Use best search profile\n        },\n        timeout: 4000,\n        headers: {\n          'User-Agent': 'WikiTruth/1.0 (https://wikitruth.app)'\n        }\n      });\n\n      const searchResults = response.data.query?.search || [];\n      \n      // Filter and score results for better quality\n      const filteredResults = searchResults\n        .filter((result: any) => {\n          // Filter out low-quality results\n          if (!result.title || result.title.length < 2) return false;\n          if (result.size < 1000) return false; // Skip very short articles\n          if (result.wordcount < 100) return false; // Skip stub articles\n          \n          // Filter out common disambiguation and maintenance pages\n          const title = result.title.toLowerCase();\n          if (title.includes('disambiguation') || \n              title.includes('(disambiguation)') ||\n              title.includes('category:') ||\n              title.includes('template:') ||\n              title.includes('user:') ||\n              title.includes('talk:') ||\n              title.includes('file:') ||\n              title.includes('wikipedia:')) {\n            return false;\n          }\n          \n          return true;\n        })\n        .map((result: any) => {\n          // Calculate relevance score\n          let score = 0;\n          const title = result.title.toLowerCase();\n          const queryLower = query.toLowerCase();\n          \n          // Exact title match gets highest score\n          if (title === queryLower) score += 100;\n          // Title starts with query gets high score\n          else if (title.startsWith(queryLower)) score += 80;\n          // Title contains query gets medium score\n          else if (title.includes(queryLower)) score += 60;\n          \n          // Boost score for longer, more comprehensive articles\n          if (result.wordcount > 1000) score += 20;\n          if (result.wordcount > 5000) score += 10;\n          \n          // Boost recent articles slightly\n          if (result.timestamp) {\n            const articleDate = new Date(result.timestamp);\n            const now = new Date();\n            const monthsOld = (now.getTime() - articleDate.getTime()) / (1000 * 60 * 60 * 24 * 30);\n            if (monthsOld < 12) score += 5; // Recent updates\n          }\n          \n          return {\n            title: result.title,\n            snippet: this.cleanSnippet(result.snippet || ''),\n            pageid: result.pageid,\n            score: score,\n            wordcount: result.wordcount,\n            size: result.size\n          };\n        })\n        .sort((a: any, b: any) => b.score - a.score) // Sort by relevance score\n        .slice(0, limit) // Take only requested amount\n        .map(({ score, wordcount, size, ...result }: any) => result); // Remove scoring fields\n      \n      return filteredResults;\n    } catch (error) {\n      console.error('Wikipedia search error:', error);\n      // Enhanced fallback with better suggestion handling\n      try {\n        const fallbackResponse = await axios.get(`https://${language}.wikipedia.org/w/api.php`, {\n          params: {\n            action: 'opensearch',\n            search: query,\n            limit: Math.min(limit * 2, 15),\n            namespace: 0,\n            format: 'json',\n            suggest: true,\n            redirects: 'resolve'\n          },\n          timeout: 3000,\n          headers: {\n            'User-Agent': 'WikiTruth/1.0 (https://wikitruth.app)'\n          }\n        });\n\n        const [, titles, snippets, urls] = fallbackResponse.data;\n        \n        return titles\n          .map((title: string, index: number) => ({\n            title,\n            snippet: this.cleanSnippet(snippets[index] || ''),\n            pageid: index + 1000000,\n            url: urls[index]\n          }))\n          .filter((result: any) => {\n            // Apply same quality filters for fallback\n            const title = result.title.toLowerCase();\n            return !title.includes('disambiguation') && \n                   !title.includes('category:') &&\n                   !title.includes('template:') &&\n                   result.title.length > 2;\n          })\n          .slice(0, limit);\n      } catch (fallbackError) {\n        console.error('Wikipedia fallback search error:', fallbackError);\n        throw new Error('Failed to search Wikipedia articles');\n      }\n    }\n  }\n\n  async getLanguageLinks(title: string, language: string = 'en'): Promise<WikipediaLanguageLink[]> {\n    try {\n      const response = await axios.get(`https://${language}.wikipedia.org/w/api.php`, {\n        params: {\n          action: 'query',\n          titles: title,\n          prop: 'langlinks',\n          lllimit: 500,\n          format: 'json'\n        },\n        timeout: 4000, // Faster language links\n        headers: {\n          'User-Agent': 'WikiTruth/1.0 (https://wikitruth.app)'\n        }\n      });\n\n      const pages = response.data.query.pages;\n      const page = Object.values(pages)[0] as any;\n      \n      if (!page.langlinks) {\n        return [];\n      }\n\n      return page.langlinks.map((link: any) => ({\n        lang: link.lang,\n        title: link['*'],\n        url: `https://${link.lang}.wikipedia.org/wiki/${encodeURIComponent(link['*'])}`\n      }));\n    } catch (error) {\n      console.error('Wikipedia language links error:', error);\n      throw new Error('Failed to fetch language links');\n    }\n  }\n\n  async getArticleContent(title: string, language: string = 'en'): Promise<WikipediaArticle> {\n    try {\n      // Use TextExtracts API with no character limit for full article content\n      const response = await axios.get(`https://${language}.wikipedia.org/w/api.php`, {\n        params: {\n          action: 'query',\n          titles: title,\n          prop: 'extracts|pageids|revisions',\n          rvprop: 'content',\n          rvslots: 'main',\n          exintro: false,\n          explaintext: true,\n          exsectionformat: 'plain',\n          format: 'json'\n        },\n        timeout: 30000,\n        headers: {\n          'User-Agent': 'WikiTruth/1.0 (https://wikitruth.app)'\n        }\n      });\n\n      const pages = response.data.query.pages;\n      const page = Object.values(pages)[0] as any;\n      \n      if (page.missing) {\n        throw new Error(`Article \"${title}\" not found in ${language} Wikipedia`);\n      }\n\n      // Try to get content from revisions (full wikitext) first, then fall back to extract\n      let content = '';\n      \n      // Get plain text extract (may be truncated by API)\n      const extract = page.extract || '';\n      \n      // Get wikitext from revisions for full content\n      if (page.revisions && page.revisions[0]?.slots?.main?.['*']) {\n        const wikitext = page.revisions[0].slots.main['*'];\n        // Convert wikitext to plain text (basic conversion)\n        content = this.wikitextToPlainText(wikitext);\n      } else if (extract.length > 100) {\n        content = extract;\n      }\n      \n      // If still short, try fetching via parse API for full rendered content\n      if (content.length < 1000) {\n        try {\n          const parseResponse = await axios.get(`https://${language}.wikipedia.org/w/api.php`, {\n            params: {\n              action: 'parse',\n              page: title,\n              prop: 'text',\n              format: 'json',\n              disabletoc: true,\n              disableeditsection: true\n            },\n            timeout: 30000,\n            headers: {\n              'User-Agent': 'WikiTruth/1.0 (https://wikitruth.app)'\n            }\n          });\n          \n          if (parseResponse.data.parse?.text?.['*']) {\n            const htmlContent = parseResponse.data.parse.text['*'];\n            content = this.htmlToPlainText(htmlContent);\n          }\n        } catch (parseError) {\n          console.warn('Parse API fallback failed:', parseError);\n        }\n      }\n      \n      console.log(`Fetched article \"${title}\" (${language}): ${content.length} characters`);\n      \n      return {\n        pageid: page.pageid,\n        title: page.title,\n        content: content,\n        language,\n        contentLength: content.length\n      };\n    } catch (error) {\n      console.error('Wikipedia content error:', error);\n      throw new Error(`Failed to fetch article content for \"${title}\" in ${language}`);\n    }\n  }\n\n  // Convert wikitext to plain text (basic conversion)\n  private wikitextToPlainText(wikitext: string): string {\n    if (!wikitext) return '';\n    \n    let text = wikitext\n      // Remove templates like {{...}}\n      .replace(/\\{\\{[^{}]*\\}\\}/g, '')\n      // Remove nested templates\n      .replace(/\\{\\{[^{}]*\\{\\{[^{}]*\\}\\}[^{}]*\\}\\}/g, '')\n      // Remove categories\n      .replace(/\\[\\[Category:[^\\]]+\\]\\]/gi, '')\n      .replace(/\\[\\[Категория:[^\\]]+\\]\\]/gi, '')\n      // Convert wiki links [[Link|Text]] to Text\n      .replace(/\\[\\[[^\\]|]+\\|([^\\]]+)\\]\\]/g, '$1')\n      // Convert simple wiki links [[Link]] to Link\n      .replace(/\\[\\[([^\\]]+)\\]\\]/g, '$1')\n      // Remove external links [http://... text] -> text\n      .replace(/\\[https?:\\/\\/[^\\s\\]]+ ([^\\]]+)\\]/g, '$1')\n      // Remove bare external links\n      .replace(/\\[https?:\\/\\/[^\\]]+\\]/g, '')\n      // Remove refs\n      .replace(/<ref[^>]*>[\\s\\S]*?<\\/ref>/g, '')\n      .replace(/<ref[^>]*\\/>/g, '')\n      // Remove HTML comments\n      .replace(/<!--[\\s\\S]*?-->/g, '')\n      // Remove HTML tags\n      .replace(/<[^>]+>/g, '')\n      // Convert headers == Header == to plain text\n      .replace(/^=+\\s*([^=]+)\\s*=+$/gm, '\\n$1\\n')\n      // Remove bold/italic markers\n      .replace(/'{2,}/g, '')\n      // Remove magic words\n      .replace(/__[A-Z]+__/g, '')\n      // Clean up multiple newlines\n      .replace(/\\n{3,}/g, '\\n\\n')\n      // Clean up whitespace\n      .replace(/[ \\t]+/g, ' ')\n      .trim();\n    \n    return text;\n  }\n\n  // Convert HTML to plain text\n  private htmlToPlainText(html: string): string {\n    if (!html) return '';\n    \n    let text = html\n      // Remove script and style elements\n      .replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, '')\n      .replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '')\n      // Remove reference sections\n      .replace(/<sup[^>]*class=\"[^\"]*reference[^\"]*\"[^>]*>[\\s\\S]*?<\\/sup>/gi, '')\n      // Remove edit links\n      .replace(/<span[^>]*class=\"[^\"]*mw-editsection[^\"]*\"[^>]*>[\\s\\S]*?<\\/span>/gi, '')\n      // Remove navigation boxes\n      .replace(/<div[^>]*class=\"[^\"]*navbox[^\"]*\"[^>]*>[\\s\\S]*?<\\/div>/gi, '')\n      .replace(/<table[^>]*class=\"[^\"]*navbox[^\"]*\"[^>]*>[\\s\\S]*?<\\/table>/gi, '')\n      // Remove infoboxes\n      .replace(/<table[^>]*class=\"[^\"]*infobox[^\"]*\"[^>]*>[\\s\\S]*?<\\/table>/gi, '')\n      // Remove table of contents\n      .replace(/<div[^>]*id=\"toc\"[^>]*>[\\s\\S]*?<\\/div>/gi, '')\n      // Add newlines for block elements\n      .replace(/<\\/?(?:p|div|h[1-6]|li|tr|br)[^>]*>/gi, '\\n')\n      // Remove all remaining HTML tags\n      .replace(/<[^>]+>/g, '')\n      // Decode HTML entities\n      .replace(/&nbsp;/g, ' ')\n      .replace(/&quot;/g, '\"')\n      .replace(/&amp;/g, '&')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&#39;/g, \"'\")\n      .replace(/&#\\d+;/g, '')\n      // Clean up whitespace\n      .replace(/\\n{3,}/g, '\\n\\n')\n      .replace(/[ \\t]+/g, ' ')\n      .trim();\n    \n    return text;\n  }\n\n  async getMultipleArticleContents(title: string, languages: string[], baseLanguage: string = 'en'): Promise<WikipediaArticle[]> {\n    try {\n      // First get language links to find the correct titles for each language\n      const languageLinks = await this.getLanguageLinks(title, baseLanguage);\n      \n      // Create a map of language to title\n      const languageTitleMap: Record<string, string> = {\n        [baseLanguage]: title // Include the base article\n      };\n      \n      languageLinks.forEach(link => {\n        languageTitleMap[link.lang] = link.title;\n      });\n\n      // Fetch articles for the requested languages\n      const promises = languages.map(async (lang) => {\n        const articleTitle = languageTitleMap[lang];\n        if (!articleTitle) {\n          console.warn(`No title found for language ${lang}`);\n          return null;\n        }\n        \n        try {\n          return await this.getArticleContent(articleTitle, lang);\n        } catch (error) {\n          console.warn(`Failed to fetch article for ${lang}:`, error);\n          return null;\n        }\n      });\n      \n      const results = await Promise.allSettled(promises);\n      \n      return results\n        .filter((result): result is PromiseFulfilledResult<WikipediaArticle> => \n          result.status === 'fulfilled' && result.value !== null\n        )\n        .map(result => result.value);\n    } catch (error) {\n      console.error('Multiple articles fetch error:', error);\n      throw new Error('Failed to fetch multiple article contents');\n    }\n  }\n\n  // Helper method to clean and improve snippet display\n  private cleanSnippet(snippet: string): string {\n    if (!snippet) return '';\n    \n    // Remove HTML tags but preserve structure\n    let cleaned = snippet\n      .replace(/<[^>]*>/g, '') // Remove HTML tags\n      .replace(/&quot;/g, '\"') // Replace HTML entities\n      .replace(/&amp;/g, '&')\n      .replace(/&lt;/g, '<')\n      .replace(/&gt;/g, '>')\n      .replace(/&#39;/g, \"'\")\n      .replace(/&nbsp;/g, ' ')\n      .trim();\n    \n    // Ensure snippet ends properly\n    if (cleaned.length > 150) {\n      cleaned = cleaned.substring(0, 147) + '...';\n    }\n    \n    // Remove incomplete sentences at the end\n    const lastPeriod = cleaned.lastIndexOf('.');\n    const lastExclamation = cleaned.lastIndexOf('!');\n    const lastQuestion = cleaned.lastIndexOf('?');\n    const lastSentenceEnd = Math.max(lastPeriod, lastExclamation, lastQuestion);\n    \n    if (lastSentenceEnd > 50 && lastSentenceEnd < cleaned.length - 10) {\n      cleaned = cleaned.substring(0, lastSentenceEnd + 1);\n    }\n    \n    return cleaned;\n  }\n}\n\nexport const wikipediaService = new WikipediaService();\n","path":null,"size_bytes":14907,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":23567,"size_tokens":null},"client/src/components/suggest-improvement.tsx":{"content":"import { Lightbulb } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\nexport function SuggestImprovement() {\n  const handleClick = () => {\n    const subject = encodeURIComponent('Suggestion for Wiki Truth Improvement');\n    const body = encodeURIComponent(`Hello World Truth Foundation team,\n\nI would like to suggest the following improvement for Wiki Truth:\n\n[Please describe your suggestion here]\n\nThank you for your great work!\n\nBest regards`);\n    \n    window.location.href = `mailto:worldtruthfoundation@gmail.com?subject=${subject}&body=${body}`;\n  };\n\n  return (\n    <Button\n      variant=\"outline\"\n      size=\"sm\"\n      onClick={handleClick}\n      data-testid=\"button-suggest-improvement\"\n      className=\"gap-2\"\n    >\n      <Lightbulb className=\"w-4 h-4\" />\n      Suggest Improvement\n    </Button>\n  );\n}\n","path":null,"size_bytes":836,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route, useLocation } from \"wouter\";\nimport { useEffect } from \"react\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ResponsiveNav } from \"@/components/responsive-nav\";\nimport { MobileFAB } from \"@/components/mobile-fab\";\nimport { Footer } from \"@/components/footer\";\nimport { clientStorage } from \"@/lib/storage\";\nimport Home from \"@/pages/home\";\nimport MainPage from \"@/pages/main\";\nimport SearchPage from \"@/pages/search\";\nimport ComparePage from \"@/pages/compare\";\nimport ToolsPage from \"@/pages/tools\";\nimport RecentComparisonsPage from \"@/pages/recent-comparisons\";\nimport HelpPage from \"@/pages/help\";\nimport AboutPage from \"@/pages/about\";\nimport HowItWorksPage from \"@/pages/how-it-works\";\nimport PrivacyPage from \"@/pages/privacy\";\nimport LanguageSelection from \"@/pages/language-selection\";\nimport ComparisonResults from \"@/pages/comparison-results\";\nimport TermsOfServicePage from \"@/pages/terms-of-service\";\nimport ContactUsPage from \"@/pages/contact-us\";\nimport ReportIssuesPage from \"@/pages/report-issues\";\nimport ComparisonLoading from \"@/pages/comparison-loading\";\nimport BillingPage from \"@/pages/billing\";\nimport BillingSuccessPage from \"@/pages/billing-success\";\nimport BillingCancelPage from \"@/pages/billing-cancel\";\nimport LibraryPage from \"@/pages/library\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction ScrollToTop() {\n  const [location] = useLocation();\n  \n  useEffect(() => {\n    // Scroll to top when route changes\n    window.scrollTo(0, 0);\n  }, [location]);\n  \n  return null;\n}\n\nfunction Router() {\n  return (\n    <>\n      <ScrollToTop />\n      <Switch>\n        <Route path=\"/\" component={MainPage} />\n        <Route path=\"/home\" component={Home} />\n        <Route path=\"/search\" component={SearchPage} />\n        <Route path=\"/compare\" component={ComparePage} />\n        <Route path=\"/tools\" component={ToolsPage} />\n        <Route path=\"/recent\" component={RecentComparisonsPage} />\n        <Route path=\"/help\" component={HelpPage} />\n        <Route path=\"/about\" component={AboutPage} />\n        <Route path=\"/how-it-works\" component={HowItWorksPage} />\n        <Route path=\"/privacy\" component={PrivacyPage} />\n        <Route path=\"/select-languages\" component={LanguageSelection} />\n        <Route path=\"/comparison-loading\" component={ComparisonLoading} />\n        <Route path=\"/results/:id\" component={ComparisonResults} />\n        <Route path=\"/terms-of-service\" component={TermsOfServicePage} />\n        <Route path=\"/contact-us\" component={ContactUsPage} />\n        <Route path=\"/report-issues\" component={ReportIssuesPage} />\n        <Route path=\"/billing\" component={BillingPage} />\n        <Route path=\"/billing/success\" component={BillingSuccessPage} />\n        <Route path=\"/billing/cancel\" component={BillingCancelPage} />\n        <Route path=\"/library\" component={LibraryPage} />\n        <Route component={NotFound} />\n      </Switch>\n    </>\n  );\n}\n\nfunction App() {\n  useEffect(() => {\n    // Initialize client storage on app startup\n    clientStorage.getCurrentUser().catch(console.error);\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <div className=\"min-h-screen bg-background\">\n          <ResponsiveNav />\n          \n          <div className=\"desktop-content\">\n            <main className=\"pt-16 lg:pt-20 pb-16 lg:pb-8 px-4 lg:px-6 min-h-screen\">\n              <div className=\"max-w-7xl mx-auto\">\n                <Router />\n              </div>\n            </main>\n          </div>\n          \n          <MobileFAB />\n          <Footer />\n        </div>\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":3868,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"shared/schema.ts":{"content":"import { pgTable, text, serial, integer, boolean, timestamp, jsonb } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  visitorId: text(\"visitor_id\").notNull().unique(),\n  email: text(\"email\"),\n  generationsUsed: integer(\"generations_used\").default(0).notNull(),\n  isPremium: boolean(\"is_premium\").default(false).notNull(),\n  subscriptionId: text(\"subscription_id\"),\n  subscriptionExpiresAt: timestamp(\"subscription_expires_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const payments = pgTable(\"payments\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull(),\n  orderId: text(\"order_id\").notNull().unique(),\n  amount: text(\"amount\").notNull(),\n  currency: text(\"currency\").default(\"USD\").notNull(),\n  status: text(\"status\").default(\"pending\").notNull(),\n  maxelpayOrderId: text(\"maxelpay_order_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const comparisons = pgTable(\"comparisons\", {\n  id: serial(\"id\").primaryKey(),\n  articleTitle: text(\"article_title\").notNull(),\n  selectedLanguages: jsonb(\"selected_languages\").notNull(), // Array of language codes\n  outputLanguage: text(\"output_language\").notNull(),\n  comparisonResult: text(\"comparison_result\"),\n  isFunnyMode: boolean(\"is_funny_mode\").default(false),\n  isPremium: boolean(\"is_premium\").default(false),\n  isPublic: boolean(\"is_public\").default(true), // All comparisons are public by default for library\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const highlights = pgTable(\"highlights\", {\n  id: serial(\"id\").primaryKey(),\n  comparisonId: integer(\"comparison_id\").notNull(),\n  startOffset: integer(\"start_offset\").notNull(),\n  endOffset: integer(\"end_offset\").notNull(),\n  color: text(\"color\").notNull(), // yellow, green, blue, pink, orange\n  excerpt: text(\"excerpt\").notNull(), // Snippet of highlighted text for validation\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const searchSessions = pgTable(\"search_sessions\", {\n  id: serial(\"id\").primaryKey(),\n  sessionId: text(\"session_id\").notNull().unique(),\n  searchQuery: text(\"search_query\"),\n  selectedArticle: jsonb(\"selected_article\"),\n  availableLanguages: jsonb(\"available_languages\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertComparisonSchema = createInsertSchema(comparisons).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertSearchSessionSchema = createInsertSchema(searchSessions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertHighlightSchema = createInsertSchema(highlights).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertComparison = z.infer<typeof insertComparisonSchema>;\nexport type Comparison = typeof comparisons.$inferSelect;\nexport type InsertSearchSession = z.infer<typeof insertSearchSessionSchema>;\nexport type SearchSession = typeof searchSessions.$inferSelect;\nexport type InsertHighlight = z.infer<typeof insertHighlightSchema>;\nexport type Highlight = typeof highlights.$inferSelect;\n\n// Wikipedia API response types\nexport const wikipediaSearchResultSchema = z.object({\n  title: z.string(),\n  snippet: z.string(),\n  pageid: z.number(),\n});\n\nexport const wikipediaLanguageLinkSchema = z.object({\n  lang: z.string(),\n  title: z.string(),\n  url: z.string(),\n});\n\nexport const wikipediaArticleSchema = z.object({\n  pageid: z.number(),\n  title: z.string(),\n  content: z.string(),\n  language: z.string(),\n  contentLength: z.number(),\n});\n\nexport type WikipediaSearchResult = z.infer<typeof wikipediaSearchResultSchema>;\nexport type WikipediaLanguageLink = z.infer<typeof wikipediaLanguageLinkSchema>;\nexport type WikipediaArticle = z.infer<typeof wikipediaArticleSchema>;\n","path":null,"size_bytes":4382,"size_tokens":null},"client/src/components/text-highlighter.tsx":{"content":"import { useState, useRef, useEffect, useCallback } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Highlighter, X, Trash2 } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { clientStorage, type LocalHighlight } from '@/lib/storage';\n\ninterface TextHighlighterProps {\n  content: string;\n  comparisonId: string | number;\n  formatContent: (content: string) => string;\n}\n\nconst HIGHLIGHT_COLORS = [\n  { name: 'yellow', bg: 'bg-yellow-200 dark:bg-yellow-900/50 text-gray-900 dark:text-yellow-100', class: 'rgba(254, 240, 138, 0.7)' },\n  { name: 'green', bg: 'bg-green-200 dark:bg-green-900/50 text-gray-900 dark:text-green-100', class: 'rgba(187, 247, 208, 0.7)' },\n  { name: 'blue', bg: 'bg-blue-200 dark:bg-blue-900/50 text-gray-900 dark:text-blue-100', class: 'rgba(191, 219, 254, 0.7)' },\n  { name: 'pink', bg: 'bg-pink-200 dark:bg-pink-900/50 text-gray-900 dark:text-pink-100', class: 'rgba(251, 207, 232, 0.7)' },\n  { name: 'orange', bg: 'bg-orange-200 dark:bg-orange-900/50 text-gray-900 dark:text-orange-100', class: 'rgba(254, 215, 170, 0.7)' },\n];\n\nfunction getColorBg(colorName: string): string {\n  const color = HIGHLIGHT_COLORS.find(c => c.name === colorName);\n  return color ? color.bg : 'bg-yellow-200 dark:bg-yellow-900/50 text-gray-900 dark:text-yellow-100';\n}\n\nexport function TextHighlighter({ content, comparisonId, formatContent }: TextHighlighterProps) {\n  const [selectedText, setSelectedText] = useState('');\n  const [selectionRange, setSelectionRange] = useState<{ start: number; end: number } | null>(null);\n  const [showColorPicker, setShowColorPicker] = useState(false);\n  const [colorPickerPosition, setColorPickerPosition] = useState({ x: 0, y: 0 });\n  const contentRef = useRef<HTMLDivElement>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const comparisonIdStr = String(comparisonId);\n\n  const { data: highlights = [] } = useQuery<LocalHighlight[]>({\n    queryKey: ['highlights', comparisonIdStr],\n    queryFn: async () => {\n      return clientStorage.getHighlightsByComparisonId(comparisonIdStr);\n    },\n    enabled: !!comparisonId,\n  });\n\n  const createHighlightMutation = useMutation({\n    mutationFn: async (data: { startOffset: number; endOffset: number; color: string; excerpt: string }) => {\n      return clientStorage.saveHighlight({\n        comparisonId: comparisonIdStr,\n        ...data\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['highlights', comparisonIdStr] });\n      toast({\n        title: 'Highlight saved',\n        description: 'Your highlight has been saved.',\n      });\n    },\n    onError: () => {\n      toast({\n        title: 'Error',\n        description: 'Failed to save highlight.',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const deleteHighlightMutation = useMutation({\n    mutationFn: async (highlightId: string) => {\n      return clientStorage.deleteHighlight(highlightId);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['highlights', comparisonIdStr] });\n      toast({\n        title: 'Highlight removed',\n        description: 'Your highlight has been removed.',\n      });\n    },\n  });\n\n  const getTextOffset = useCallback((container: Node, targetNode: Node, targetOffset: number): number => {\n    let offset = 0;\n    const walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null);\n    \n    while (walker.nextNode()) {\n      const node = walker.currentNode;\n      if (node === targetNode) {\n        return offset + targetOffset;\n      }\n      offset += node.textContent?.length || 0;\n    }\n    return offset;\n  }, []);\n\n  const handleTextSelection = useCallback(() => {\n    const selection = window.getSelection();\n    if (!selection || selection.isCollapsed || !contentRef.current) {\n      setShowColorPicker(false);\n      return;\n    }\n\n    const text = selection.toString().trim();\n    if (!text || text.length < 2) {\n      setShowColorPicker(false);\n      return;\n    }\n\n    const range = selection.getRangeAt(0);\n    const container = contentRef.current;\n    \n    if (!container.contains(range.commonAncestorContainer)) {\n      setShowColorPicker(false);\n      return;\n    }\n\n    const formattedContent = container.querySelector('.formatted-content');\n    if (!formattedContent) {\n      setShowColorPicker(false);\n      return;\n    }\n\n    const startOffset = getTextOffset(formattedContent, range.startContainer, range.startOffset);\n    const endOffset = getTextOffset(formattedContent, range.endContainer, range.endOffset);\n\n    if (startOffset === endOffset) {\n      setShowColorPicker(false);\n      return;\n    }\n\n    const rect = range.getBoundingClientRect();\n    const containerRect = container.getBoundingClientRect();\n    \n    setSelectedText(text);\n    setSelectionRange({ start: startOffset, end: endOffset });\n    setColorPickerPosition({\n      x: rect.left - containerRect.left + rect.width / 2,\n      y: rect.top - containerRect.top - 10,\n    });\n    setShowColorPicker(true);\n  }, [getTextOffset]);\n\n  const handleColorSelect = (color: string) => {\n    if (!selectionRange || !selectedText) return;\n\n    createHighlightMutation.mutate({\n      startOffset: selectionRange.start,\n      endOffset: selectionRange.end,\n      color,\n      excerpt: selectedText.substring(0, 100),\n    });\n\n    setShowColorPicker(false);\n    setSelectedText('');\n    setSelectionRange(null);\n    window.getSelection()?.removeAllRanges();\n  };\n\n  const handleDeleteHighlight = (highlightId: string) => {\n    deleteHighlightMutation.mutate(highlightId);\n  };\n\n  const renderContentWithHighlights = () => {\n    // First, format the content to HTML\n    const formattedHtml = formatContent(content);\n    \n    if (!highlights || highlights.length === 0) {\n      return formattedHtml;\n    }\n\n    // Create a temporary element to work with the HTML\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = formattedHtml;\n    \n    // Get the plain text from the formatted HTML\n    const plainText = tempDiv.textContent || '';\n    \n    // Sort highlights by start offset (descending) to apply from end to start\n    // This prevents offset shifts when inserting highlight marks\n    const sortedHighlights = [...highlights].sort((a, b) => b.startOffset - a.startOffset);\n    \n    for (const highlight of sortedHighlights) {\n      if (highlight.startOffset >= plainText.length) continue;\n      \n      const actualEnd = Math.min(highlight.endOffset, plainText.length);\n      const highlightedText = plainText.substring(highlight.startOffset, actualEnd);\n      \n      if (!highlightedText.trim()) continue;\n      \n      // Find and wrap the text in the DOM\n      applyHighlightToDOM(tempDiv, highlight.startOffset, actualEnd, highlight.color, highlight.id);\n    }\n    \n    return tempDiv.innerHTML;\n  };\n  \n  // Helper function to apply highlight to DOM based on text offsets\n  const applyHighlightToDOM = (container: HTMLElement, startOffset: number, endOffset: number, color: string, highlightId: string) => {\n    const walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null);\n    let currentOffset = 0;\n    let startNode: Text | null = null;\n    let startNodeOffset = 0;\n    let endNode: Text | null = null;\n    let endNodeOffset = 0;\n    \n    while (walker.nextNode()) {\n      const node = walker.currentNode as Text;\n      const nodeLength = node.textContent?.length || 0;\n      \n      // Find start node\n      if (!startNode && currentOffset + nodeLength > startOffset) {\n        startNode = node;\n        startNodeOffset = startOffset - currentOffset;\n      }\n      \n      // Find end node\n      if (currentOffset + nodeLength >= endOffset) {\n        endNode = node;\n        endNodeOffset = endOffset - currentOffset;\n        break;\n      }\n      \n      currentOffset += nodeLength;\n    }\n    \n    if (!startNode || !endNode) return;\n    \n    const colorClass = getColorBg(color);\n    \n    try {\n      // If start and end are in the same text node\n      if (startNode === endNode) {\n        const text = startNode.textContent || '';\n        const before = text.substring(0, startNodeOffset);\n        const highlighted = text.substring(startNodeOffset, endNodeOffset);\n        const after = text.substring(endNodeOffset);\n        \n        const fragment = document.createDocumentFragment();\n        if (before) fragment.appendChild(document.createTextNode(before));\n        \n        const mark = document.createElement('mark');\n        mark.className = `${colorClass} px-0.5 rounded cursor-pointer`;\n        mark.setAttribute('data-highlight-id', highlightId);\n        mark.setAttribute('title', 'Click to remove');\n        mark.textContent = highlighted;\n        fragment.appendChild(mark);\n        \n        if (after) fragment.appendChild(document.createTextNode(after));\n        \n        startNode.parentNode?.replaceChild(fragment, startNode);\n      } else {\n        // For multi-node selections, just highlight the excerpt text if found\n        const fullText = container.innerHTML;\n        const excerpt = (container.textContent || '').substring(startOffset, endOffset);\n        if (excerpt) {\n          // Escape special regex characters in the excerpt\n          const escapedExcerpt = excerpt.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n          const regex = new RegExp(`(?<!<[^>]*)${escapedExcerpt}(?![^<]*>)`, 'g');\n          let matched = false;\n          container.innerHTML = fullText.replace(regex, (match) => {\n            if (matched) return match; // Only highlight first occurrence\n            matched = true;\n            return `<mark class=\"${colorClass} px-0.5 rounded cursor-pointer\" data-highlight-id=\"${highlightId}\" title=\"Click to remove\">${match}</mark>`;\n          });\n        }\n      }\n    } catch (e) {\n      console.error('Error applying highlight:', e);\n    }\n  };\n\n  useEffect(() => {\n    const handleClick = (e: MouseEvent) => {\n      const target = e.target as HTMLElement;\n      if (target.tagName === 'MARK' && target.dataset.highlightId) {\n        const highlightId = target.dataset.highlightId;\n        if (highlightId) {\n          handleDeleteHighlight(highlightId);\n        }\n      }\n    };\n\n    const container = contentRef.current;\n    if (container) {\n      container.addEventListener('click', handleClick);\n      return () => container.removeEventListener('click', handleClick);\n    }\n  }, []);\n\n  return (\n    <div className=\"relative\">\n      <div className=\"mb-4 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\n        <Highlighter className=\"h-4 w-4\" />\n        <span>Select text to highlight it. Click on a highlight to remove it.</span>\n      </div>\n      \n      <div\n        ref={contentRef}\n        onMouseUp={handleTextSelection}\n        onTouchEnd={handleTextSelection}\n        className=\"prose prose-slate max-w-none markdown-content text-sm md:text-base\"\n      >\n        <div \n          className=\"formatted-content comparison-content leading-relaxed\"\n          dangerouslySetInnerHTML={{ __html: renderContentWithHighlights() }}\n        />\n      </div>\n\n      {showColorPicker && (\n        <div\n          className=\"absolute z-50 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-2\"\n          style={{\n            left: `${colorPickerPosition.x}px`,\n            top: `${colorPickerPosition.y}px`,\n            transform: 'translate(-50%, -100%)',\n          }}\n        >\n          <div className=\"flex items-center gap-1\">\n            {HIGHLIGHT_COLORS.map((color) => (\n              <button\n                key={color.name}\n                onClick={() => handleColorSelect(color.name)}\n                className={`w-7 h-7 rounded-full ${color.bg} border-2 border-transparent hover:border-gray-400 dark:hover:border-gray-300 transition-all hover:scale-110`}\n                title={color.name}\n                data-testid={`color-${color.name}`}\n              />\n            ))}\n            <button\n              onClick={() => setShowColorPicker(false)}\n              className=\"ml-1 p-1 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300\"\n              title=\"Cancel\"\n            >\n              <X className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n      )}\n\n      {highlights && highlights.length > 0 && (\n        <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n              Your Highlights ({highlights.length})\n            </h4>\n          </div>\n          <div className=\"space-y-2 max-h-48 overflow-y-auto\">\n            {highlights.map((highlight) => (\n              <div\n                key={highlight.id}\n                className={`flex items-start gap-2 p-2 rounded ${getColorBg(highlight.color)}`}\n              >\n                <span className=\"flex-1 text-sm text-gray-800 dark:text-gray-200 line-clamp-2\">\n                  \"{highlight.excerpt}\"\n                </span>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-6 w-6 shrink-0\"\n                  onClick={() => handleDeleteHighlight(highlight.id)}\n                  data-testid={`delete-highlight-${highlight.id}`}\n                >\n                  <Trash2 className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":13624,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":971,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"server/services/export.ts":{"content":"import { Document, Packer, Paragraph, TextRun, HeadingLevel } from 'docx';\n\nexport class ExportService {\n  async generateDocx(comparisonData: {\n    articleTitle: string;\n    languages: string[];\n    outputLanguage: string;\n    content: string;\n    isFunnyMode: boolean;\n  }): Promise<Buffer> {\n    try {\n      console.log('Generating DOCX for:', comparisonData.articleTitle);\n      console.log('Content length:', comparisonData.content.length);\n      const doc = new Document({\n        sections: [{\n          properties: {},\n          children: [\n            new Paragraph({\n              text: `Wiki Truth Comparison Report`,\n              heading: HeadingLevel.TITLE,\n            }),\n            new Paragraph({\n              children: [\n                new TextRun({\n                  text: `Article: `,\n                  bold: true,\n                }),\n                new TextRun({\n                  text: comparisonData.articleTitle,\n                }),\n              ],\n            }),\n            new Paragraph({\n              children: [\n                new TextRun({\n                  text: `Languages Compared: `,\n                  bold: true,\n                }),\n                new TextRun({\n                  text: comparisonData.languages.join(', '),\n                }),\n              ],\n            }),\n            new Paragraph({\n              children: [\n                new TextRun({\n                  text: `Output Language: `,\n                  bold: true,\n                }),\n                new TextRun({\n                  text: comparisonData.outputLanguage,\n                }),\n              ],\n            }),\n            new Paragraph({\n              children: [\n                new TextRun({\n                  text: `Mode: `,\n                  bold: true,\n                }),\n                new TextRun({\n                  text: comparisonData.isFunnyMode ? 'Funny Mode' : 'Standard Analysis',\n                }),\n              ],\n            }),\n            new Paragraph({\n              text: '', // Empty line\n            }),\n            new Paragraph({\n              text: 'Comparison Analysis',\n              heading: HeadingLevel.HEADING_1,\n            }),\n            ...this.convertTextToParagraphs(comparisonData.content),\n            new Paragraph({\n              text: '', // Empty line\n            }),\n            new Paragraph({\n              children: [\n                new TextRun({\n                  text: `Generated by Wiki Truth on ${new Date().toLocaleDateString()}`,\n                  italics: true,\n                  size: 20,\n                }),\n              ],\n            }),\n          ],\n        }],\n      });\n\n      return await Packer.toBuffer(doc);\n    } catch (error) {\n      console.error('DOCX generation error:', error);\n      throw new Error('Failed to generate DOCX document');\n    }\n  }\n\n  private convertTextToParagraphs(text: string): Paragraph[] {\n    // Clean HTML tags and formatting symbols that might be in the text\n    const cleanText = text\n      .replace(/<[^>]*>/g, '') // Remove HTML tags\n      .replace(/^\\s*[=\\-\\*]{3,}\\s*$/gm, '') // Remove divider lines\n      .replace(/#{1,6}\\s+/g, '') // Remove markdown headers\n      .trim();\n\n    const lines = cleanText.split('\\n');\n    const paragraphs: Paragraph[] = [];\n    \n    for (const line of lines) {\n      const trimmedLine = line.trim();\n      \n      // Skip empty lines or lines with only symbols\n      if (!trimmedLine || /^[=\\-\\*\\s]+$/.test(trimmedLine)) {\n        continue;\n      }\n      \n      // Check if line starts with bullet point\n      if (trimmedLine.match(/^[-*+]\\s+/)) {\n        const bulletText = trimmedLine.replace(/^[-*+]\\s+/, '');\n        paragraphs.push(new Paragraph({\n          children: [\n            new TextRun({\n              text: `• ${bulletText}`,\n            }),\n          ],\n        }));\n      }\n      // Check if line looks like a header (bold text or all caps)\n      else if (trimmedLine.length < 100 && (trimmedLine === trimmedLine.toUpperCase() || trimmedLine.endsWith(':'))) {\n        paragraphs.push(new Paragraph({\n          children: [\n            new TextRun({\n              text: trimmedLine,\n              bold: true,\n              size: 24,\n            }),\n          ],\n        }));\n      }\n      // Regular paragraph\n      else {\n        paragraphs.push(new Paragraph({\n          children: [\n            new TextRun({\n              text: trimmedLine,\n            }),\n          ],\n        }));\n      }\n    }\n    \n    return paragraphs;\n  }\n}\n\nexport const exportService = new ExportService();\n","path":null,"size_bytes":4567,"size_tokens":null},"client/src/components/premium-comparison-options.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Sparkles, Settings, Bot, BookOpen, User, Laugh, Zap, FileText } from \"lucide-react\";\n\ninterface PremiumComparisonOptionsProps {\n  selectedLanguages: string[];\n  articleTitle: string;\n  outputLanguage: string;\n  onStartComparison: (options: ComparisonOptions) => void;\n  onBack: () => void;\n  initialAnalysisMode?: 'academic' | 'biography' | 'funny';\n}\n\nexport interface ComparisonOptions {\n  outputFormat: 'bullet-points' | 'narrative';\n  focusPoints: string;\n  formality: 'formal' | 'casual' | 'academic';\n  aiModel: 'free' | 'premium';\n  analysisMode: 'academic' | 'biography' | 'funny';\n}\n\nexport function PremiumComparisonOptions({ \n  selectedLanguages, \n  articleTitle, \n  outputLanguage, \n  onStartComparison, \n  onBack,\n  initialAnalysisMode = 'academic'\n}: PremiumComparisonOptionsProps) {\n  const [options, setOptions] = useState<ComparisonOptions>({\n    outputFormat: 'narrative',\n    focusPoints: '',\n    formality: initialAnalysisMode === 'funny' ? 'casual' : 'formal',\n    aiModel: 'premium',\n    analysisMode: initialAnalysisMode\n  });\n\n  const handleStartComparison = () => {\n    onStartComparison(options);\n  };\n\n  const updateOption = <K extends keyof ComparisonOptions>(key: K, value: ComparisonOptions[K]) => {\n    setOptions(prev => ({ ...prev, [key]: value }));\n  };\n\n  return (\n    <div className=\"space-y-4 md:space-y-6 p-4 md:p-6\">\n      {/* Header */}\n      <div className=\"text-center\">\n        <div className=\"inline-flex items-center gap-2 bg-green-100 dark:bg-green-900/30 px-3 py-1 rounded-full text-sm text-green-700 dark:text-green-300 mb-4\">\n          <Sparkles className=\"h-4 w-4\" />\n          Premium Analysis Options\n        </div>\n        <h2 className=\"text-xl md:text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n          Customize Your Comparison\n        </h2>\n        <p className=\"text-sm md:text-base text-gray-600 dark:text-gray-300 px-2\">\n          Configure advanced settings for analyzing \"{articleTitle}\" across {selectedLanguages.length} languages\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6\">\n        {/* Output Format */}\n        <Card className=\"h-fit\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base md:text-lg\">\n              <FileText className=\"h-4 w-4 md:h-5 md:w-5\" />\n              Output Format\n            </CardTitle>\n            <CardDescription className=\"text-sm\">Choose how you want the comparison presented</CardDescription>\n          </CardHeader>\n          <CardContent className=\"pt-0\">\n            <RadioGroup\n              value={options.outputFormat}\n              onValueChange={(value: 'bullet-points' | 'narrative') => updateOption('outputFormat', value)}\n              className=\"space-y-3\"\n            >\n              <div className=\"flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <RadioGroupItem value=\"bullet-points\" id=\"bullet-points\" className=\"mt-1\" />\n                <Label htmlFor=\"bullet-points\" className=\"flex-1 cursor-pointer\">\n                  <div>\n                    <div className=\"font-medium text-sm md:text-base\">Bullet Points</div>\n                    <div className=\"text-xs md:text-sm text-gray-500\">Structured list of all differences</div>\n                  </div>\n                </Label>\n              </div>\n              <div className=\"flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <RadioGroupItem value=\"narrative\" id=\"narrative\" className=\"mt-1\" />\n                <Label htmlFor=\"narrative\" className=\"flex-1 cursor-pointer\">\n                  <div>\n                    <div className=\"font-medium text-sm md:text-base\">Narrative Analysis</div>\n                    <div className=\"text-xs md:text-sm text-gray-500\">Flowing discussion of differences</div>\n                  </div>\n                </Label>\n              </div>\n            </RadioGroup>\n          </CardContent>\n        </Card>\n\n        {/* Analysis Mode */}\n        <Card className=\"h-fit\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base md:text-lg\">\n              <BookOpen className=\"h-4 w-4 md:h-5 md:w-5\" />\n              Analysis Mode\n            </CardTitle>\n            <CardDescription className=\"text-sm\">Select the type of analysis focus</CardDescription>\n          </CardHeader>\n          <CardContent className=\"pt-0\">\n            <RadioGroup\n              value={options.analysisMode}\n              onValueChange={(value: 'academic' | 'biography' | 'funny') => updateOption('analysisMode', value)}\n              className=\"space-y-3\"\n            >\n              <div className=\"flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <RadioGroupItem value=\"academic\" id=\"academic\" className=\"mt-1\" />\n                <Label htmlFor=\"academic\" className=\"flex-1 cursor-pointer\">\n                  <div className=\"flex items-center gap-2\">\n                    <BookOpen className=\"h-4 w-4\" />\n                    <div>\n                      <div className=\"font-medium text-sm md:text-base\">Academic Analysis</div>\n                      <div className=\"text-xs md:text-sm text-gray-500\">Scholarly, fact-focused</div>\n                    </div>\n                  </div>\n                </Label>\n              </div>\n              <div className=\"flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <RadioGroupItem value=\"biography\" id=\"biography\" className=\"mt-1\" />\n                <Label htmlFor=\"biography\" className=\"flex-1 cursor-pointer\">\n                  <div className=\"flex items-center gap-2\">\n                    <User className=\"h-4 w-4\" />\n                    <div>\n                      <div className=\"font-medium text-sm md:text-base\">Biography Analysis</div>\n                      <div className=\"text-xs md:text-sm text-gray-500\">Person-centered, life events</div>\n                    </div>\n                  </div>\n                </Label>\n              </div>\n              <div className=\"flex items-start space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800\">\n                <RadioGroupItem value=\"funny\" id=\"funny\" className=\"mt-1\" />\n                <Label htmlFor=\"funny\" className=\"flex-1 cursor-pointer\">\n                  <div className=\"flex items-center gap-2\">\n                    <Laugh className=\"h-4 w-4\" />\n                    <div>\n                      <div className=\"font-medium text-sm md:text-base\">Fun Mode</div>\n                      <div className=\"text-xs md:text-sm text-gray-500\">Humorous, entertaining</div>\n                    </div>\n                  </div>\n                </Label>\n              </div>\n            </RadioGroup>\n          </CardContent>\n        </Card>\n\n        {/* Formality Level */}\n        <Card className=\"h-fit\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"flex items-center gap-2 text-base md:text-lg\">\n              <Settings className=\"h-4 w-4 md:h-5 md:w-5\" />\n              Formality Level\n            </CardTitle>\n            <CardDescription className=\"text-sm\">Set the tone and style of writing</CardDescription>\n          </CardHeader>\n          <CardContent className=\"pt-0\">\n            <Select\n              value={options.formality}\n              onValueChange={(value: 'formal' | 'casual' | 'academic') => updateOption('formality', value)}\n            >\n              <SelectTrigger className=\"text-sm md:text-base\">\n                <SelectValue placeholder=\"Select formality level\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"academic\" className=\"text-sm md:text-base\">Academic - Highly formal, research-style</SelectItem>\n                <SelectItem value=\"formal\" className=\"text-sm md:text-base\">Formal - Professional, structured</SelectItem>\n                <SelectItem value=\"casual\" className=\"text-sm md:text-base\">Casual - Conversational, approachable</SelectItem>\n              </SelectContent>\n            </Select>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Focus Points */}\n      <Card className=\"md:col-span-2\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-base md:text-lg\">\n            <Zap className=\"h-4 w-4 md:h-5 md:w-5\" />\n            Focus Points (Optional)\n          </CardTitle>\n          <CardDescription className=\"text-sm\">\n            Specify particular aspects, facts, or questions you want the AI to focus on during comparison\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Textarea\n            placeholder=\"E.g., 'Focus on historical dates and their accuracy', 'Compare cultural perspectives on this person's achievements', 'Look for differences in controversy mentions'...\"\n            value={options.focusPoints}\n            onChange={(e) => updateOption('focusPoints', e.target.value)}\n            className=\"min-h-[80px] md:min-h-[100px] text-sm md:text-base\"\n          />\n          <p className=\"text-xs text-gray-500 mt-2\">\n            You can write in any language. The AI will understand your instructions and focus on these areas.\n          </p>\n        </CardContent>\n      </Card>\n\n      {/* Action Buttons */}\n      <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4 pt-4\">\n        <Button variant=\"outline\" onClick={onBack} className=\"w-full md:w-auto order-2 md:order-1\">\n          Back to Language Selection\n        </Button>\n        \n        <div className=\"flex flex-col md:flex-row md:items-center gap-2 md:gap-4 order-1 md:order-2\">\n          <div className=\"text-sm text-gray-500 text-center md:text-left\">\n            Output Language: <span className=\"font-medium\">{outputLanguage}</span>\n          </div>\n          <Button onClick={handleStartComparison} className=\"bg-green-600 hover:bg-green-700 w-full md:w-auto\">\n            <Sparkles className=\"h-4 w-4 mr-2\" />\n            Start Premium Analysis\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":10772,"size_tokens":null},"client/src/pages/main.tsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { Search } from 'lucide-react';\nimport { SearchInterface } from '@/components/search-interface';\nimport { SearchResult } from '@/lib/api';\n\nexport default function MainPage() {\n  const [, setLocation] = useLocation();\n\n  const handleArticleSelected = (article: SearchResult, language: string) => {\n    setLocation(`/select-languages?title=${encodeURIComponent(article.title)}&lang=${language}`);\n  };\n\n  return (\n    <div className=\"space-y-12\">\n      {/* Hero Section */}\n      <section className=\"text-center space-y-8\">\n        <div className=\"space-y-4\">\n          <h1 className=\"text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 dark:text-white\">\n            Wiki Truth\n          </h1>\n          <p className=\"text-lg md:text-xl text-wiki-gray max-w-4xl mx-auto leading-relaxed\">\n            Discover how the same topic is presented differently across Wikipedia's language versions. \n            Our AI-powered analysis reveals cultural perspectives, factual variations, and narrative differences.\n          </p>\n        </div>\n\n        {/* Search Interface */}\n        <div className=\"max-w-3xl mx-auto\">\n          <SearchInterface onArticleSelected={handleArticleSelected} />\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8\">\n        <div className=\"wiki-card text-center\">\n          <div className=\"w-12 h-12 bg-wiki-blue/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Search className=\"w-6 h-6 text-wiki-blue\" />\n          </div>\n          <h3 className=\"font-bold text-lg mb-3\">Multi-Language Analysis</h3>\n          <p className=\"text-sm text-wiki-gray leading-relaxed\">\n            Compare articles across 2-5 Wikipedia languages from 270+ available languages to discover cultural perspectives.\n          </p>\n        </div>\n        \n        <div className=\"wiki-card text-center\">\n          <div className=\"w-12 h-12 bg-wiki-blue/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <svg className=\"w-6 h-6 text-wiki-blue\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n            </svg>\n          </div>\n          <h3 className=\"font-bold text-lg mb-3\">AI-Powered Insights</h3>\n          <p className=\"text-sm text-wiki-gray leading-relaxed\">\n            Uses advanced AI to identify factual differences, narrative variations, and cultural biases in content presentation.\n          </p>\n        </div>\n        \n        <div className=\"wiki-card text-center md:col-span-2 lg:col-span-1\">\n          <div className=\"w-12 h-12 bg-wiki-blue/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <svg className=\"w-6 h-6 text-wiki-blue\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\n            </svg>\n          </div>\n          <h3 className=\"font-bold text-lg mb-3\">Privacy First</h3>\n          <p className=\"text-sm text-wiki-gray leading-relaxed\">\n            All data stored locally in your browser. No account required, completely free to use.\n          </p>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"text-center\">\n        <div className=\"inline-flex flex-col sm:flex-row items-center gap-6 sm:gap-8 text-sm text-wiki-gray\">\n          <div className=\"flex items-center gap-2\">\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129\" />\n            </svg>\n            <span>35+ Languages Supported</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\n            </svg>\n            <span>Unlimited Comparisons</span>\n          </div>\n        </div>\n      </section>\n    </div>\n  );\n}","path":null,"size_bytes":4678,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(0, 0%, 100%);\n  --foreground: hsl(0, 0%, 0%);\n  --muted: hsl(0, 0%, 96.5%);\n  --muted-foreground: hsl(0, 0%, 45.1%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(0, 0%, 0%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(0, 0%, 0%);\n  --border: hsl(0, 0%, 63.9%);\n  --input: hsl(0, 0%, 63.9%);\n  --primary: hsl(220, 89%, 33%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  --secondary: hsl(0, 0%, 96.5%);\n  --secondary-foreground: hsl(0, 0%, 9%);\n  --accent: hsl(0, 0%, 96.5%);\n  --accent-foreground: hsl(0, 0%, 9%);\n  --destructive: hsl(0, 84.2%, 60.2%);\n  --destructive-foreground: hsl(60, 9.1%, 97.8%);\n  --ring: hsl(0, 0%, 0%);\n  --radius: 0.5rem;\n  \n  /* Wikipedia-inspired colors */\n  --wiki-blue: hsl(220, 89%, 33%);\n  --wiki-blue-hover: hsl(220, 89%, 28%);\n  --wiki-gray: hsl(214, 13%, 47%);\n  --wiki-light-gray: hsl(0, 0%, 96.5%);\n  --wiki-border: hsl(214, 19%, 69%);\n  --wiki-light-border: hsl(216, 20%, 92%);\n  --wiki-success: hsl(162, 100%, 34%);\n  --wiki-alert: hsl(4, 68%, 48%);\n  --wiki-premium: hsl(142, 76%, 36%);\n  --wiki-premium-light: hsl(142, 76%, 95%);\n}\n\n.dark {\n  --background: hsl(240, 10%, 3.9%);\n  --foreground: hsl(0, 0%, 98%);\n  --muted: hsl(240, 3.7%, 15.9%);\n  --muted-foreground: hsl(240, 5%, 64.9%);\n  --popover: hsl(240, 10%, 3.9%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  --card: hsl(240, 10%, 3.9%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --border: hsl(240, 3.7%, 15.9%);\n  --input: hsl(240, 3.7%, 15.9%);\n  --primary: hsl(220, 89%, 54%);\n  --primary-foreground: hsl(211, 100%, 99%);\n  --secondary: hsl(240, 3.7%, 15.9%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --accent: hsl(240, 3.7%, 15.9%);\n  --accent-foreground: hsl(0, 0%, 98%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(0, 0%, 98%);\n  --ring: hsl(240, 4.9%, 83.9%);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply bg-background text-foreground;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Lato, Helvetica, Arial, sans-serif;\n  }\n  \n  h1, h2, h3, h4, h5, h6 {\n    font-family: 'Libre Baskerville', 'Linux Libertine', Georgia, serif;\n  }\n}\n\n@layer components {\n  .wiki-input {\n    @apply w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent transition-all duration-150 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-button {\n    @apply px-4 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-200 dark:hover:bg-gray-600 hover:border-gray-400 dark:hover:border-gray-500 transition-all duration-150 font-medium text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-button-primary {\n    @apply px-4 py-2 bg-blue-600 text-white border border-blue-600 rounded hover:bg-blue-700 transition-all duration-150 font-medium;\n  }\n  \n  .wiki-link {\n    @apply text-blue-600 dark:text-blue-400 hover:underline cursor-pointer;\n  }\n  \n  .comparison-highlight {\n    @apply bg-yellow-100 dark:bg-yellow-900/30 px-1 py-0.5 rounded text-gray-900 dark:text-gray-100;\n  }\n  \n  .funny-mode {\n    @apply bg-gradient-to-r from-pink-500 to-yellow-500 text-white;\n    animation: rainbow 3s ease-in-out infinite alternate;\n  }\n  \n  .wiki-sidebar {\n    @apply bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-4 text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-content-section {\n    @apply bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg p-6 mb-4 text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-article-title {\n    @apply text-2xl font-bold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4;\n    font-family: 'Libre Baskerville', 'Linux Libertine', Georgia, serif;\n  }\n  \n  .wiki-section-title {\n    @apply text-xl font-semibold text-gray-900 dark:text-white mb-3;\n    font-family: 'Libre Baskerville', 'Linux Libertine', Georgia, serif;\n  }\n  \n  .wiki-button-secondary {\n    @apply px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-all duration-150 font-medium;\n  }\n\n  /* Markdown content styling for comparison results */\n  .markdown-content {\n    @apply text-gray-800 dark:text-gray-200 leading-relaxed;\n    font-family: 'Libre Baskerville', 'Linux Libertine', Georgia, serif;\n    line-height: 1.7;\n  }\n  \n  .markdown-content h1,\n  .markdown-content h2,\n  .markdown-content h3,\n  .markdown-content h4,\n  .markdown-content h5,\n  .markdown-content h6 {\n    @apply font-bold text-blue-800 dark:text-blue-400;\n    font-family: 'Libre Baskerville', 'Linux Libertine', Georgia, serif;\n    letter-spacing: -0.025em;\n  }\n  \n  .markdown-content h1 {\n    @apply text-2xl mb-6 mt-0 border-b-2 border-blue-600 dark:border-blue-500 pb-3;\n  }\n  \n  .markdown-content h2 {\n    @apply text-xl mb-4 mt-8 border-b border-gray-300 dark:border-gray-600 pb-2;\n  }\n  \n  .markdown-content h3 {\n    @apply text-lg mb-3 mt-6;\n  }\n  \n  .markdown-content p {\n    @apply mb-4 text-gray-800 dark:text-gray-200;\n  }\n  \n  .markdown-content strong {\n    @apply font-semibold text-blue-800 dark:text-blue-400;\n  }\n  \n  .markdown-content ul,\n  .markdown-content ol {\n    @apply mb-4 pl-6;\n  }\n  \n  .markdown-content li {\n    @apply mb-1 text-gray-800 dark:text-gray-200;\n  }\n  \n  .markdown-content blockquote {\n    @apply border-l-4 border-blue-600 dark:border-blue-500 pl-4 italic text-gray-700 dark:text-gray-300 my-4 bg-gray-50 dark:bg-gray-800 py-2 rounded-r;\n  }\n  \n  .markdown-content code {\n    @apply bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-sm font-mono text-gray-800 dark:text-gray-200;\n  }\n  \n  .markdown-content pre {\n    @apply bg-gray-100 dark:bg-gray-700 p-4 rounded overflow-x-auto my-4;\n  }\n  \n  .markdown-content pre code {\n    @apply bg-transparent p-0;\n  }\n  \n  .wiki-tag {\n    @apply inline-block px-2 py-1 text-sm rounded;\n  }\n  \n  .wiki-message {\n    @apply p-4 rounded border;\n  }\n  \n  .wiki-message-error {\n    @apply bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200;\n  }\n  \n  .wiki-message-success {\n    @apply bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200;\n  }\n  \n  .wiki-gray {\n    color: var(--wiki-gray);\n  }\n  \n  .dark .wiki-gray {\n    color: #9ca3af;\n  }\n  \n  .wiki-blue {\n    color: var(--wiki-blue);\n  }\n  \n  .dark .wiki-blue {\n    color: #60a5fa;\n  }\n  \n  /* Mobile-first responsive components */\n  .mobile-nav-overlay {\n    @apply fixed inset-0 bg-black/50 z-40 lg:hidden;\n  }\n  \n  .mobile-nav-panel {\n    @apply fixed left-0 top-0 h-full w-80 bg-background shadow-xl z-50 transform transition-transform duration-200 lg:hidden;\n  }\n  \n  .mobile-nav-panel.closed {\n    @apply -translate-x-full;\n  }\n  \n  .mobile-nav-panel.open {\n    @apply translate-x-0;\n  }\n  \n  .mobile-search-bar {\n    @apply fixed top-0 left-0 right-0 bg-background border-b border-border z-30 px-4 py-3 lg:static lg:border-none lg:p-0;\n  }\n  \n  .mobile-fab {\n    @apply fixed bottom-20 right-6 bg-blue-600 text-white rounded-full p-4 shadow-lg z-30 lg:hidden;\n  }\n  \n  .mobile-fab:hover {\n    @apply bg-blue-700;\n  }\n  \n  .mobile-bottom-nav {\n    @apply fixed bottom-0 left-0 right-0 bg-background border-t border-border z-30 px-4 py-2 lg:hidden;\n  }\n  \n  .desktop-sidebar {\n    @apply hidden lg:block fixed left-0 top-0 h-full w-64 bg-muted border-r border-border overflow-y-auto;\n  }\n  \n  .desktop-content {\n    @apply lg:ml-64 min-h-screen;\n  }\n  \n  .wiki-card {\n    @apply bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-card-compact {\n    @apply bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-button-modern {\n    @apply px-6 py-3 bg-blue-600 text-white border border-blue-600 rounded-lg hover:bg-blue-700 transition-all duration-200 font-medium shadow-sm hover:shadow-md;\n  }\n  \n  .wiki-button-secondary-modern {\n    @apply px-6 py-3 bg-white dark:bg-gray-700 text-gray-600 dark:text-gray-200 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-all duration-200 font-medium shadow-sm hover:shadow-md;\n  }\n  \n  .wiki-premium-badge {\n    @apply inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-wiki-premium-light text-wiki-premium rounded-full;\n  }\n  \n  .wiki-search-input {\n    @apply w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent placeholder-gray-500 dark:placeholder-gray-400 text-base bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100;\n  }\n  \n  .wiki-nav-link {\n    @apply flex items-center gap-3 px-4 py-3 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors rounded-lg;\n  }\n  \n  .wiki-nav-link.active {\n    @apply text-blue-600 dark:text-blue-400 bg-gray-50 dark:bg-gray-700;\n  }\n  \n  .wiki-section-header {\n    @apply flex items-center justify-between mb-6 pb-3 border-b border-gray-200 dark:border-gray-700;\n  }\n  \n  .wiki-breadcrumb {\n    @apply flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-4;\n  }\n  \n  .wiki-breadcrumb-separator {\n    @apply text-gray-400 dark:text-gray-500;\n  }\n  \n  .wiki-status-indicator {\n    @apply inline-flex items-center gap-2 px-3 py-1 text-sm rounded-full;\n  }\n  \n  .wiki-status-free {\n    @apply bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300;\n  }\n  \n  .wiki-status-premium {\n    @apply bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300;\n  }\n}\n\n@keyframes rainbow {\n  0% { filter: hue-rotate(0deg); }\n  100% { filter: hue-rotate(15deg); }\n}\n\n/* Custom scrollbar */\n::-webkit-scrollbar {\n  width: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: var(--wiki-light-gray);\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--wiki-border);\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: var(--wiki-gray);\n}\n\n/* Mobile symbol display fixes */\n@media (max-width: 768px) {\n  .comparison-content {\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    word-break: break-word;\n  }\n  \n  .comparison-content * {\n    max-width: 100%;\n  }\n}\n","path":null,"size_bytes":10597,"size_tokens":null},"client/src/pages/compare.tsx":{"content":"import { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\n\nexport default function ComparePage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <main className=\"lg:col-span-3\">\n      <div className=\"wiki-content-section\">\n        <h1 className=\"wiki-article-title\">Start a New Comparison</h1>\n        <p className=\"text-wiki-gray mb-6\">\n          Begin by searching for a Wikipedia article, then select languages to compare cultural perspectives.\n        </p>\n\n        <div className=\"space-y-6\">\n          {/* Step-by-step Guide */}\n          <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded p-6\">\n            <h2 className=\"font-semibold text-lg mb-4 text-gray-900 dark:text-white\">How to Compare Articles</h2>\n            <div className=\"space-y-4\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">1</div>\n                <div>\n                  <h3 className=\"font-medium text-gray-900 dark:text-white\">Search for an Article</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Find any Wikipedia topic in your preferred language</p>\n                </div>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">2</div>\n                <div>\n                  <h3 className=\"font-medium text-gray-900 dark:text-white\">Select Languages</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Choose 2-5 language versions to compare</p>\n                </div>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">3</div>\n                <div>\n                  <h3 className=\"font-medium text-gray-900 dark:text-white\">Choose Analysis Mode</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Academic analysis or fun mode for entertaining insights</p>\n                </div>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"bg-blue-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold\">4</div>\n                <div>\n                  <h3 className=\"font-medium text-gray-900 dark:text-white\">Review Results</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Get AI-powered analysis of cultural differences and perspectives</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Quick Start Button */}\n          <div className=\"text-center\">\n            <Button \n              onClick={() => setLocation('/search')}\n              className=\"wiki-button-primary text-lg px-8 py-3\"\n            >\n              <i className=\"fas fa-search mr-2\"></i>\n              Start Searching Articles\n            </Button>\n          </div>\n\n          {/* Features Reminder */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-8\">\n            <div className=\"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded p-4\">\n              <h3 className=\"font-semibold text-green-900 dark:text-green-200 mb-2\">\n                <i className=\"fas fa-check-circle mr-2\"></i>Completely Free\n              </h3>\n              <p className=\"text-sm text-green-800 dark:text-green-300\">\n                Unlimited comparisons with no account required\n              </p>\n            </div>\n            <div className=\"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded p-4\">\n              <h3 className=\"font-semibold text-blue-900 dark:text-blue-200 mb-2\">\n                <i className=\"fas fa-shield-alt mr-2\"></i>Privacy First\n              </h3>\n              <p className=\"text-sm text-blue-800 dark:text-blue-300\">\n                All data stored locally in your browser\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":4294,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/search-interface.tsx":{"content":"import { useState } from 'react';\nimport { Search } from 'lucide-react';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { useWikipediaSearch } from '@/hooks/use-wikipedia-search';\nimport { SUPPORTED_LANGUAGES } from '@/lib/languages';\nimport { SearchResult } from '@/lib/api';\n\ninterface SearchInterfaceProps {\n  onArticleSelected: (article: SearchResult, language: string) => void;\n}\n\nexport function SearchInterface({ onArticleSelected }: SearchInterfaceProps) {\n  const [selectedLanguage, setSelectedLanguage] = useState('en');\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const { query, search, suggestions, isLoading } = useWikipediaSearch(selectedLanguage);\n\n  const handleInputChange = (value: string) => {\n    search(value);\n    setShowSuggestions(value.length >= 2);\n  };\n\n  const handleSuggestionClick = (suggestion: SearchResult) => {\n    onArticleSelected(suggestion, selectedLanguage);\n    setShowSuggestions(false);\n  };\n\n  const handleSearchSubmit = () => {\n    if (suggestions.length > 0) {\n      handleSuggestionClick(suggestions[0]);\n    }\n  };\n\n  return (\n    <div className=\"wiki-content-section mb-8\">\n      <div className=\"mb-6\">\n        <label className=\"block text-sm font-semibold mb-2\">Select input language:</label>\n        <Select value={selectedLanguage} onValueChange={setSelectedLanguage}>\n          <SelectTrigger className=\"wiki-input\">\n            <SelectValue placeholder=\"Select language\" />\n          </SelectTrigger>\n          <SelectContent>\n            {SUPPORTED_LANGUAGES.map((lang) => (\n              <SelectItem key={lang.code} value={lang.code}>\n                {lang.name} ({lang.nativeName})\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"relative mb-6\">\n        <label className=\"block text-sm font-semibold mb-2\">Search for an article:</label>\n        <div className=\"relative\">\n          <Input\n            type=\"text\"\n            placeholder=\"Type to search Wikipedia articles...\"\n            value={query}\n            onChange={(e) => handleInputChange(e.target.value)}\n            onKeyDown={(e) => e.key === 'Enter' && handleSearchSubmit()}\n            className=\"wiki-search-input pr-12\"\n          />\n          <Search className=\"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n        </div>\n\n        {/* Suggestions Dropdown */}\n        {showSuggestions && query.length >= 2 && (\n          <div className=\"absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-b shadow-lg z-10 max-h-80 overflow-y-auto\">\n            {isLoading ? (\n              <div className=\"p-4 text-center text-gray-600\">\n                <div className=\"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full inline-block mr-2\"></div>\n                Finding quality articles...\n              </div>\n            ) : suggestions.length === 0 ? (\n              <div className=\"p-4 text-center text-gray-500\">\n                <div className=\"mb-2\">No articles found for \"{query}\"</div>\n                <div className=\"text-xs text-gray-400\">\n                  Try different keywords or check spelling\n                </div>\n              </div>\n            ) : (\n              <>\n                <div className=\"p-2 bg-green-50 border-b border-green-200 text-xs text-green-700\">\n                  <i className=\"fas fa-check-circle mr-1\"></i>\n                  {suggestions.length} quality articles found with multiple language versions\n                </div>\n                {suggestions.map((suggestion, index) => (\n                  <div\n                    key={`${suggestion.pageid}-${index}`}\n                    className=\"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-200 last:border-b-0 transition-colors\"\n                    onClick={() => handleSuggestionClick(suggestion)}\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium text-gray-900 mb-1 flex items-center\">\n                          <span className=\"text-xs text-gray-400 mr-2 bg-gray-100 px-1.5 py-0.5 rounded\">#{index + 1}</span>\n                          {suggestion.title}\n                        </div>\n                        {suggestion.snippet && (\n                          <div className=\"text-sm text-gray-600 leading-relaxed line-clamp-2\">\n                            {suggestion.snippet}\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"ml-2 text-xs text-gray-400\">\n                        <i className=\"fas fa-arrow-right\"></i>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n                <div className=\"p-2 bg-blue-50 border-t border-blue-200 text-xs text-blue-700 text-center\">\n                  Click any article above to start comparing across languages\n                </div>\n              </>\n            )}\n          </div>\n        )}\n      </div>\n\n      <Button \n        onClick={handleSearchSubmit} \n        className=\"wiki-button-modern w-full\"\n        disabled={suggestions.length === 0}\n      >\n        <Search className=\"w-4 h-4 mr-2\" />\n        Search Article\n      </Button>\n    </div>\n  );\n}\n","path":null,"size_bytes":5533,"size_tokens":null},"client/src/lib/wikipedia-simple.ts":{"content":"// Simplified Wikipedia client that definitely works\nexport class SimpleWikipediaClient {\n  async testConnection() {\n    try {\n      const response = await fetch('https://en.wikipedia.org/w/api.php?action=query&titles=Berlin&prop=extracts&explaintext=true&format=json&origin=*');\n      const data = await response.json();\n      console.log('Wikipedia test response:', data);\n      return response.ok;\n    } catch (error) {\n      console.error('Wikipedia connection test failed:', error);\n      return false;\n    }\n  }\n\n  async fetchArticle(title: string, language: string = 'en') {\n    const url = `https://${language}.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(title)}&prop=extracts&explaintext=true&format=json&origin=*`;\n    \n    try {\n      console.log(`Fetching: ${url}`);\n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}`);\n      }\n\n      const data = await response.json();\n      const pages = data.query?.pages;\n      \n      if (!pages) {\n        throw new Error('No pages in response');\n      }\n\n      const pageId = Object.keys(pages)[0];\n      const page = pages[pageId];\n      \n      if (pageId === '-1') {\n        throw new Error(`Article \"${title}\" not found in ${language}`);\n      }\n\n      const content = page.extract || '';\n      \n      return {\n        title: page.title || title,\n        content,\n        language,\n        contentLength: content.length\n      };\n    } catch (error) {\n      console.error(`Failed to fetch ${language}:${title}:`, error);\n      throw error;\n    }\n  }\n}\n\nexport const simpleWikipedia = new SimpleWikipediaClient();","path":null,"size_bytes":1660,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { SearchInterface } from '@/components/search-interface';\nimport { SearchResult } from '@/lib/api';\n\nexport default function Home() {\n  const [, setLocation] = useLocation();\n\n  const handleArticleSelected = (article: SearchResult, language: string) => {\n    // Navigate to language selection page with article data\n    setLocation(`/select-languages?title=${encodeURIComponent(article.title)}&lang=${language}`);\n  };\n\n  return (\n    <main className=\"lg:col-span-3\">\n      {/* Hero Section */}\n      <section className=\"mb-12\">\n        <div className=\"text-center mb-8\">\n          <h1 className=\"font-bold text-4xl mb-4\">Wiki Truth</h1>\n          <p className=\"text-lg text-wiki-gray mb-6 max-w-3xl mx-auto\">\n            Wiki Truth uses artificial intelligence to compare Wikipedia articles across multiple languages. \n            It reveals how the same topic can be presented differently in various linguistic and cultural contexts.\n          </p>\n        </div>\n\n        {/* Search Interface */}\n        <SearchInterface onArticleSelected={handleArticleSelected} />\n\n        {/* Features Section */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <div className=\"wiki-sidebar\">\n            <div className=\"text-center mb-4\">\n              <i className=\"fas fa-globe text-3xl text-wiki-blue mb-2\"></i>\n            </div>\n            <h3 className=\"font-bold text-lg mb-2\">Multi-Language Analysis</h3>\n            <p className=\"text-sm text-wiki-gray\">\n              Compare the same topic across 2-5 different Wikipedia language versions to discover cultural perspectives.\n            </p>\n          </div>\n          \n          <div className=\"wiki-sidebar\">\n            <div className=\"text-center mb-4\">\n              <i className=\"fas fa-brain text-3xl text-wiki-blue mb-2\"></i>\n            </div>\n            <h3 className=\"font-bold text-lg mb-2\">AI-Powered Insights</h3>\n            <p className=\"text-sm text-wiki-gray\">\n              Uses GPT-4 to identify factual differences, narrative variations, and cultural biases in content presentation.\n            </p>\n          </div>\n          \n          <div className=\"wiki-sidebar\">\n            <div className=\"text-center mb-4\">\n              <i className=\"fas fa-share-alt text-3xl text-wiki-blue mb-2\"></i>\n            </div>\n            <h3 className=\"font-bold text-lg mb-2\">Export & Share</h3>\n            <p className=\"text-sm text-wiki-gray\">\n              Export comparisons as Word documents or share insights across social platforms.\n            </p>\n          </div>\n        </div>\n      </section>\n    </main>\n  );\n}\n","path":null,"size_bytes":2700,"size_tokens":null},"client/src/pages/recent-comparisons.tsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\nimport { api } from '@/lib/api';\nimport { getLanguageName } from '@/lib/languages';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function RecentComparisonsPage() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const comparisonsQuery = useQuery({\n    queryKey: ['/api/comparisons'],\n    queryFn: () => api.getUserComparisons(),\n  });\n\n  const handleDelete = async (id: string) => {\n    if (confirm('Are you sure you want to delete this comparison?')) {\n      try {\n        await api.deleteComparison(id);\n        comparisonsQuery.refetch();\n        toast({\n          title: \"Comparison Deleted\",\n          description: \"The comparison has been removed from your history\",\n        });\n      } catch (error) {\n        toast({\n          title: \"Delete Failed\",\n          description: \"Could not delete the comparison\",\n          variant: \"destructive\"\n        });\n      }\n    }\n  };\n\n  return (\n    <main className=\"container mx-auto max-w-7xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"wiki-content-section px-4 md:px-6\">\n        <h1 className=\"wiki-article-title text-xl md:text-2xl\">Recent Comparisons</h1>\n        <p className=\"text-wiki-gray mb-4 md:mb-6 text-sm md:text-base\">\n          View and manage your comparison history stored locally in your browser.\n        </p>\n\n        {comparisonsQuery.isLoading && (\n          <div className=\"text-center py-8\">\n            <i className=\"fas fa-spinner fa-spin text-2xl text-wiki-gray mb-2\"></i>\n            <p className=\"text-wiki-gray\">Loading your comparisons...</p>\n          </div>\n        )}\n\n        {comparisonsQuery.error && (\n          <div className=\"wiki-message wiki-message-error\">\n            Failed to load comparison history. Please try refreshing the page.\n          </div>\n        )}\n\n        {comparisonsQuery.data && comparisonsQuery.data.length === 0 && (\n          <div className=\"text-center py-8 md:py-12 px-4\">\n            <i className=\"fas fa-history text-3xl md:text-4xl text-wiki-gray mb-3 md:mb-4\"></i>\n            <h2 className=\"text-lg md:text-xl font-semibold mb-2\">No Comparisons Yet</h2>\n            <p className=\"text-wiki-gray mb-4 md:mb-6 text-sm md:text-base max-w-md mx-auto\">\n              You haven't created any comparisons yet. Start by searching for a Wikipedia article.\n            </p>\n            <Button \n              onClick={() => setLocation('/search')}\n              className=\"wiki-button-primary text-sm md:text-base\"\n            >\n              <i className=\"fas fa-search mr-2\"></i>\n              Start Your First Comparison\n            </Button>\n          </div>\n        )}\n\n        {comparisonsQuery.data && comparisonsQuery.data.length > 0 && (\n          <div className=\"space-y-4\">\n            {comparisonsQuery.data\n              .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n              .map((comparison) => (\n                <div key={comparison.id} className=\"wiki-sidebar p-3 md:p-4\">\n                  <div className=\"flex flex-col md:flex-row md:justify-between md:items-start gap-3 mb-3\">\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold text-base md:text-lg mb-2 break-words\">\n                        {comparison.articleTitle}\n                      </h3>\n                      <div className=\"text-xs md:text-sm text-wiki-gray space-y-1\">\n                        <div className=\"flex items-start gap-2\">\n                          <i className=\"fas fa-globe mt-0.5 flex-shrink-0\"></i>\n                          <span className=\"break-words\">\n                            Languages: {comparison.selectedLanguages.map(lang => getLanguageName(lang)).join(', ')}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <i className=\"fas fa-calendar flex-shrink-0\"></i>\n                          <span className=\"truncate\">\n                            {new Date(comparison.createdAt).toLocaleDateString()}\n                            <span className=\"hidden sm:inline\"> at {new Date(comparison.createdAt).toLocaleTimeString()}</span>\n                          </span>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <i className={`fas ${comparison.isFunnyMode ? 'fa-smile' : 'fa-graduation-cap'} flex-shrink-0`}></i>\n                          <span>{comparison.isFunnyMode ? 'Fun Mode' : 'Academic Analysis'}</span>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2 md:ml-4 w-full md:w-auto\">\n                      <Button\n                        onClick={() => setLocation(`/results/${comparison.id}`)}\n                        className=\"wiki-button text-xs md:text-sm flex-1 md:flex-none\"\n                      >\n                        <i className=\"fas fa-eye mr-1\"></i>\n                        View\n                      </Button>\n                      <Button\n                        onClick={() => handleDelete(comparison.id)}\n                        className=\"wiki-button-secondary text-xs md:text-sm flex-1 md:flex-none\"\n                      >\n                        <i className=\"fas fa-trash mr-1\"></i>\n                        Delete\n                      </Button>\n                    </div>\n                  </div>\n                  \n                  {/* Preview of comparison result */}\n                  <div className=\"text-xs md:text-sm text-gray-600 bg-gray-50 p-2 md:p-3 rounded break-words\">\n                    {comparison.comparisonResult.substring(0, 150)}\n                    {comparison.comparisonResult.length > 150 && '...'}\n                  </div>\n                </div>\n              ))}\n\n            {/* Summary Statistics */}\n            <div className=\"mt-6 md:mt-8 p-3 md:p-4 bg-blue-50 border border-blue-200 rounded\">\n              <h3 className=\"font-semibold text-blue-900 mb-3 text-sm md:text-base\">\n                <i className=\"fas fa-chart-pie mr-2\"></i>Summary\n              </h3>\n              <div className=\"grid grid-cols-2 gap-3 md:grid-cols-4 md:gap-4 text-xs md:text-sm\">\n                <div className=\"text-center md:text-left\">\n                  <div className=\"font-medium text-blue-900\">Total</div>\n                  <div className=\"text-blue-800 font-semibold text-lg md:text-xl\">{comparisonsQuery.data.length}</div>\n                </div>\n                <div className=\"text-center md:text-left\">\n                  <div className=\"font-medium text-blue-900\">Academic</div>\n                  <div className=\"text-blue-800 font-semibold text-lg md:text-xl\">{comparisonsQuery.data.filter(c => !c.isFunnyMode).length}</div>\n                </div>\n                <div className=\"text-center md:text-left\">\n                  <div className=\"font-medium text-blue-900\">Fun Mode</div>\n                  <div className=\"text-blue-800 font-semibold text-lg md:text-xl\">{comparisonsQuery.data.filter(c => c.isFunnyMode).length}</div>\n                </div>\n                <div className=\"text-center md:text-left\">\n                  <div className=\"font-medium text-blue-900\">Languages</div>\n                  <div className=\"text-blue-800 font-semibold text-lg md:text-xl\">{Array.from(new Set(comparisonsQuery.data.flatMap(c => c.selectedLanguages))).length}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </main>\n  );\n}","path":null,"size_bytes":7703,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/pages/contact-us.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Mail, MessageSquare, Globe, Shield, HelpCircle, ArrowLeft, Copy, ExternalLink, Clock, Users, Zap } from \"lucide-react\";\nimport { useState, useEffect } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\n\nexport default function ContactUsPage() {\n  const [formData, setFormData] = useState({\n    name: '',\n    email: '',\n    subject: '',\n    category: '',\n    message: ''\n  });\n  const [isFormValid, setIsFormValid] = useState(false);\n  const { toast } = useToast();\n\n  // Auto-validation and keyboard shortcuts\n  useEffect(() => {\n    const isValid = formData.name && formData.email && formData.subject && formData.category && formData.message;\n    setIsFormValid(Boolean(isValid));\n\n    // Keyboard shortcuts for desktop\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Ctrl+Enter to submit form\n      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter' && isValid) {\n        e.preventDefault();\n        handleSubmit(e as any);\n      }\n      // Escape to clear form\n      if (e.key === 'Escape') {\n        setFormData({\n          name: '',\n          email: '',\n          subject: '',\n          category: '',\n          message: ''\n        });\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [formData, isFormValid]);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Since this is a privacy-first app with no backend data storage,\n    // we'll provide instructions for contacting via email\n    const emailSubject = `Wiki Truth Contact: ${formData.subject}`;\n    const emailBody = `Name: ${formData.name}\\nEmail: ${formData.email}\\nCategory: ${formData.category}\\n\\nMessage:\\n${formData.message}`;\n    const mailtoLink = `mailto:support@wikitruth.app?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`;\n    \n    window.open(mailtoLink, '_blank');\n    \n    toast({\n      title: \"Email Client Opened\",\n      description: \"Your default email application should open with the message pre-filled. If not, please copy the information and send to support@wikitruth.app\",\n    });\n  };\n\n  const handleInputChange = (field: string, value: string) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const copyEmailToClipboard = (email: string) => {\n    navigator.clipboard.writeText(email);\n    toast({\n      title: \"Email Copied\",\n      description: `${email} has been copied to your clipboard`,\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Mobile & Desktop Header */}\n      <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-10\">\n        <div className=\"container mx-auto px-4 sm:px-6 py-3 sm:py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2 sm:gap-4 min-w-0 flex-1\">\n              <Button variant=\"ghost\" size=\"sm\" asChild>\n                <Link href=\"/\">\n                  <ArrowLeft className=\"h-4 w-4 sm:mr-2\" />\n                  <span className=\"hidden sm:inline\">Back to Wiki Truth</span>\n                </Link>\n              </Button>\n              <Separator orientation=\"vertical\" className=\"h-6 hidden sm:block\" />\n              <h1 className=\"text-lg sm:text-xl font-semibold text-gray-900 dark:text-white truncate\">\n                Contact & Support\n              </h1>\n            </div>\n            <div className=\"flex items-center gap-2 flex-shrink-0\">\n              <Badge variant=\"outline\" className=\"bg-green-50 text-green-700 border-green-200 text-xs sm:text-sm\">\n                <Clock className=\"h-3 w-3 mr-1\" />\n                <span className=\"hidden sm:inline\">24-48h Response</span>\n                <span className=\"sm:hidden\">24h</span>\n              </Badge>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 sm:px-6 py-6 sm:py-8 max-w-7xl\">\n        {/* Hero Section */}\n        <div className=\"text-center mb-8 sm:mb-12\">\n          <div className=\"inline-flex items-center gap-2 bg-blue-100 dark:bg-blue-900/30 px-3 py-1 rounded-full text-sm text-blue-700 dark:text-blue-300 mb-4\">\n            <MessageSquare className=\"h-4 w-4\" />\n            Support Center\n          </div>\n          <h1 className=\"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-4\">\n            How can we help you?\n          </h1>\n          <p className=\"text-base sm:text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto\">\n            Get technical support, report issues, or share feedback. Our team is here to help you get the most out of Wiki Truth.\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8\">\n          {/* Contact Form */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <MessageSquare className=\"h-5 w-5\" />\n                Send us a Message\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <Label htmlFor=\"name\">Name</Label>\n                    <Input\n                      id=\"name\"\n                      value={formData.name}\n                      onChange={(e) => handleInputChange('name', e.target.value)}\n                      placeholder=\"Your name\"\n                      required\n                    />\n                  </div>\n                  <div>\n                    <Label htmlFor=\"email\">Email</Label>\n                    <Input\n                      id=\"email\"\n                      type=\"email\"\n                      value={formData.email}\n                      onChange={(e) => handleInputChange('email', e.target.value)}\n                      placeholder=\"your.email@example.com\"\n                      required\n                    />\n                  </div>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"category\">Category</Label>\n                  <Select value={formData.category} onValueChange={(value) => handleInputChange('category', value)}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select a category\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"general\">General Inquiry</SelectItem>\n                      <SelectItem value=\"technical\">Technical Support</SelectItem>\n                      <SelectItem value=\"subscription\">Subscription & Billing</SelectItem>\n                      <SelectItem value=\"feature\">Feature Request</SelectItem>\n                      <SelectItem value=\"privacy\">Privacy & Data</SelectItem>\n                      <SelectItem value=\"partnership\">Partnership</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"subject\">Subject</Label>\n                  <Input\n                    id=\"subject\"\n                    value={formData.subject}\n                    onChange={(e) => handleInputChange('subject', e.target.value)}\n                    placeholder=\"Brief description of your inquiry\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"message\">Message</Label>\n                  <Textarea\n                    id=\"message\"\n                    value={formData.message}\n                    onChange={(e) => handleInputChange('message', e.target.value)}\n                    placeholder=\"Please provide details about your inquiry...\"\n                    rows={6}\n                    required\n                  />\n                </div>\n\n                <Button type=\"submit\" className=\"w-full\" disabled={!isFormValid}>\n                  <Mail className=\"mr-2 h-4 w-4\" />\n                  Send Message\n                  <kbd className=\"ml-auto hidden lg:inline-flex h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100\">\n                    <span className=\"text-xs\">⌘</span>↵\n                  </kbd>\n                </Button>\n\n                <div className=\"mt-2 text-center\">\n                  <Button \n                    type=\"button\" \n                    variant=\"ghost\" \n                    size=\"sm\" \n                    onClick={() => setFormData({\n                      name: '',\n                      email: '',\n                      subject: '',\n                      category: '',\n                      message: ''\n                    })}\n                    className=\"text-xs text-gray-500\"\n                  >\n                    Clear Form <kbd className=\"ml-1 font-mono text-[10px]\">ESC</kbd>\n                  </Button>\n                </div>\n              </form>\n\n              <div className=\"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\n                <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                  <strong>Privacy Note:</strong> This form opens your email client to send the message directly. \n                  We don't store form data on our servers to protect your privacy.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Contact Information */}\n          <div className=\"space-y-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Mail className=\"h-5 w-5\" />\n                  Email Support\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"group cursor-pointer\" onClick={() => copyEmailToClipboard('support@wikitruth.app')}>\n                  <div className=\"flex items-center justify-between\">\n                    <h4 className=\"font-medium\">General Support</h4>\n                    <Copy className=\"h-4 w-4 opacity-0 group-hover:opacity-100 transition-opacity\" />\n                  </div>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300 group-hover:text-blue-600\">support@wikitruth.app</p>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">Response within 24-48 hours • Click to copy</p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium\">Technical Issues</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">tech@wikitruth.app</p>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">Priority support for technical problems</p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium\">Billing & Subscriptions</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">billing@wikitruth.app</p>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400\">For subscription and payment inquiries</p>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Globe className=\"h-5 w-5\" />\n                  Community & Resources\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <Button variant=\"outline\" className=\"w-full justify-start\" asChild>\n                  <a href=\"/help\" className=\"flex items-center gap-2\">\n                    <HelpCircle className=\"h-4 w-4\" />\n                    Help & Documentation\n                  </a>\n                </Button>\n                <Button variant=\"outline\" className=\"w-full justify-start\" asChild>\n                  <a href=\"/report-issues\" className=\"flex items-center gap-2\">\n                    <MessageSquare className=\"h-4 w-4\" />\n                    Report Issues\n                  </a>\n                </Button>\n                <Button variant=\"outline\" className=\"w-full justify-start\" asChild>\n                  <a href=\"/privacy\" className=\"flex items-center gap-2\">\n                    <Shield className=\"h-4 w-4\" />\n                    Privacy Policy\n                  </a>\n                </Button>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Frequently Asked Questions</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div>\n                  <h4 className=\"font-medium text-sm\">How is my data protected?</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    All your data is stored locally in your browser. We don't collect or store personal information on our servers.\n                  </p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-sm\">What's the difference between free and premium?</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Free users get unlimited AI comparisons. Premium ($5/month) offers enhanced analysis capabilities.\n                  </p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-sm\">Can I cancel my subscription anytime?</h4>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-300\">\n                    Yes, you can cancel through your payment provider. You'll retain access until the current period ends.\n                  </p>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":14411,"size_tokens":null},"client/src/lib/languages.ts":{"content":"export interface Language {\n  code: string;\n  name: string;\n  nativeName: string;\n}\n\n// Complete Wikipedia languages list - all 270+ languages supported by Wikipedia\nexport const SUPPORTED_LANGUAGES: Language[] = [\n  // Major Languages\n  { code: 'en', name: 'English', nativeName: 'English' },\n  { code: 'es', name: 'Spanish', nativeName: 'Español' },\n  { code: 'fr', name: 'French', nativeName: 'Français' },\n  { code: 'de', name: 'German', nativeName: 'Deutsch' },\n  { code: 'ru', name: 'Russian', nativeName: 'Русский' },\n  { code: 'zh', name: 'Chinese', nativeName: '中文' },\n  { code: 'ja', name: 'Japanese', nativeName: '日本語' },\n  { code: 'ar', name: 'Arabic', nativeName: 'العربية' },\n  { code: 'pt', name: 'Portuguese', nativeName: 'Português' },\n  { code: 'it', name: 'Italian', nativeName: 'Italiano' },\n  \n  // Popular European Languages\n  { code: 'ko', name: 'Korean', nativeName: '한국어' },\n  { code: 'hi', name: 'Hindi', nativeName: 'हिन्दी' },\n  { code: 'tr', name: 'Turkish', nativeName: 'Türkçe' },\n  { code: 'pl', name: 'Polish', nativeName: 'Polski' },\n  { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },\n  { code: 'sv', name: 'Swedish', nativeName: 'Svenska' },\n  { code: 'da', name: 'Danish', nativeName: 'Dansk' },\n  { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },\n  { code: 'fi', name: 'Finnish', nativeName: 'Suomi' },\n  { code: 'cs', name: 'Czech', nativeName: 'Čeština' },\n  { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },\n  { code: 'ro', name: 'Romanian', nativeName: 'Română' },\n  { code: 'uk', name: 'Ukrainian', nativeName: 'Українська' },\n  { code: 'he', name: 'Hebrew', nativeName: 'עברית' },\n  { code: 'el', name: 'Greek', nativeName: 'Ελληνικά' },\n  { code: 'bg', name: 'Bulgarian', nativeName: 'Български' },\n  { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },\n  { code: 'sr', name: 'Serbian', nativeName: 'Српски' },\n  { code: 'sk', name: 'Slovak', nativeName: 'Slovenčina' },\n  { code: 'sl', name: 'Slovenian', nativeName: 'Slovenščina' },\n  { code: 'et', name: 'Estonian', nativeName: 'Eesti' },\n  { code: 'lv', name: 'Latvian', nativeName: 'Latviešu' },\n  { code: 'lt', name: 'Lithuanian', nativeName: 'Lietuvių' },\n  { code: 'is', name: 'Icelandic', nativeName: 'Íslenska' },\n  { code: 'ga', name: 'Irish', nativeName: 'Gaeilge' },\n  { code: 'cy', name: 'Welsh', nativeName: 'Cymraeg' },\n  { code: 'mt', name: 'Maltese', nativeName: 'Malti' },\n  { code: 'eu', name: 'Basque', nativeName: 'Euskera' },\n  { code: 'ca', name: 'Catalan', nativeName: 'Català' },\n  { code: 'gl', name: 'Galician', nativeName: 'Galego' },\n  { code: 'be', name: 'Belarusian', nativeName: 'Беларуская' },\n  { code: 'mk', name: 'Macedonian', nativeName: 'Македонски' },\n  { code: 'sq', name: 'Albanian', nativeName: 'Shqip' },\n  { code: 'bs', name: 'Bosnian', nativeName: 'Bosanski' },\n  \n  // Asian Languages\n  { code: 'th', name: 'Thai', nativeName: 'ไทย' },\n  { code: 'vi', name: 'Vietnamese', nativeName: 'Tiếng Việt' },\n  { code: 'id', name: 'Indonesian', nativeName: 'Bahasa Indonesia' },\n  { code: 'ms', name: 'Malay', nativeName: 'Bahasa Melayu' },\n  { code: 'tl', name: 'Filipino', nativeName: 'Filipino' },\n  { code: 'bn', name: 'Bengali', nativeName: 'বাংলা' },\n  { code: 'ta', name: 'Tamil', nativeName: 'தமিழ்' },\n  { code: 'te', name: 'Telugu', nativeName: 'తెలుగు' },\n  { code: 'mr', name: 'Marathi', nativeName: 'मराठी' },\n  { code: 'gu', name: 'Gujarati', nativeName: 'ગુજરાતી' },\n  { code: 'ur', name: 'Urdu', nativeName: 'اردو' },\n  { code: 'fa', name: 'Persian', nativeName: 'فارسی' },\n  { code: 'kn', name: 'Kannada', nativeName: 'ಕನ್ನಡ' },\n  { code: 'ml', name: 'Malayalam', nativeName: 'മലയാളം' },\n  { code: 'or', name: 'Odia', nativeName: 'ଓଡ଼ିଆ' },\n  { code: 'pa', name: 'Punjabi', nativeName: 'ਪੰਜਾਬੀ' },\n  { code: 'as', name: 'Assamese', nativeName: 'অসমীয়া' },\n  { code: 'ne', name: 'Nepali', nativeName: 'नेपाली' },\n  { code: 'si', name: 'Sinhala', nativeName: 'සිංහල' },\n  { code: 'my', name: 'Burmese', nativeName: 'မြန်မာ' },\n  { code: 'km', name: 'Khmer', nativeName: 'ខ្មែរ' },\n  { code: 'lo', name: 'Lao', nativeName: 'ລາວ' },\n  { code: 'ka', name: 'Georgian', nativeName: 'ქართული' },\n  { code: 'hy', name: 'Armenian', nativeName: 'Հայերեն' },\n  { code: 'az', name: 'Azerbaijani', nativeName: 'Azərbaycan' },\n  { code: 'kk', name: 'Kazakh', nativeName: 'Қазақша' },\n  { code: 'ky', name: 'Kyrgyz', nativeName: 'Кыргызча' },\n  { code: 'uz', name: 'Uzbek', nativeName: 'Oʻzbek' },\n  { code: 'tg', name: 'Tajik', nativeName: 'Тоҷикӣ' },\n  { code: 'tk', name: 'Turkmen', nativeName: 'Türkmen' },\n  { code: 'mn', name: 'Mongolian', nativeName: 'Монгол' },\n  \n  // African Languages\n  { code: 'sw', name: 'Swahili', nativeName: 'Kiswahili' },\n  { code: 'am', name: 'Amharic', nativeName: 'አማርኛ' },\n  { code: 'yo', name: 'Yoruba', nativeName: 'Yorùbá' },\n  { code: 'ig', name: 'Igbo', nativeName: 'Igbo' },\n  { code: 'ha', name: 'Hausa', nativeName: 'Hausa' },\n  { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },\n  { code: 'af', name: 'Afrikaans', nativeName: 'Afrikaans' },\n  { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },\n  { code: 'so', name: 'Somali', nativeName: 'Soomaali' },\n  { code: 'mg', name: 'Malagasy', nativeName: 'Malagasy' },\n  \n  // Other Popular Languages\n  { code: 'jv', name: 'Javanese', nativeName: 'Basa Jawa' },\n  { code: 'ceb', name: 'Cebuano', nativeName: 'Sinugboanon' },\n  { code: 'war', name: 'Waray', nativeName: 'Winaray' },\n  { code: 'min', name: 'Minangkabau', nativeName: 'Minangkabau' },\n  { code: 'sh', name: 'Serbo-Croatian', nativeName: 'Srpskohrvatski' },\n  { code: 'simple', name: 'Simple English', nativeName: 'Simple English' },\n  \n  // Additional Languages\n  { code: 'ace', name: 'Acehnese', nativeName: 'Acèh' },\n  { code: 'ady', name: 'Adyghe', nativeName: 'Адыгэбзэ' },\n  { code: 'an', name: 'Aragonese', nativeName: 'Aragonés' },\n  { code: 'arc', name: 'Aramaic', nativeName: 'ܐܪܡܝܐ' },\n  { code: 'arz', name: 'Egyptian Arabic', nativeName: 'مصرى' },\n  { code: 'ast', name: 'Asturian', nativeName: 'Asturianu' },\n  { code: 'av', name: 'Avar', nativeName: 'Авар' },\n  { code: 'ay', name: 'Aymara', nativeName: 'Aymar aru' },\n  { code: 'ba', name: 'Bashkir', nativeName: 'Башҡортса' },\n  { code: 'bar', name: 'Bavarian', nativeName: 'Boarisch' },\n  { code: 'bcl', name: 'Bikol Central', nativeName: 'Bikol Central' },\n  { code: 'bh', name: 'Bihari', nativeName: 'भोजपुरी' },\n  { code: 'bi', name: 'Bislama', nativeName: 'Bislama' },\n  { code: 'bm', name: 'Bambara', nativeName: 'Bamanankan' },\n  { code: 'bo', name: 'Tibetan', nativeName: 'བོད་ཡིག' },\n  { code: 'bpy', name: 'Bishnupriya', nativeName: 'বিষ্ণুপ্রিয়া মণিপুরী' },\n  { code: 'br', name: 'Breton', nativeName: 'Brezhoneg' },\n  { code: 'bxr', name: 'Buryat', nativeName: 'Буряад' },\n  { code: 'ce', name: 'Chechen', nativeName: 'Нохчийн' },\n  { code: 'ch', name: 'Chamorro', nativeName: 'Chamoru' },\n  { code: 'chy', name: 'Cheyenne', nativeName: 'Tsėhésenėstsestotse' },\n  { code: 'ckb', name: 'Sorani Kurdish', nativeName: 'کوردی' },\n  { code: 'co', name: 'Corsican', nativeName: 'Corsu' },\n  { code: 'cr', name: 'Cree', nativeName: 'Nehiyawewin' },\n  { code: 'crh', name: 'Crimean Tatar', nativeName: 'Qırımtatarca' },\n  { code: 'cu', name: 'Church Slavonic', nativeName: 'словѣньскъ' },\n  { code: 'cv', name: 'Chuvash', nativeName: 'Чӑвашла' },\n  { code: 'diq', name: 'Zazaki', nativeName: 'Zazaki' },\n  { code: 'dsb', name: 'Lower Sorbian', nativeName: 'Dolnoserbski' },\n  { code: 'dv', name: 'Divehi', nativeName: 'ދިވެހިބަސް' },\n  { code: 'dz', name: 'Dzongkha', nativeName: 'རྫོང་ཁ' },\n  { code: 'ee', name: 'Ewe', nativeName: 'Eʋegbe' },\n  { code: 'ext', name: 'Extremaduran', nativeName: 'Estremeñu' },\n  { code: 'ff', name: 'Fulah', nativeName: 'Fulfulde' },\n  { code: 'fiu-vro', name: 'Võro', nativeName: 'Võro' },\n  { code: 'fj', name: 'Fijian', nativeName: 'Vosa Vakaviti' },\n  { code: 'fo', name: 'Faroese', nativeName: 'Føroyskt' },\n  { code: 'frp', name: 'Franco-Provençal', nativeName: 'Arpetan' },\n  { code: 'frr', name: 'Northern Frisian', nativeName: 'Nordfriisk' },\n  { code: 'fur', name: 'Friulian', nativeName: 'Furlan' },\n  { code: 'fy', name: 'West Frisian', nativeName: 'Frysk' },\n  { code: 'gag', name: 'Gagauz', nativeName: 'Gagauz' },\n  { code: 'gan', name: 'Gan Chinese', nativeName: '贛語' },\n  { code: 'gd', name: 'Scottish Gaelic', nativeName: 'Gàidhlig' },\n  { code: 'glk', name: 'Gilaki', nativeName: 'گیلکی' },\n  { code: 'gn', name: 'Guarani', nativeName: 'Avañeẽ' },\n  { code: 'gom', name: 'Goan Konkani', nativeName: 'गोंयची कोंकणी' },\n  { code: 'got', name: 'Gothic', nativeName: '𐌲𐌿𐍄𐌹𐍃𐌺' },\n  { code: 'gv', name: 'Manx', nativeName: 'Gaelg' },\n  { code: 'hak', name: 'Hakka Chinese', nativeName: '客家語' },\n  { code: 'haw', name: 'Hawaiian', nativeName: 'Hawaiʻi' },\n  { code: 'hif', name: 'Fiji Hindi', nativeName: 'फ़िजी हिन्दी' },\n  { code: 'ho', name: 'Hiri Motu', nativeName: 'Hiri Motu' },\n  { code: 'hsb', name: 'Upper Sorbian', nativeName: 'Hornjoserbsce' },\n  { code: 'ht', name: 'Haitian Creole', nativeName: 'Kreyòl ayisyen' },\n  { code: 'ia', name: 'Interlingua', nativeName: 'Interlingua' },\n  { code: 'ie', name: 'Interlingue', nativeName: 'Interlingue' },\n  { code: 'ik', name: 'Inupiaq', nativeName: 'Iñupiaq' },\n  { code: 'ilo', name: 'Iloko', nativeName: 'Ilokano' },\n  { code: 'io', name: 'Ido', nativeName: 'Ido' },\n  { code: 'iu', name: 'Inuktitut', nativeName: 'ᐃᓄᒃᑎᑐᑦ' },\n  { code: 'jbo', name: 'Lojban', nativeName: 'Lojban' },\n  { code: 'kaa', name: 'Karakalpak', nativeName: 'Qaraqalpaqsha' },\n  { code: 'kab', name: 'Kabyle', nativeName: 'Taqbaylit' },\n  { code: 'kbd', name: 'Kabardian', nativeName: 'Адыгэбзэ' },\n  { code: 'kg', name: 'Kongo', nativeName: 'KiKongo' },\n  { code: 'ki', name: 'Kikuyu', nativeName: 'Gĩkũyũ' },\n  { code: 'kj', name: 'Kuanyama', nativeName: 'Kuanyama' },\n  { code: 'kl', name: 'Kalaallisut', nativeName: 'Kalaallisut' },\n  { code: 'kom', name: 'Komi', nativeName: 'Коми' },\n  { code: 'krc', name: 'Karachay-Balkar', nativeName: 'Къарачай-малкъар' },\n  { code: 'ks', name: 'Kashmiri', nativeName: 'कश्मीरी' },\n  { code: 'ksh', name: 'Colognian', nativeName: 'Ripoarisch' },\n  { code: 'ku', name: 'Kurdish', nativeName: 'Kurdî' },\n  { code: 'kv', name: 'Komi', nativeName: 'Коми' },\n  { code: 'kw', name: 'Cornish', nativeName: 'Kernowek' },\n  { code: 'la', name: 'Latin', nativeName: 'Latina' },\n  { code: 'lad', name: 'Ladino', nativeName: 'Ladino' },\n  { code: 'lb', name: 'Luxembourgish', nativeName: 'Lëtzebuergesch' },\n  { code: 'lbe', name: 'Lak', nativeName: 'Лакку' },\n  { code: 'lez', name: 'Lezghian', nativeName: 'Лезги' },\n  { code: 'li', name: 'Limburgish', nativeName: 'Limburgs' },\n  { code: 'lij', name: 'Ligurian', nativeName: 'Ligure' },\n  { code: 'lmo', name: 'Lombard', nativeName: 'Lumbaart' },\n  { code: 'ln', name: 'Lingala', nativeName: 'Lingála' },\n  { code: 'lrc', name: 'Northern Luri', nativeName: 'لۊری شومالی' },\n  { code: 'ltg', name: 'Latgalian', nativeName: 'Latgaļu' },\n  { code: 'mai', name: 'Maithili', nativeName: 'मैथिली' },\n  { code: 'map-bms', name: 'Basa Banyumasan', nativeName: 'Basa Banyumasan' },\n  { code: 'mdf', name: 'Moksha', nativeName: 'Мокшень' },\n  { code: 'mhr', name: 'Eastern Mari', nativeName: 'Олык марий' },\n  { code: 'mi', name: 'Māori', nativeName: 'Māori' },\n  { code: 'mwl', name: 'Mirandese', nativeName: 'Mirandés' },\n  { code: 'myv', name: 'Erzya', nativeName: 'Эрзянь' },\n  { code: 'mzn', name: 'Mazanderani', nativeName: 'مازِرونی' },\n  { code: 'na', name: 'Nauru', nativeName: 'Dorerin Naoero' },\n  { code: 'nah', name: 'Nahuatl', nativeName: 'Nāhuatl' },\n  { code: 'nap', name: 'Neapolitan', nativeName: 'Napulitano' },\n  { code: 'nds', name: 'Low German', nativeName: 'Plattdüütsch' },\n  { code: 'nds-nl', name: 'Low Saxon', nativeName: 'Nedersaksies' },\n  { code: 'new', name: 'Newari', nativeName: 'नेपाल भाषा' },\n  { code: 'ng', name: 'Ndonga', nativeName: 'Owambo' },\n  { code: 'nn', name: 'Norwegian Nynorsk', nativeName: 'Norsk nynorsk' },\n  { code: 'nov', name: 'Novial', nativeName: 'Novial' },\n  { code: 'nrm', name: 'Norman', nativeName: 'Nouormand' },\n  { code: 'nso', name: 'Northern Sotho', nativeName: 'Sesotho sa Leboa' },\n  { code: 'nv', name: 'Navajo', nativeName: 'Diné bizaad' },\n  { code: 'ny', name: 'Chichewa', nativeName: 'Chi-Chewa' },\n  { code: 'oc', name: 'Occitan', nativeName: 'Occitan' },\n  { code: 'om', name: 'Oromo', nativeName: 'Oromoo' },\n  { code: 'os', name: 'Ossetian', nativeName: 'Ирон' },\n  { code: 'pag', name: 'Pangasinan', nativeName: 'Pangasinan' },\n  { code: 'pam', name: 'Pampanga', nativeName: 'Kapampangan' },\n  { code: 'pap', name: 'Papiamento', nativeName: 'Papiamentu' },\n  { code: 'pcd', name: 'Picard', nativeName: 'Picard' },\n  { code: 'pdc', name: 'Pennsylvania German', nativeName: 'Deitsch' },\n  { code: 'pfl', name: 'Palatine German', nativeName: 'Pälzisch' },\n  { code: 'pi', name: 'Pali', nativeName: 'पाऴि' },\n  { code: 'pih', name: 'Norfuk', nativeName: 'Norfuk' },\n  { code: 'pms', name: 'Piedmontese', nativeName: 'Piemontèis' },\n  { code: 'pnb', name: 'Western Punjabi', nativeName: 'پنجابی' },\n  { code: 'pnt', name: 'Pontic', nativeName: 'Ποντιακά' },\n  { code: 'ps', name: 'Pashto', nativeName: 'پښتو' },\n  { code: 'qu', name: 'Quechua', nativeName: 'Runa Simi' },\n  { code: 'rm', name: 'Romansh', nativeName: 'Rumantsch' },\n  { code: 'rmy', name: 'Romani', nativeName: 'Romani' },\n  { code: 'rn', name: 'Rundi', nativeName: 'Kirundi' },\n  { code: 'roa-rup', name: 'Aromanian', nativeName: 'Armãneashti' },\n  { code: 'roa-tara', name: 'Tarantino', nativeName: 'Tarandíne' },\n  { code: 'rue', name: 'Rusyn', nativeName: 'Русиньскый' },\n  { code: 'rw', name: 'Kinyarwanda', nativeName: 'Kinyarwanda' },\n  { code: 'sa', name: 'Sanskrit', nativeName: 'संस्कृतम्' },\n  { code: 'sah', name: 'Sakha', nativeName: 'Саха тыла' },\n  { code: 'sat', name: 'Santali', nativeName: 'ᱥᱟᱱᱛᱟᱲᱤ' },\n  { code: 'sc', name: 'Sardinian', nativeName: 'Sardu' },\n  { code: 'scn', name: 'Sicilian', nativeName: 'Sicilianu' },\n  { code: 'sco', name: 'Scots', nativeName: 'Scots' },\n  { code: 'sd', name: 'Sindhi', nativeName: 'سنڌي' },\n  { code: 'se', name: 'Northern Sami', nativeName: 'Sámegiella' },\n  { code: 'sg', name: 'Sango', nativeName: 'Sängö' },\n  { code: 'sgs', name: 'Samogitian', nativeName: 'Žemaitėška' },\n  { code: 'shn', name: 'Shan', nativeName: 'လိၵ်ႈတႆး' },\n  { code: 'sn', name: 'Shona', nativeName: 'chiShona' },\n  { code: 'srn', name: 'Sranan Tongo', nativeName: 'Sranantongo' },\n  { code: 'ss', name: 'Swati', nativeName: 'SiSwati' },\n  { code: 'st', name: 'Southern Sotho', nativeName: 'Sesotho' },\n  { code: 'stq', name: 'Saterland Frisian', nativeName: 'Seeltersk' },\n  { code: 'su', name: 'Sundanese', nativeName: 'Basa Sunda' },\n  { code: 'szl', name: 'Silesian', nativeName: 'Ślōnski' },\n  { code: 'tet', name: 'Tetum', nativeName: 'Tetun' },\n  { code: 'ti', name: 'Tigrinya', nativeName: 'ትግርኛ' },\n  { code: 'tn', name: 'Tswana', nativeName: 'Setswana' },\n  { code: 'to', name: 'Tongan', nativeName: 'faka Tonga' },\n  { code: 'tpi', name: 'Tok Pisin', nativeName: 'Tok Pisin' },\n  { code: 'ts', name: 'Tsonga', nativeName: 'Xitsonga' },\n  { code: 'tt', name: 'Tatar', nativeName: 'Татарча' },\n  { code: 'tum', name: 'Tumbuka', nativeName: 'chiTumbuka' },\n  { code: 'tw', name: 'Twi', nativeName: 'Twi' },\n  { code: 'ty', name: 'Tahitian', nativeName: 'Reo Tahiti' },\n  { code: 'tyv', name: 'Tuvan', nativeName: 'Тыва дыл' },\n  { code: 'udm', name: 'Udmurt', nativeName: 'Удмурт' },\n  { code: 'ug', name: 'Uyghur', nativeName: 'ئۇيغۇرچە' },\n  { code: 've', name: 'Venda', nativeName: 'Tshivenda' },\n  { code: 'vec', name: 'Venetian', nativeName: 'Vèneto' },\n  { code: 'vep', name: 'Veps', nativeName: 'Vepsän kel' },\n  { code: 'vls', name: 'West Flemish', nativeName: 'West-Vlams' },\n  { code: 'vo', name: 'Volapük', nativeName: 'Volapük' },\n  { code: 'wa', name: 'Walloon', nativeName: 'Walon' },\n  { code: 'wo', name: 'Wolof', nativeName: 'Wolof' },\n  { code: 'wuu', name: 'Wu Chinese', nativeName: '吴语' },\n  { code: 'xal', name: 'Kalmyk', nativeName: 'Хальмг' },\n  { code: 'xmf', name: 'Mingrelian', nativeName: 'მარგალური' },\n  { code: 'yi', name: 'Yiddish', nativeName: 'ייִדיש' },\n  { code: 'za', name: 'Zhuang', nativeName: 'Vahcuengh' },\n  { code: 'zea', name: 'Zeelandic', nativeName: 'Zeêuws' },\n  { code: 'zh-classical', name: 'Classical Chinese', nativeName: '文言' },\n  { code: 'zh-min-nan', name: 'Min Nan Chinese', nativeName: 'Bân-lâm-gú' },\n  { code: 'zh-yue', name: 'Cantonese', nativeName: '粵語' }\n];\n\nexport function getLanguageByCode(code: string): Language | undefined {\n  return SUPPORTED_LANGUAGES.find(lang => lang.code === code);\n}\n\nexport function getLanguageName(code: string): string {\n  const lang = getLanguageByCode(code);\n  return lang ? lang.name : code;\n}\n\nexport function getLanguageNativeName(code: string): string {\n  const lang = getLanguageByCode(code);\n  return lang ? lang.nativeName : code;\n}\n\n// Helper function to get popular languages sorted by usage\nexport function getPopularLanguages(): Language[] {\n  const popularCodes = [\n    'en', 'es', 'fr', 'de', 'ru', 'zh', 'ja', 'ar', 'pt', 'it',\n    'ko', 'hi', 'tr', 'pl', 'nl', 'sv', 'da', 'no', 'fi', 'cs',\n    'hu', 'ro', 'uk', 'he', 'el', 'bg', 'hr', 'sr', 'sk', 'sl'\n  ];\n  \n  return popularCodes.map(code => getLanguageByCode(code)!).filter(Boolean);\n}\n\n// Helper function to search languages by name or native name\nexport function searchLanguages(query: string): Language[] {\n  const normalizedQuery = query.toLowerCase();\n  return SUPPORTED_LANGUAGES.filter(lang => \n    lang.name.toLowerCase().includes(normalizedQuery) ||\n    lang.nativeName.toLowerCase().includes(normalizedQuery) ||\n    lang.code.toLowerCase().includes(normalizedQuery)\n  );\n}","path":null,"size_bytes":18735,"size_tokens":null},"client/src/pages/billing.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Check, Crown, Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { clientStorage } from \"@/lib/storage\";\n\nexport default function BillingPage() {\n  const [, setLocation] = useLocation();\n  const [email, setEmail] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const handleSubscribe = async () => {\n    if (!email || !email.includes(\"@\")) {\n      toast({\n        title: \"Email required\",\n        description: \"Please enter a valid email address.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const visitorId = await clientStorage.getVisitorId();\n      \n      const response = await fetch(\"/api/billing/create-checkout\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          visitorId,\n          email,\n          userName: \"WikiTruth User\"\n        })\n      });\n\n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.error || \"Failed to create checkout\");\n      }\n\n      if (data.checkoutUrl) {\n        window.location.href = data.checkoutUrl;\n      } else {\n        throw new Error(\"No checkout URL received\");\n      }\n    } catch (error: any) {\n      console.error(\"Checkout error:\", error);\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to start checkout. Please try again.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const features = [\n    \"Unlimited AI-powered article comparisons\",\n    \"Compare up to 5 languages at once\",\n    \"Premium analysis modes\",\n    \"Priority processing\",\n    \"No ads or interruptions\"\n  ];\n\n  return (\n    <div className=\"container max-w-4xl mx-auto py-8 px-4\">\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"text-billing-title\">\n          Upgrade to Premium\n        </h1>\n        <p className=\"text-muted-foreground\">\n          Unlock unlimited AI-powered Wikipedia comparisons\n        </p>\n      </div>\n\n      <div className=\"grid md:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Crown className=\"h-5 w-5 text-yellow-500\" />\n              Premium Plan\n            </CardTitle>\n            <CardDescription>\n              Full access to all features\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"mb-6\">\n              <span className=\"text-4xl font-bold\">$5</span>\n              <span className=\"text-muted-foreground\">/month</span>\n            </div>\n            \n            <ul className=\"space-y-3 mb-6\">\n              {features.map((feature, index) => (\n                <li key={index} className=\"flex items-center gap-2\">\n                  <Check className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                  <span className=\"text-sm\">{feature}</span>\n                </li>\n              ))}\n            </ul>\n\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"email\">Email address</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  placeholder=\"your@email.com\"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  data-testid=\"input-email\"\n                />\n              </div>\n\n              <Button \n                className=\"w-full\" \n                onClick={handleSubscribe}\n                disabled={isLoading}\n                data-testid=\"button-subscribe\"\n              >\n                {isLoading ? (\n                  <>\n                    <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                    Processing...\n                  </>\n                ) : (\n                  <>\n                    <Crown className=\"h-4 w-4 mr-2\" />\n                    Subscribe Now\n                  </>\n                )}\n              </Button>\n\n              <p className=\"text-xs text-muted-foreground text-center\">\n                Secure payment via MaxelPay (Crypto)\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"bg-muted/50\">\n          <CardHeader>\n            <CardTitle>Free Plan</CardTitle>\n            <CardDescription>\n              Limited access\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"mb-6\">\n              <span className=\"text-4xl font-bold\">$0</span>\n              <span className=\"text-muted-foreground\">/forever</span>\n            </div>\n            \n            <ul className=\"space-y-3 mb-6\">\n              <li className=\"flex items-center gap-2\">\n                <Check className=\"h-4 w-4 text-green-500 flex-shrink-0\" />\n                <span className=\"text-sm\">1 free comparison</span>\n              </li>\n              <li className=\"flex items-center gap-2 text-muted-foreground\">\n                <span className=\"text-sm\">Then upgrade to continue</span>\n              </li>\n            </ul>\n\n            <Button \n              variant=\"outline\" \n              className=\"w-full\"\n              onClick={() => setLocation(\"/\")}\n              data-testid=\"button-back-home\"\n            >\n              Back to Home\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5859,"size_tokens":null},"server/services/maxelpay.ts":{"content":"import CryptoJS from 'crypto-js';\n\nconst MAXELPAY_API_KEY = process.env.MAXELPAY_API_KEY || '';\nconst MAXELPAY_SECRET_KEY = process.env.MAXELPAY_SECRET_KEY || '';\nconst IS_PRODUCTION = process.env.NODE_ENV === 'production';\n\nconst MAXELPAY_CHECKOUT_URL = IS_PRODUCTION \n  ? 'https://api.maxelpay.com/v1/prod/merchant/order/checkout'\n  : 'https://api.maxelpay.com/v1/stg/merchant/order/checkout';\n\ninterface CheckoutPayload {\n  orderID: string;\n  amount: string;\n  currency: string;\n  timestamp: string;\n  userName: string;\n  siteName: string;\n  userEmail: string;\n  redirectUrl: string;\n  websiteUrl: string;\n  cancelUrl: string;\n  webhookUrl: string;\n}\n\nfunction encryptPayload(secretKey: string, payload: string): string {\n  const key = CryptoJS.enc.Utf8.parse(secretKey);\n  const iv = CryptoJS.enc.Utf8.parse(secretKey.substr(0, 16));\n  const encrypted = CryptoJS.AES.encrypt(payload, key, {\n    iv: iv,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  });\n  return encrypted.toString();\n}\n\nexport async function createCheckoutSession(params: {\n  orderId: string;\n  amount: string;\n  userEmail: string;\n  userName: string;\n  baseUrl: string;\n}): Promise<{ checkoutUrl: string; orderId: string }> {\n  const { orderId, amount, userEmail, userName, baseUrl } = params;\n\n  if (!MAXELPAY_API_KEY || !MAXELPAY_SECRET_KEY) {\n    throw new Error('MaxelPay API credentials not configured');\n  }\n\n  const payload: CheckoutPayload = {\n    orderID: orderId,\n    amount: amount,\n    currency: 'USD',\n    timestamp: Math.floor(Date.now() / 1000).toString(),\n    userName: userName || 'WikiTruth User',\n    siteName: 'WikiTruth',\n    userEmail: userEmail,\n    redirectUrl: `${baseUrl}/billing/success?orderId=${orderId}`,\n    websiteUrl: baseUrl,\n    cancelUrl: `${baseUrl}/billing/cancel?orderId=${orderId}`,\n    webhookUrl: `${baseUrl}/api/maxelpay/webhook`\n  };\n\n  const encryptedPayload = encryptPayload(MAXELPAY_SECRET_KEY, JSON.stringify(payload));\n\n  const response = await fetch(MAXELPAY_CHECKOUT_URL, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'api-key': MAXELPAY_API_KEY\n    },\n    body: JSON.stringify({ data: encryptedPayload })\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    console.error('MaxelPay checkout error:', errorText);\n    throw new Error('Failed to create checkout session');\n  }\n\n  const data = await response.json();\n  \n  // Handle different response formats from MaxelPay\n  const checkoutUrl = data.result || data.data?.checkout_url;\n  \n  if (!checkoutUrl) {\n    console.error('MaxelPay response error:', data);\n    throw new Error(data.message || 'Failed to create checkout session');\n  }\n\n  return {\n    checkoutUrl: checkoutUrl,\n    orderId: orderId\n  };\n}\n\nexport function verifyWebhookSignature(payload: string, signature: string): boolean {\n  if (!MAXELPAY_SECRET_KEY) return false;\n  const expectedSignature = CryptoJS.HmacSHA256(payload, MAXELPAY_SECRET_KEY).toString();\n  return signature === expectedSignature;\n}\n","path":null,"size_bytes":3025,"size_tokens":null},"client/src/pages/billing-cancel.tsx":{"content":"import { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { X } from \"lucide-react\";\n\nexport default function BillingCancelPage() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <div className=\"container max-w-md mx-auto py-16 px-4\">\n      <Card>\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 h-16 w-16 rounded-full bg-muted flex items-center justify-center\">\n            <X className=\"h-8 w-8 text-muted-foreground\" />\n          </div>\n          <CardTitle>Payment Cancelled</CardTitle>\n          <CardDescription>\n            Your payment was cancelled. No charges were made.\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          <Button \n            className=\"w-full\" \n            onClick={() => setLocation(\"/billing\")}\n            data-testid=\"button-try-again\"\n          >\n            Try Again\n          </Button>\n          <Button \n            variant=\"outline\"\n            className=\"w-full\" \n            onClick={() => setLocation(\"/\")}\n            data-testid=\"button-back-home\"\n          >\n            Back to Home\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":1337,"size_tokens":null},"client/src/pages/billing-success.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Check, Loader2 } from \"lucide-react\";\n\nexport default function BillingSuccessPage() {\n  const [, setLocation] = useLocation();\n  const [status, setStatus] = useState<\"loading\" | \"success\" | \"pending\">(\"loading\");\n\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    const orderId = params.get(\"orderId\");\n\n    if (orderId) {\n      fetch(`/api/billing/verify?orderId=${orderId}`)\n        .then(res => res.json())\n        .then(data => {\n          if (data.status === \"completed\" || data.status === \"success\") {\n            setStatus(\"success\");\n          } else {\n            setStatus(\"pending\");\n          }\n        })\n        .catch(() => setStatus(\"pending\"));\n    } else {\n      setStatus(\"success\");\n    }\n  }, []);\n\n  if (status === \"loading\") {\n    return (\n      <div className=\"container max-w-md mx-auto py-16 px-4 text-center\">\n        <Loader2 className=\"h-12 w-12 animate-spin mx-auto mb-4 text-primary\" />\n        <p className=\"text-muted-foreground\">Verifying payment...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container max-w-md mx-auto py-16 px-4\">\n      <Card>\n        <CardHeader className=\"text-center\">\n          <div className=\"mx-auto mb-4 h-16 w-16 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center\">\n            <Check className=\"h-8 w-8 text-green-600 dark:text-green-400\" />\n          </div>\n          <CardTitle>\n            {status === \"success\" ? \"Payment Successful!\" : \"Payment Processing\"}\n          </CardTitle>\n          <CardDescription>\n            {status === \"success\" \n              ? \"Welcome to WikiTruth Premium! You now have unlimited access.\"\n              : \"Your payment is being processed. Premium access will be activated shortly.\"}\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Button \n            className=\"w-full\" \n            onClick={() => setLocation(\"/\")}\n            data-testid=\"button-continue\"\n          >\n            Continue to WikiTruth\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":2336,"size_tokens":null},"client/src/pages/library.tsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { ChevronUp, ChevronDown, BookOpen, Globe, Calendar } from 'lucide-react';\nimport { getLanguageName } from '@/lib/languages';\n\ninterface LibraryComparison {\n  id: number;\n  articleTitle: string;\n  selectedLanguages: string[];\n  outputLanguage: string;\n  comparisonResult: string | null;\n  isFunnyMode: boolean | null;\n  isPremium: boolean | null;\n  createdAt: string | null;\n}\n\ninterface LibraryResponse {\n  comparisons: LibraryComparison[];\n  total: number;\n  hasMore: boolean;\n}\n\nconst LANGUAGE_OPTIONS = [\n  { value: 'all', label: 'All Languages' },\n  { value: 'en', label: 'English' },\n  { value: 'ru', label: 'Russian' },\n  { value: 'de', label: 'German' },\n  { value: 'fr', label: 'French' },\n  { value: 'es', label: 'Spanish' },\n  { value: 'zh', label: 'Chinese' },\n  { value: 'ar', label: 'Arabic' },\n  { value: 'ja', label: 'Japanese' },\n  { value: 'ko', label: 'Korean' },\n  { value: 'pt', label: 'Portuguese' },\n  { value: 'it', label: 'Italian' },\n];\n\nexport default function LibraryPage() {\n  const [, setLocation] = useLocation();\n  const [selectedLanguage, setSelectedLanguage] = useState<string>('all');\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [expandedCard, setExpandedCard] = useState<number | null>(null);\n\n  const libraryQuery = useQuery<LibraryResponse>({\n    queryKey: ['/api/library', selectedLanguage],\n    queryFn: async () => {\n      const params = new URLSearchParams({ limit: '50' });\n      if (selectedLanguage !== 'all') {\n        params.set('language', selectedLanguage);\n      }\n      const response = await fetch(`/api/library?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch library');\n      return response.json();\n    },\n  });\n\n  const comparisons = libraryQuery.data?.comparisons || [];\n  const currentComparison = comparisons[currentIndex];\n\n  const handleNext = () => {\n    if (currentIndex < comparisons.length - 1) {\n      setCurrentIndex(currentIndex + 1);\n      setExpandedCard(null);\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentIndex > 0) {\n      setCurrentIndex(currentIndex - 1);\n      setExpandedCard(null);\n    }\n  };\n\n  const handleLanguageChange = (value: string) => {\n    setSelectedLanguage(value);\n    setCurrentIndex(0);\n    setExpandedCard(null);\n  };\n\n  const toggleExpanded = (id: number) => {\n    setExpandedCard(expandedCard === id ? null : id);\n  };\n\n  const formatDate = (dateStr: string | null) => {\n    if (!dateStr) return 'Unknown date';\n    return new Date(dateStr).toLocaleDateString();\n  };\n\n  const getPreviewText = (text: string | null, maxLength: number = 200) => {\n    if (!text) return 'No content available';\n    const stripped = text.replace(/[#*_`\\[\\]]/g, '').replace(/\\n+/g, ' ').trim();\n    return stripped.length > maxLength ? stripped.substring(0, maxLength) + '...' : stripped;\n  };\n\n  const getExpandedText = (text: string | null, maxLength: number = 2000) => {\n    if (!text) return 'No content available';\n    if (text.length <= maxLength) return text;\n    return text.substring(0, maxLength) + '\\n\\n... [Click \"View Full Analysis\" to see the complete comparison]';\n  };\n\n  return (\n    <main className=\"container mx-auto max-w-4xl pt-16 pb-20 lg:pt-24 lg:pb-8\">\n      <div className=\"px-4 md:px-6\">\n        <div className=\"flex items-center gap-3 mb-4\">\n          <BookOpen className=\"w-8 h-8 text-primary\" />\n          <div>\n            <h1 className=\"text-2xl md:text-3xl font-bold\" data-testid=\"text-library-title\">Library</h1>\n            <p className=\"text-muted-foreground text-sm\">Browse public comparisons from the community</p>\n          </div>\n        </div>\n\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium mb-2\">Filter by output language:</label>\n          <Select value={selectedLanguage} onValueChange={handleLanguageChange}>\n            <SelectTrigger className=\"w-full md:w-64\" data-testid=\"select-language-filter\">\n              <SelectValue placeholder=\"Select language\" />\n            </SelectTrigger>\n            <SelectContent>\n              {LANGUAGE_OPTIONS.map(option => (\n                <SelectItem key={option.value} value={option.value}>\n                  {option.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {libraryQuery.isLoading && (\n          <div className=\"text-center py-12\">\n            <div className=\"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4\" />\n            <p className=\"text-muted-foreground\">Loading library...</p>\n          </div>\n        )}\n\n        {libraryQuery.error && (\n          <div className=\"bg-destructive/10 border border-destructive/20 rounded-lg p-4 text-center\">\n            <p className=\"text-destructive\">Failed to load library. Please try again.</p>\n          </div>\n        )}\n\n        {!libraryQuery.isLoading && comparisons.length === 0 && (\n          <div className=\"text-center py-12\">\n            <BookOpen className=\"w-16 h-16 text-muted-foreground mx-auto mb-4\" />\n            <h2 className=\"text-xl font-semibold mb-2\">No Comparisons Yet</h2>\n            <p className=\"text-muted-foreground mb-6 max-w-md mx-auto\">\n              The library is empty for this language. Be the first to create a comparison!\n            </p>\n            <Button onClick={() => setLocation('/search')} data-testid=\"button-start-comparison\">\n              Create First Comparison\n            </Button>\n          </div>\n        )}\n\n        {!libraryQuery.isLoading && comparisons.length > 0 && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between text-sm text-muted-foreground mb-4\">\n              <span>{currentIndex + 1} of {comparisons.length} comparisons</span>\n              <span>{libraryQuery.data?.total || 0} total</span>\n            </div>\n\n            <div className=\"relative\">\n              <Button\n                variant=\"outline\"\n                size=\"icon\"\n                className=\"absolute -top-2 left-1/2 -translate-x-1/2 z-10 rounded-full\"\n                onClick={handlePrevious}\n                disabled={currentIndex === 0}\n                data-testid=\"button-previous\"\n              >\n                <ChevronUp className=\"w-4 h-4\" />\n              </Button>\n\n              {currentComparison && (\n                <Card \n                  className=\"cursor-pointer transition-all duration-200 mt-8 mb-8\"\n                  onClick={() => toggleExpanded(currentComparison.id)}\n                  data-testid={`card-comparison-${currentComparison.id}`}\n                >\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-lg md:text-xl\" data-testid=\"text-article-title\">\n                      {currentComparison.articleTitle}\n                    </CardTitle>\n                    <div className=\"flex flex-wrap items-center gap-3 text-sm text-muted-foreground\">\n                      <div className=\"flex items-center gap-1\">\n                        <Globe className=\"w-4 h-4\" />\n                        <span>\n                          {currentComparison.selectedLanguages?.map(l => getLanguageName(l)).join(', ') || 'Unknown'}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Calendar className=\"w-4 h-4\" />\n                        <span>{formatDate(currentComparison.createdAt)}</span>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    {expandedCard === currentComparison.id ? (\n                      <div className=\"prose prose-sm dark:prose-invert max-w-none max-h-96 overflow-y-auto\">\n                        <div className=\"whitespace-pre-wrap text-sm\" data-testid=\"text-full-content\">\n                          {getExpandedText(currentComparison.comparisonResult)}\n                        </div>\n                        <div className=\"mt-4 pt-4 border-t flex gap-2 sticky bottom-0 bg-card pb-2\">\n                          <Button\n                            size=\"sm\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setLocation(`/results/${currentComparison.id}`);\n                            }}\n                            data-testid=\"button-view-full\"\n                          >\n                            View Full Analysis\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              setExpandedCard(null);\n                            }}\n                            data-testid=\"button-collapse\"\n                          >\n                            Collapse\n                          </Button>\n                        </div>\n                      </div>\n                    ) : (\n                      <div>\n                        <p className=\"text-muted-foreground text-sm\" data-testid=\"text-preview\">\n                          {getPreviewText(currentComparison.comparisonResult)}\n                        </p>\n                        <p className=\"text-primary text-sm mt-2 font-medium\">\n                          Tap to read more\n                        </p>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              )}\n\n              <Button\n                variant=\"outline\"\n                size=\"icon\"\n                className=\"absolute -bottom-2 left-1/2 -translate-x-1/2 z-10 rounded-full\"\n                onClick={handleNext}\n                disabled={currentIndex >= comparisons.length - 1}\n                data-testid=\"button-next\"\n              >\n                <ChevronDown className=\"w-4 h-4\" />\n              </Button>\n            </div>\n\n            <div className=\"flex justify-center gap-1 mt-8\">\n              {comparisons.slice(Math.max(0, currentIndex - 2), Math.min(comparisons.length, currentIndex + 3)).map((_, idx) => {\n                const actualIndex = Math.max(0, currentIndex - 2) + idx;\n                return (\n                  <button\n                    key={actualIndex}\n                    className={`w-2 h-2 rounded-full transition-all ${\n                      actualIndex === currentIndex \n                        ? 'bg-primary w-4' \n                        : 'bg-muted-foreground/30'\n                    }`}\n                    onClick={() => {\n                      setCurrentIndex(actualIndex);\n                      setExpandedCard(null);\n                    }}\n                    data-testid={`button-dot-${actualIndex}`}\n                  />\n                );\n              })}\n            </div>\n          </div>\n        )}\n      </div>\n    </main>\n  );\n}\n","path":null,"size_bytes":11323,"size_tokens":null}},"version":2}